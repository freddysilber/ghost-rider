{"version":3,"file":"ng-ghost-rider.mjs","sources":["../../../projects/ng-ghost-rider/src/lib/models/ghost-rider-step-event.model.ts","../../../projects/ng-ghost-rider/src/lib/tokens/ghost-rider-navigation.token.ts","../../../projects/ng-ghost-rider/src/lib/components/popover.component.ts","../../../projects/ng-ghost-rider/src/lib/components/ghost-rider-step.component.ts","../../../projects/ng-ghost-rider/src/lib/tokens/popover-scroll-strategy.token.ts","../../../projects/ng-ghost-rider/src/lib/providers/popover-container.service.ts","../../../projects/ng-ghost-rider/src/lib/tokens/popover-container.token.ts","../../../projects/ng-ghost-rider/src/lib/providers/popover-position-strategy.service.ts","../../../projects/ng-ghost-rider/src/lib/models/ghost-rider-popover.model.ts","../../../projects/ng-ghost-rider/src/lib/providers/ghost-rider-popover-factory.service.ts","../../../projects/ng-ghost-rider/src/lib/helpers/ghost-rider-tour-guide.ts","../../../projects/ng-ghost-rider/src/lib/providers/ghost-rider.service.ts","../../../projects/ng-ghost-rider/src/lib/directives/ghost-rider-step-advance.directive.ts","../../../projects/ng-ghost-rider/src/lib/models/ghost-rider-step-config.model.ts","../../../projects/ng-ghost-rider/src/lib/directives/ghost-rider-step.directive.ts","../../../projects/ng-ghost-rider/src/lib/directives/ghost-rider-step-complete.directive.ts","../../../projects/ng-ghost-rider/src/lib/directives/ghost-rider-step-hide.directive.ts","../../../projects/ng-ghost-rider/src/lib/directives/ghost-rider-step-previous.directive.ts","../../../projects/ng-ghost-rider/src/lib/providers/overlay-container.service.ts","../../../projects/ng-ghost-rider/src/lib/ghost-rider.module.ts","../../../projects/ng-ghost-rider/src/lib/models/ghost-rider-step.model.ts","../../../projects/ng-ghost-rider/src/public-api.ts","../../../projects/ng-ghost-rider/src/ng-ghost-rider.ts"],"sourcesContent":["export enum GhostRiderEventType {\n  Start,\n  Next,\n  Back,\n  Close,\n  Complete,\n}\n\nexport enum GhostRiderEventSource {\n  Directive,\n  Popover,\n  Manual,\n}\n\nexport interface GhostRiderEvent {\n  type: GhostRiderEventType | null;\n  name: string;\n  source: GhostRiderEventSource;\n}","import { InjectionToken } from '@angular/core';\nimport { GhostRiderNavigation } from '../models/ghost-rider-navigation.model';\n\nexport const GHOST_RIDER_NAVIGATION = new InjectionToken<GhostRiderNavigation>(\n\t'GhostRiderNavigation'\n);\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n// Adapted from @angular/material \"TooltipComponent\"\n\nimport { ChangeDetectorRef, Component, OnDestroy } from '@angular/core';\nimport { ConnectedPosition } from '@angular/cdk/overlay';\nimport { ComponentPortal, TemplatePortal } from '@angular/cdk/portal';\nimport { Observable, Subject } from 'rxjs';\n\nexport type PopoverContent<T> = T extends string ? string : ComponentPortal<T> | TemplatePortal<T>;\n\n@Component({\n\tselector: 'ghost-rider-popover',\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ghost-rider-popover\"\n\t\t\t[ngClass]=\"nubbinCls\"\n\t\t\t[class.ghost-rider-popover_tooltip]=\"isTooltip\"\n\t\t\t[attr.role]=\"isTooltip ? 'tooltip' : 'dialog'\"\n\t\t>\n\t\t\t<div class=\"ghost-rider-popover__body\">\n\t\t\t\t<ng-container [cdkPortalOutlet]=\"contentCmp || contentTpl || contentTextTpl\"></ng-container>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<ng-template\n\t\t\tcdkPortal\n\t\t\t#contentTextTpl=\"cdkPortal\"\n\t\t>\n\t\t\t{{ contentText }}\n\t\t</ng-template>\n\t`,\n})\nexport class PopoverComponent<T = any> implements OnDestroy {\n\tpublic set content(content: PopoverContent<T>) {\n\t\tthis.contentText = this.contentTpl = this.contentCmp = null;\n\t\tif (typeof content === 'string') {\n\t\t\tthis.contentText = content;\n\t\t} else if (content instanceof TemplatePortal) {\n\t\t\tthis.contentTpl = content;\n\t\t} else if (content instanceof ComponentPortal) {\n\t\t\tthis.contentCmp = content;\n\t\t}\n\t}\n\n\t// todo FIX TYPES 'any'\n\tpublic contentCmp: ComponentPortal<T> | any;\n\tpublic contentTpl: TemplatePortal<T> | any; // TODO: Add ability to configure context\n\tpublic contentText: string | any;\n\n\tpublic nubbinCls: string;\n\n\tpublic isTooltip: boolean;\n\n\tprivate _position: ConnectedPosition;\n\tpublic get position(): ConnectedPosition { return this._position; }\n\tpublic set position(pos: ConnectedPosition) {\n\t\tif (pos !== this._position) {\n\t\t\tthis._position = pos;\n\t\t\tthis.nubbinCls = pos ? `ghost-rider-nubbin_${getNubbinPosition(pos)}` : null as unknown as string;\n\t\t\tthis._cdr.markForCheck();\n\t\t}\n\t}\n\n\t/** The timeout ID of any current timer set to show the tooltip */\n\tprivate _showTimeoutId: number | null;\n\n\t/** The timeout ID of any current timer set to hide the tooltip */\n\tprivate _hideTimeoutId: number | null;\n\n\t/** Property watched by the animation framework to show or hide the tooltip */\n\tprivate _visibility: TooltipVisibility = 'initial';\n\n\t/** Subject for notifying that the tooltip has been hidden from the view */\n\tprivate readonly _onHide: Subject<any> = new Subject();\n\n\t/** Subject for notifying that the tooltip has been made visible */\n\tprivate readonly _onShow: Subject<any> = new Subject();\n\n\tpublic get hasTimeout(): boolean { return !!this._showTimeoutId || !!this._hideTimeoutId; }\n\n\tconstructor(\n\t\tprivate _cdr: ChangeDetectorRef,\n\t) { }\n\n\tngOnDestroy() {\n\t\tthis._onHide.complete();\n\t\tthis._onShow.complete();\n\t}\n\n\t/**\n\t * Shows the tooltip with an animation originating from the provided origin\n\t * @param delay Amount of milliseconds to the delay showing the tooltip.\n\t */\n\tpublic show(delay: number): void {\n\t\t// Cancel the delayed hide if it is scheduled\n\t\tif (this._hideTimeoutId) {\n\t\t\tclearTimeout(this._hideTimeoutId);\n\t\t\tthis._hideTimeoutId = null;\n\t\t}\n\n\t\tthis._showTimeoutId = setTimeout(() => {\n\t\t\tthis._visibility = 'visible';\n\t\t\tthis._showTimeoutId = null;\n\t\t\tthis._onShow.next(null);\n\n\t\t\t// Mark for check so if any parent component has set the\n\t\t\t// ChangeDetectionStrategy to OnPush it will be checked anyways\n\t\t\tthis._cdr.markForCheck();\n\t\t}, delay) as any as number;\n\t}\n\n\t/**\n\t * Begins the animation to hide the tooltip after the provided delay in ms.\n\t * @param delay Amount of milliseconds to delay showing the tooltip.\n\t */\n\tpublic hide(delay: number): void {\n\t\t// Cancel the delayed show if it is scheduled\n\t\tif (this._showTimeoutId) {\n\t\t\tclearTimeout(this._showTimeoutId);\n\t\t\tthis._showTimeoutId = null;\n\t\t}\n\n\t\tthis._hideTimeoutId = setTimeout(() => {\n\t\t\tthis._visibility = 'hidden';\n\t\t\tthis._hideTimeoutId = null;\n\t\t\tthis._onHide.next(null);\n\n\t\t\t// Mark for check so if any parent component has set the\n\t\t\t// ChangeDetectionStrategy to OnPush it will be checked anyways\n\t\t\tthis._cdr.markForCheck();\n\t\t}, delay) as any as number;\n\t}\n\n\t/** Returns an observable that notifies when the tooltip has been hidden from view. */\n\tpublic afterHidden(): Observable<void> {\n\t\treturn this._onHide.asObservable();\n\t}\n\n\t/** Returns an observable that notifies when the tooltip has been made visible. */\n\tpublic afterVisible(): Observable<void> {\n\t\treturn this._onShow.asObservable();\n\t}\n\n\t/** Whether the tooltip is being displayed. */\n\tpublic isVisible(): boolean {\n\t\treturn this._visibility === 'visible';\n\t}\n\n\tpublic markForCheck(): void {\n\t\tthis._cdr.markForCheck();\n\t}\n}\n\nexport type TooltipVisibility = 'initial' | 'visible' | 'hidden';\n\nfunction getNubbinPosition(position: ConnectedPosition): string {\n\tconst positions: string[] = [];\n\n\tif (position.originY !== 'center') { // TopBottom\n\t\tpositions.push(position.originY === 'bottom' ? 'top' : 'bottom');\n\n\t\tif (position.overlayX !== 'center') {\n\t\t\tpositions.push(position.overlayX === 'start' ? 'left' : 'right');\n\t\t}\n\t} else { // Left/Right\n\t\tpositions.push(position.originX === 'end' ? 'left' : 'right');\n\n\t\tif (position.overlayY !== 'center') {\n\t\t\tpositions.push(position.overlayY);\n\t\t}\n\t}\n\n\treturn (positions.length ? positions.join('-') : null as any);\n}\n","import { ChangeDetectorRef, Component, Inject } from '@angular/core';\nimport { GhostRiderNavigation } from '../models/ghost-rider-navigation.model';\nimport { GhostRiderStepConfig } from '../models/ghost-rider-step-config.model';\nimport { GhostRiderEventSource } from '../models/ghost-rider-step-event.model';\nimport { GHOST_RIDER_NAVIGATION } from '../tokens/ghost-rider-navigation.token';\nimport { PopoverComponent } from './popover.component';\n\n@Component({\n\tselector: 'ghost-rider-step',\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ghost-rider-popover\"\n\t\t\t[ngClass]=\"nubbinCls\"\n\t\t\trole=\"dialog\"\n\t\t>\n\t\t\t<div class=\"ghost-rider-popover__header\">\n\t\t\t\t<h2 class=\"ghost-rider_title\">{{ details.title || '&nbsp;' }}</h2>\n\t\t\t\t<div\n\t\t\t\t\t(click)=\"close()\"\n\t\t\t\t\tclass=\"ghost-rider_close-button\"\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\trole=\"img\"\n\t\t\t\t\t\twidth=\"1.3em\"\n\t\t\t\t\t\theight=\"1.3em\"\n\t\t\t\t\t\tpreserveAspectRatio=\"xMidYMid meet\"\n\t\t\t\t\t\tviewBox=\"0 0 1024 1024\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\td=\"M195.2 195.2a64 64 0 0 1 90.496 0L512 421.504L738.304 195.2a64 64 0 0 1 90.496 90.496L602.496 512L828.8 738.304a64 64 0 0 1-90.496 90.496L512 602.496L285.696 828.8a64 64 0 0 1-90.496-90.496L421.504 512L195.2 285.696a64 64 0 0 1 0-90.496z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"ghost-rider-popover__body\">\n\t\t\t\t<ng-container [cdkPortalOutlet]=\"contentCmp || contentTpl || contentTextTpl\"></ng-container>\n\t\t\t</div>\n\n\t\t\t<div class=\"ghost-rider-popover__footer\">\n\t\t\t\t<span>\n\t\t\t\t\tStep {{ stepIndex + 1 }} of {{ stepCount }}\n\t\t\t\t</span>\n\t\t\t\t<div>\n\t\t\t\t\t<button\n\t\t\t\t\t\t(click)=\"back()\"\n\t\t\t\t\t\t*ngIf=\"stepIndex > 0\"\n\t\t\t\t\t\tclass=\"ghost-rider_back-button\"\n\t\t\t\t\t>\n\t\t\t\t\t\tBack\n\t\t\t\t\t</button>\n\t\t\t\t\t<button\n\t\t\t\t\t\t(click)=\"next()\"\n\t\t\t\t\t\t*ngIf=\"!isLastStep\"\n\t\t\t\t\t\tclass=\"ghost-rider_next-button\"\n\t\t\t\t\t>\n\t\t\t\t\t\tNext\n\t\t\t\t\t</button>\n\t\t\t\t\t<button\n\t\t\t\t\t\t(click)=\"complete()\"\n\t\t\t\t\t\t*ngIf=\"isLastStep\"\n\t\t\t\t\t\tclass=\"ghost-rider_complete-button\"\n\t\t\t\t\t>\n\t\t\t\t\t\tComplete\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<ng-template\n\t\t\tcdkPortal\n\t\t\t#contentTextTpl=\"cdkPortal\"\n\t\t>\n\t\t\t{{ contentText }}\n\t\t</ng-template>\n\t`,\n\tstyles: [],\n})\nexport class GhostRiderStepComponent extends PopoverComponent {\n\tpublic stepIndex: number;\n\tpublic stepCount: number;\n\tpublic stepName: string;\n\tpublic isLastStep: boolean;\n\tpublic hasSubSteps: boolean;\n\tpublic details: GhostRiderStepConfig;\n\n\tpublic readonly isSubStep: boolean;\n\n\tconstructor(\n\t\t@Inject(GHOST_RIDER_NAVIGATION) private readonly _navigation: GhostRiderNavigation,\n\t\tcdr: ChangeDetectorRef,\n\t) {\n\t\tsuper(cdr);\n\n\t\tthis.isSubStep = !!this._navigation.tourGuide.activeStep.parent;\n\t\tthis.stepName = this._navigation.tourGuide.activeStep.name;\n\t\tthis.hasSubSteps = this._navigation.tourGuide.activeStep.hasSubSteps;\n\n\t\tif (this.isSubStep) {\n\t\t\tconst siblings = this._navigation.tourGuide.activeStep.parent?.subSteps;\n\t\t\tif (siblings) {\n\t\t\t\tthis.stepIndex = siblings.indexOf(this._navigation.tourGuide.activeStep);\n\t\t\t\tthis.stepCount = siblings.length;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.stepIndex = this._navigation.tourGuide.currentStep;\n\t\t\tthis.stepCount = this._navigation.tourGuide.steps.length;\n\t\t}\n\n\t\tthis.isLastStep = this.stepIndex === this.stepCount - 1;\n\t}\n\n\tngOnDestroy(): void {\n\t\tsuper.ngOnDestroy();\n\t}\n\n\tpublic next(): void {\n\t\tif (this.details.nextIsHide) {\n\t\t\tthis._navigation.hideStep();\n\t\t} else {\n\t\t\tthis._navigation.next(GhostRiderEventSource.Popover);\n\t\t}\n\t}\n\n\tpublic nextSubStep(): void {\n\t\tthis._navigation.nextSubStep(GhostRiderEventSource.Popover);\n\t}\n\n\tpublic previousSubStep(): void {\n\t\tthis._navigation.previousSubStep(GhostRiderEventSource.Popover);\n\t}\n\n\tpublic goToParent(): void {\n\t\tthis._navigation.goToParent(GhostRiderEventSource.Popover);\n\t}\n\n\tpublic back(): void {\n\t\tthis._navigation.back(GhostRiderEventSource.Popover);\n\t}\n\n\tpublic close(): void {\n\t\tthis._navigation.close(GhostRiderEventSource.Popover);\n\t}\n\n\tpublic complete(): void {\n\t\tthis._navigation.complete(GhostRiderEventSource.Popover);\n\t}\n}","import { InjectionToken } from '@angular/core';\nimport { Overlay, ScrollStrategy } from '@angular/cdk/overlay';\n\n/** Time in ms to throttle repositioning after scroll events. */\nexport const SCROLL_THROTTLE_MS = 20;\n\n/** Injection token that determines the scroll handling while a popover is visible. */\nexport const GHOST_RIDER_POPOVER_SCROLL_STRATEGY = new InjectionToken<() => ScrollStrategy>(\n\t'GhostRiderPopoverScrollStrategy'\n);\n\n/** @docs-private */\nexport function GHOST_RIDER_POPOVER_SCROLL_STRATEGY_FACTORY(overlay: Overlay): () => ScrollStrategy {\n\treturn () => overlay.scrollStrategies.reposition(\n\t\t{\n\t\t\tscrollThrottle: SCROLL_THROTTLE_MS\n\t\t}\n\t);\n}\n\n/** @docs-private */\nexport const GHOST_RIDER_POPOVER_SCROLL_STRATEGY_FACTORY_PROVIDER = {\n\tprovide: GHOST_RIDER_POPOVER_SCROLL_STRATEGY,\n\tdeps: [Overlay],\n\tuseFactory: GHOST_RIDER_POPOVER_SCROLL_STRATEGY_FACTORY,\n};\n","import { ViewportRuler } from '@angular/cdk/scrolling';\nimport { DOCUMENT } from '@angular/common';\nimport { Injectable, Inject } from '@angular/core';\nimport { GhostRiderPopoverContainer } from '../tokens/popover-container.token';\n\n@Injectable({ providedIn: 'root' })\nexport class GhostRiderRootPopoverContainer implements GhostRiderPopoverContainer {\n\tprivate _document: Document;\n\n\tconstructor(\n\t\t@Inject(DOCUMENT) document: any,\n\t\tprivate _viewportRuler: ViewportRuler,\n\t) {\n\t\tthis._document = document;\n\t}\n\n\tpublic getBoundingClientRect(): DOMRect {\n\t\tconst width = this._document.documentElement.clientWidth;\n\t\tconst height = this._document.documentElement.clientHeight;\n\t\tconst scrollPosition = this._viewportRuler.getViewportScrollPosition();\n\n\t\treturn {\n\t\t\ttop: scrollPosition.top,\n\t\t\tleft: scrollPosition.left,\n\t\t\tright: scrollPosition.left + width,\n\t\t\tbottom: scrollPosition.top + height,\n\t\t\twidth,\n\t\t\theight,\n\t\t} as DOMRect;\n\t}\n}\n","import { InjectionToken } from '@angular/core';\nimport { GhostRiderRootPopoverContainer } from '../providers/popover-container.service';\n\nexport interface GhostRiderPopoverContainer {\n\tgetBoundingClientRect(): DOMRect;\n}\n\nexport const GHOST_RIDER_POPOVER_CONTAINER = new InjectionToken<GhostRiderPopoverContainer>('GhostRiderPopoverContainer');\n\nexport const GHOST_RIDER_POPOVER_CONTAINER_FACTORY_PROVIDER = {\n\tprovide: GHOST_RIDER_POPOVER_CONTAINER,\n\tuseExisting: GhostRiderRootPopoverContainer,\n};\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport { ElementRef, FactoryProvider, InjectionToken } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n\nimport { coerceCssPixelValue, coerceArray } from '@angular/cdk/coercion';\nimport {\n\tConnectedOverlayPositionChange,\n\tConnectedPosition,\n\tConnectionPositionPair,\n\tOverlayContainer,\n\tOverlayRef,\n\tPositionStrategy,\n\tScrollingVisibility,\n\tvalidateHorizontalPosition,\n\tvalidateVerticalPosition,\n} from '@angular/cdk/overlay';\nimport { Platform } from '@angular/cdk/platform';\nimport { ViewportRuler, CdkScrollable, ViewportScrollPosition } from '@angular/cdk/scrolling';\n\nimport { Observable, Subscription, Subject } from 'rxjs';\n\n// Providers\nimport { GhostRiderPopoverContainer } from '../tokens/popover-container.token';\nimport { GhostRiderRootPopoverContainer } from '../providers/popover-container.service';\n\n/** Class to be added to the overlay bounding box. */\nconst boundingBoxClass = 'cdk-overlay-connected-position-bounding-box';\n\n/** Injection token that determines the position handling while a popover is visible. */\nexport const GHOST_RIDER_POPOVER_POSITION_STRATEGY = new InjectionToken<PopoverPositionStrategyFactory>('PopoverPositionStrategy');\n\n/** Possible values that can be set as the origin of a PopoverPositionStrategy. */\nexport type PopoverPositionStrategyOrigin = ElementRef | HTMLElement | Point & {\n\twidth?: number;\n\theight?: number;\n};\n\nexport type PopoverPositionStrategyFactory\n\t= (origin: PopoverPositionStrategyOrigin) => PopoverPositionStrategy;\n\nexport interface PopoverPositionStrategy extends PositionStrategy {\n\tpositionChanges: Observable<ConnectedOverlayPositionChange>;\n\twithScrollableContainers(scrollables: CdkScrollable[]): this;\n\twithPositions(positions: ConnectedPosition[]): this;\n\twithContainer(container: GhostRiderPopoverContainer): this;\n}\n\n/**\n * A strategy for positioning overlays. Using this strategy, an overlay is given an\n * implicit position relative some origin element. The relative position is defined in terms of\n * a point on the origin element that is connected to a point on the overlay element. For example,\n * a basic dropdown is connecting the bottom-left corner of the origin to the top-left corner\n * of the overlay.\n */\nexport class PopoverPositionStrategy implements PositionStrategy {\n\t/** The overlay to which this strategy is attached. */\n\tprotected _overlayRef!: OverlayRef;\n\n\t/** Whether we're performing the very first positioning of the overlay. */\n\tprotected _isInitialRender!: boolean;\n\n\t/** Last size used for the bounding box. Used to avoid resizing the overlay after open. */\n\tprotected _lastBoundingBoxSize = { width: 0, height: 0 };\n\n\t/** Whether the overlay was pushed in a previous positioning. */\n\tprotected _isPushed = false;\n\n\t/** Whether the overlay can be pushed on-screen on the initial open. */\n\tprotected _canPush = true;\n\n\t/** Whether the overlay can grow via flexible width/height after the initial open. */\n\tprotected _growAfterOpen = false;\n\n\t/** Whether the overlay's width and height can be constrained to fit within the viewport. */\n\tprotected _hasFlexibleDimensions = false;\n\n\t/** Whether the overlay position is locked. */\n\tprotected _positionLocked = false;\n\n\t/** Cached origin dimensions */\n\tprotected _originRect!: ClientRect;\n\n\t/** Cached overlay dimensions */\n\tprotected _overlayRect!: ClientRect;\n\n\t/** Cached viewport dimensions */\n\tprotected _viewportRect!: ClientRect;\n\n\tprotected _containerRect!: ClientRect;\n\n\t/** Amount of space that must be maintained between the overlay and the edge of the viewport. */\n\tprotected _viewportMargin = 8;\n\n\t/** The Scrollable containers used to check scrollable view properties on position change. */\n\tprotected _scrollables: CdkScrollable[] = [];\n\n\tprotected _container: GhostRiderPopoverContainer = this._rootContainer;\n\n\t/** Ordered list of preferred positions, from most to least desirable. */\n\t_preferredPositions: ConnectionPositionPair[] = [];\n\n\t/** The origin element against which the overlay will be positioned. */\n\tprotected _origin!: PopoverPositionStrategyOrigin;\n\n\t/** The overlay pane element. */\n\tprotected _pane!: HTMLElement;\n\n\t/** Whether the strategy has been disposed of already. */\n\tprotected _isDisposed!: boolean;\n\n\t/**\n\t * Parent element for the overlay panel used to constrain the overlay panel's size to fit\n\t * within the viewport.\n\t */\n\tprotected _boundingBox!: HTMLElement | null;\n\n\t/** The last position to have been calculated as the best fit position. */\n\tprotected _lastPosition!: ConnectedPosition | null;\n\n\t/** Subject that emits whenever the position changes. */\n\tprotected _positionChanges = new Subject<ConnectedOverlayPositionChange>();\n\n\t/** Subscription to viewport size changes. */\n\tprotected _resizeSubscription = Subscription.EMPTY;\n\n\t/** Default offset for the overlay along the x axis. */\n\tprotected _offsetX = 0;\n\n\t/** Default offset for the overlay along the y axis. */\n\tprotected _offsetY = 0;\n\n\t/** Selector to be used when finding the elements on which to set the transform origin. */\n\tprotected _transformOriginSelector: string = '.ghost-rider-popover';\n\n\t/** Keeps track of the CSS classes that the position strategy has applied on the overlay panel. */\n\tprotected _appliedPanelClasses: string[] = [];\n\n\t/** Amount by which the overlay was pushed in each axis during the last time it was positioned. */\n\tprotected _previousPushAmount!: { x: number, y: number } | null;\n\n\t/** Observable sequence of position changes. */\n\tpositionChanges: Observable<ConnectedOverlayPositionChange> = this._positionChanges.asObservable();\n\n\t/** Ordered list of preferred positions, from most to least desirable. */\n\tget positions(): ConnectionPositionPair[] {\n\t\treturn this._preferredPositions;\n\t}\n\n\tconstructor(\n\t\tconnectedTo: PopoverPositionStrategyOrigin,\n\t\tprotected _viewportRuler: ViewportRuler,\n\t\tprotected _document: Document,\n\t\tprotected _platform: Platform,\n\t\tprotected _overlayContainer: OverlayContainer,\n\t\tprotected _rootContainer: GhostRiderRootPopoverContainer,\n\t) {\n\t\tthis.setOrigin(connectedTo);\n\t}\n\n\t/** Attaches this position strategy to an overlay. */\n\tattach(overlayRef: OverlayRef): void {\n\t\tif (this._overlayRef && overlayRef !== this._overlayRef) {\n\t\t\tthrow Error('This position strategy is already attached to an overlay');\n\t\t}\n\n\t\tthis._validatePositions();\n\n\t\toverlayRef.hostElement.classList.add(boundingBoxClass);\n\n\t\tthis._overlayRef = overlayRef;\n\t\tthis._boundingBox = overlayRef.hostElement;\n\t\tthis._pane = overlayRef.overlayElement;\n\t\tthis._isDisposed = false;\n\t\tthis._isInitialRender = true;\n\t\tthis._lastPosition = null;\n\t\tthis._resizeSubscription.unsubscribe();\n\t\tthis._resizeSubscription = this._viewportRuler.change().subscribe(() => {\n\t\t\t// When the window is resized, we want to trigger the next reposition as if it\n\t\t\t// was an initial render, in order for the strategy to pick a new optimal position,\n\t\t\t// otherwise position locking will cause it to stay at the old one.\n\t\t\tthis._isInitialRender = true;\n\t\t\tthis.apply();\n\t\t});\n\t}\n\n\t/**\n\t * Updates the position of the overlay element, using whichever preferred position relative\n\t * to the origin best fits on-screen.\n\t *\n\t * The selection of a position goes as follows:\n\t *  - If any positions fit completely within the viewport as-is,\n\t *      choose the first position that does so.\n\t *  - If flexible dimensions are enabled and at least one satifies the given minimum width/height,\n\t *      choose the position with the greatest available size modified by the positions' weight.\n\t *  - If pushing is enabled, take the position that went off-screen the least and push it\n\t *      on-screen.\n\t *  - If none of the previous criteria were met, use the position that goes off-screen the least.\n\t * @docs-private\n\t */\n\tapply(): void {\n\t\t// We shouldn't do anything if the strategy was disposed or we're on the server.\n\t\tif (this._isDisposed || !this._platform.isBrowser) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If the position has been applied already (e.g. when the overlay was opened) and the\n\t\t// consumer opted into locking in the position, re-use the old position, in order to\n\t\t// prevent the overlay from jumping around.\n\t\tif (!this._isInitialRender && this._positionLocked && this._lastPosition) {\n\t\t\tthis.reapplyLastPosition();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._clearPanelClasses();\n\t\tthis._resetOverlayElementStyles();\n\t\tthis._resetBoundingBoxStyles();\n\n\t\t// We need the bounding rects for the origin and the overlay to determine how to position\n\t\t// the overlay relative to the origin.\n\t\t// We use the viewport rect to determine whether a position would go off-screen.\n\t\tthis._viewportRect = this._getNarrowedRect(this._rootContainer);\n\t\tthis._originRect = this._getOriginRect();\n\t\tthis._overlayRect = this._pane.getBoundingClientRect();\n\t\tthis._containerRect = this._getNarrowedRect(this._container);\n\n\t\tconst originRect = this._originRect;\n\t\tconst overlayRect = this._overlayRect;\n\t\tconst viewportRect = this._viewportRect;\n\t\tconst containerRect = this._containerRect;\n\n\t\t// Positions where the overlay will fit with flexible dimensions.\n\t\tconst flexibleFits: FlexibleFit[] = [];\n\n\t\t// Fallback if none of the preferred positions fit within the viewport.\n\t\tlet fallback: FallbackPosition | undefined;\n\n\t\t// Go through each of the preferred positions looking for a good fit.\n\t\t// If a good fit is found, it will be applied immediately.\n\t\tfor (const pos of this._preferredPositions) {\n\t\t\t// Get the exact (x, y) coordinate for the point-of-origin on the origin element.\n\t\t\tconst originPoint = this._getOriginPoint(originRect, pos);\n\n\t\t\t// From that point-of-origin, get the exact (x, y) coordinate for the top-left corner of the\n\t\t\t// overlay in this position. We use the top-left corner for calculations and later translate\n\t\t\t// this into an appropriate (top, left, bottom, right) style.\n\t\t\tconst overlayPoint = this._getOverlayPoint(originPoint, overlayRect, pos);\n\n\t\t\t// Calculate how well the overlay would fit into the viewport with this point.\n\t\t\tconst overlayFit = this._getOverlayFit(overlayPoint, overlayRect, containerRect, pos);\n\n\t\t\t// If the overlay, without any further work, fits into the viewport, use this position.\n\t\t\tif (overlayFit.isCompletelyWithinViewport) {\n\t\t\t\tthis._isPushed = false;\n\t\t\t\tthis._applyPosition(pos, originPoint);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If the overlay has flexible dimensions, we can use this position\n\t\t\t// so long as there's enough space for the minimum dimensions.\n\t\t\tif (this._canFitWithFlexibleDimensions(overlayFit, overlayPoint, viewportRect)) {\n\t\t\t\t// Save positions where the overlay will fit with flexible dimensions. We will use these\n\t\t\t\t// if none of the positions fit *without* flexible dimensions.\n\t\t\t\tflexibleFits.push({\n\t\t\t\t\tposition: pos,\n\t\t\t\t\torigin: originPoint,\n\t\t\t\t\toverlayRect,\n\t\t\t\t\tboundingBoxRect: this._calculateBoundingBoxRect(originPoint, pos),\n\t\t\t\t});\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the current preferred position does not fit on the screen, remember the position\n\t\t\t// if it has more visible area on-screen than we've seen and move onto the next preferred\n\t\t\t// position.\n\t\t\tif (!fallback || fallback.overlayFit.visibleArea < overlayFit.visibleArea) {\n\t\t\t\tfallback = { overlayFit, overlayPoint, originPoint, position: pos, overlayRect };\n\t\t\t}\n\t\t}\n\n\t\t// If there are any positions where the overlay would fit with flexible dimensions, choose the\n\t\t// one that has the greatest area available modified by the position's weight\n\t\tif (flexibleFits.length) {\n\t\t\tlet bestFit: FlexibleFit = null as unknown as FlexibleFit;\n\t\t\tlet bestScore = -1;\n\t\t\tfor (const fit of flexibleFits) {\n\t\t\t\tconst score =\n\t\t\t\t\tfit.boundingBoxRect.width * fit.boundingBoxRect.height * (fit.position.weight || 1);\n\t\t\t\tif (score > bestScore) {\n\t\t\t\t\tbestScore = score;\n\t\t\t\t\tbestFit = fit;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._isPushed = false;\n\t\t\tthis._applyPosition(bestFit.position, bestFit.origin);\n\t\t\treturn;\n\t\t}\n\n\t\t// When none of the preferred positions fit within the viewport, take the position\n\t\t// that went off-screen the least and attempt to push it on-screen.\n\t\tif (this._canPush) {\n\t\t\tthis._isPushed = true;\n\t\t\tthis._applyPosition(fallback!.position, fallback!.originPoint);\n\t\t\treturn;\n\t\t}\n\n\t\t// All options for getting the overlay within the viewport have been exhausted, so go with the\n\t\t// position that went off-screen the least.\n\t\tthis._applyPosition(fallback!.position, fallback!.originPoint);\n\t}\n\n\tdetach(): void {\n\t\tthis._clearPanelClasses();\n\t\tthis._lastPosition = null;\n\t\tthis._previousPushAmount = null;\n\t\tthis._resizeSubscription.unsubscribe();\n\t}\n\n\t/** Cleanup after the element gets destroyed. */\n\tdispose(): void {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\t// We can't use `_resetBoundingBoxStyles` here, because it resets\n\t\t// some properties to zero, rather than removing them.\n\t\tif (this._boundingBox) {\n\t\t\textendStyles(this._boundingBox.style, {\n\t\t\t\ttop: '',\n\t\t\t\tleft: '',\n\t\t\t\tright: '',\n\t\t\t\tbottom: '',\n\t\t\t\theight: '',\n\t\t\t\twidth: '',\n\t\t\t\talignItems: '',\n\t\t\t\tjustifyContent: '',\n\t\t\t} as CSSStyleDeclaration);\n\t\t}\n\n\t\tif (this._pane) {\n\t\t\tthis._resetOverlayElementStyles();\n\t\t}\n\n\t\tif (this._overlayRef) {\n\t\t\tthis._overlayRef.hostElement.classList.remove(boundingBoxClass);\n\t\t}\n\n\t\tthis.detach();\n\t\tthis._positionChanges.complete();\n\t\tthis._overlayRef = this._boundingBox = null as any;\n\t\tthis._isDisposed = true;\n\t}\n\n\t/**\n\t * This re-aligns the overlay element with the trigger in its last calculated position,\n\t * even if a position higher in the \"preferred positions\" list would now fit. This\n\t * allows one to re-align the panel without changing the orientation of the panel.\n\t */\n\treapplyLastPosition(): void {\n\t\tif (!this._isDisposed && (!this._platform || this._platform.isBrowser)) {\n\t\t\tthis._originRect = this._getOriginRect();\n\t\t\tthis._overlayRect = this._pane.getBoundingClientRect();\n\t\t\tthis._viewportRect = this._getNarrowedRect(this._rootContainer);\n\n\t\t\tconst lastPosition = this._lastPosition || this._preferredPositions[0];\n\t\t\tconst originPoint = this._getOriginPoint(this._originRect, lastPosition);\n\n\t\t\tthis._applyPosition(lastPosition, originPoint);\n\t\t}\n\t}\n\n\t/**\n\t * Sets the list of Scrollable containers that host the origin element so that\n\t * on reposition we can evaluate if it or the overlay has been clipped or outside view. Every\n\t * Scrollable must be an ancestor element of the strategy's origin element.\n\t */\n\twithScrollableContainers(scrollables: CdkScrollable[]): this {\n\t\tthis._scrollables = scrollables;\n\t\treturn this;\n\t}\n\n\twithContainer(container: GhostRiderPopoverContainer): this {\n\t\tthis._container = container || this._rootContainer;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds new preferred positions.\n\t * @param positions List of positions options for this overlay.\n\t */\n\twithPositions(positions: ConnectedPosition[]): this {\n\t\tthis._preferredPositions = positions;\n\n\t\t// If the last calculated position object isn't part of the positions anymore, clear\n\t\t// it in order to avoid it being picked up if the consumer tries to re-apply.\n\t\tif (positions.indexOf(this._lastPosition as ConnectedPosition) === -1) {\n\t\t\tthis._lastPosition = null;\n\t\t}\n\n\t\tthis._validatePositions();\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the origin, relative to which to position the overlay.\n\t * Using an element origin is useful for building components that need to be positioned\n\t * relatively to a trigger (e.g. dropdown menus or tooltips), whereas using a point can be\n\t * used for cases like contextual menus which open relative to the user's pointer.\n\t * @param origin Reference to the new origin.\n\t */\n\tsetOrigin(origin: PopoverPositionStrategyOrigin): this {\n\t\tthis._origin = origin;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Gets the (x, y) coordinate of a connection point on the origin based on a relative position.\n\t */\n\tprivate _getOriginPoint(originRect: ClientRect, pos: ConnectedPosition): Point {\n\t\tlet x: number;\n\t\tif (pos.originX === 'center') {\n\t\t\t// Note: when centering we should always use the `left`\n\t\t\t// offset, otherwise the position will be wrong in RTL.\n\t\t\tx = originRect.left + (originRect.width / 2);\n\t\t} else {\n\t\t\tconst startX = this._isRtl() ? originRect.right : originRect.left;\n\t\t\tconst endX = this._isRtl() ? originRect.left : originRect.right;\n\t\t\tx = pos.originX === 'start' ? startX : endX;\n\t\t}\n\n\t\tlet y: number;\n\t\tif (pos.originY === 'center') {\n\t\t\ty = originRect.top + (originRect.height / 2);\n\t\t} else {\n\t\t\ty = pos.originY === 'top' ? originRect.top : originRect.bottom;\n\t\t}\n\n\t\treturn { x, y };\n\t}\n\n\t/**\n\t * Gets the (x, y) coordinate of the top-left corner of the overlay given a given position and\n\t * origin point to which the overlay should be connected.\n\t */\n\tprivate _getOverlayPoint(\n\t\toriginPoint: Point,\n\t\toverlayRect: ClientRect,\n\t\tpos: ConnectedPosition): Point {\n\n\t\t// Calculate the (overlayStartX, overlayStartY), the start of the\n\t\t// potential overlay position relative to the origin point.\n\t\tlet overlayStartX: number;\n\t\tif (pos.overlayX === 'center') {\n\t\t\toverlayStartX = -overlayRect.width / 2;\n\t\t} else if (pos.overlayX === 'start') {\n\t\t\toverlayStartX = this._isRtl() ? -overlayRect.width : 0;\n\t\t} else {\n\t\t\toverlayStartX = this._isRtl() ? 0 : -overlayRect.width;\n\t\t}\n\n\t\tlet overlayStartY: number;\n\t\tif (pos.overlayY === 'center') {\n\t\t\toverlayStartY = -overlayRect.height / 2;\n\t\t} else {\n\t\t\toverlayStartY = pos.overlayY === 'top' ? 0 : -overlayRect.height;\n\t\t}\n\n\t\t// The (x, y) coordinates of the overlay.\n\t\treturn {\n\t\t\tx: originPoint.x + overlayStartX,\n\t\t\ty: originPoint.y + overlayStartY,\n\t\t};\n\t}\n\n\t/** Gets how well an overlay at the given point will fit within the viewport. */\n\tprivate _getOverlayFit(\n\t\tpoint: Point,\n\t\toverlay: ClientRect,\n\t\tviewport: ClientRect,\n\t\tposition: ConnectedPosition,\n\t): OverlayFit {\n\t\tlet { x, y } = point;\n\t\tconst offsetX = this._getOffset(position, 'x');\n\t\tconst offsetY = this._getOffset(position, 'y');\n\n\t\t// Account for the offsets since they could push the overlay out of the viewport.\n\t\tif (offsetX) {\n\t\t\tx += offsetX;\n\t\t}\n\n\t\tif (offsetY) {\n\t\t\ty += offsetY;\n\t\t}\n\n\t\t// How much the overlay would overflow at this position, on each side.\n\t\tconst leftOverflow = viewport.left - x;\n\t\tconst rightOverflow = (x + overlay.width) - viewport.right;\n\t\tconst topOverflow = viewport.top - y;\n\t\tconst bottomOverflow = (y + overlay.height) - viewport.bottom;\n\n\t\t// Visible parts of the element on each axis.\n\t\tconst visibleWidth = this._subtractOverflows(overlay.width, leftOverflow, rightOverflow);\n\t\tconst visibleHeight = this._subtractOverflows(overlay.height, topOverflow, bottomOverflow);\n\t\tconst visibleArea = visibleWidth * visibleHeight;\n\n\t\treturn {\n\t\t\tvisibleArea: Math.abs(visibleArea),\n\t\t\t// visibleArea,\n\t\t\tisCompletelyWithinViewport: (overlay.width * overlay.height) === visibleArea,\n\t\t\tfitsInViewportVertically: visibleHeight === overlay.height,\n\t\t\tfitsInViewportHorizontally: visibleWidth === overlay.width,\n\t\t};\n\t}\n\n\t/**\n\t * Whether the overlay can fit within the viewport when it may resize either its width or height.\n\t * @param fit How well the overlay fits in the viewport at some position.\n\t * @param point The (x, y) coordinates of the overlat at some position.\n\t * @param viewport The geometry of the viewport.\n\t */\n\tprivate _canFitWithFlexibleDimensions(fit: OverlayFit, point: Point, viewport: ClientRect) {\n\t\tif (this._hasFlexibleDimensions) {\n\t\t\tconst availableHeight = viewport.bottom - point.y;\n\t\t\tconst availableWidth = viewport.right - point.x;\n\t\t\tconst minHeight = this._overlayRef.getConfig().minHeight;\n\t\t\tconst minWidth = this._overlayRef.getConfig().minWidth;\n\n\t\t\tconst verticalFit = fit.fitsInViewportVertically ||\n\t\t\t\t(minHeight != null && minHeight <= availableHeight);\n\t\t\tconst horizontalFit = fit.fitsInViewportHorizontally ||\n\t\t\t\t(minWidth != null && minWidth <= availableWidth);\n\n\t\t\treturn verticalFit && horizontalFit;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Gets the point at which the overlay can be \"pushed\" on-screen. If the overlay is larger than\n\t * the viewport, the top-left corner will be pushed on-screen (with overflow occuring on the\n\t * right and bottom).\n\t *\n\t * @param start Starting point from which the overlay is pushed.\n\t * @param overlay Dimensions of the overlay.\n\t * @param scrollPosition Current viewport scroll position.\n\t * @returns The point at which to position the overlay after pushing. This is effectively a new\n\t *     originPoint.\n\t */\n\tprivate _pushOverlayOnScreen(\n\t\tstart: Point,\n\t\toverlay: ClientRect,\n\t\tscrollPosition: ViewportScrollPosition,\n\t\tposition: ConnectionPositionPair,\n\t): Point {\n\t\t// If the position is locked and we've pushed the overlay already, reuse the previous push\n\t\t// amount, rather than pushing it again. If we were to continue pushing, the element would\n\t\t// remain in the viewport, which goes against the expectations when position locking is enabled.\n\t\tif (this._previousPushAmount && this._positionLocked) {\n\t\t\treturn {\n\t\t\t\tx: start.x + this._previousPushAmount.x,\n\t\t\t\ty: start.y + this._previousPushAmount.y,\n\t\t\t};\n\t\t}\n\n\t\tconst container = this._containerRect;\n\n\t\t// Determine how much the overlay goes outside the container on each\n\t\t// side, which we'll use to decide which direction to push it.\n\t\tconst overflowRight = Math.max(start.x + overlay.width - container.right + (position.offsetX || 0), 0);\n\t\tconst overflowBottom = Math.max(start.y + overlay.height - container.bottom + (position.offsetY || 0), 0);\n\t\tconst overflowTop = Math.max(container.top - scrollPosition.top - start.y - (position.offsetY || 0), 0);\n\t\tconst overflowLeft = Math.max(container.left - scrollPosition.left - start.x - (position.offsetX || 0), 0);\n\n\t\t// Amount by which to push the overlay in each axis such that it remains on-screen.\n\t\tlet pushX = 0;\n\t\tlet pushY = 0;\n\n\t\t// If the overlay fits completely within the bounds of the container, push it from whichever\n\t\t// direction is goes off-screen. Otherwise, push the top-left corner such that its in the\n\t\t// container and allow for the trailing end of the overlay to go out of bounds.\n\t\tif (overlay.width <= container.width) {\n\t\t\tpushX = overflowLeft || -overflowRight;\n\t\t} else {\n\t\t\tpushX = start.x < this._viewportMargin ? (container.left - scrollPosition.left) - start.x : 0;\n\t\t}\n\n\t\tif (overlay.height <= container.height) {\n\t\t\tpushY = overflowTop || -overflowBottom;\n\t\t} else {\n\t\t\tpushY = start.y < this._viewportMargin ? (container.top - scrollPosition.top) - start.y : 0;\n\t\t}\n\n\t\tthis._previousPushAmount = { x: pushX, y: pushY };\n\n\t\treturn {\n\t\t\tx: start.x + pushX,\n\t\t\ty: start.y + pushY,\n\t\t};\n\t}\n\n\t/**\n\t * Applies a computed position to the overlay and emits a position change.\n\t * @param position The position preference\n\t * @param originPoint The point on the origin element where the overlay is connected.\n\t */\n\tprivate _applyPosition(position: ConnectedPosition, originPoint: Point) {\n\t\tthis._setTransformOrigin(position);\n\t\tthis._setOverlayElementStyles(originPoint, position);\n\t\tthis._setBoundingBoxStyles(originPoint, position);\n\n\t\tif (position.panelClass) {\n\t\t\tthis._addPanelClasses(position.panelClass);\n\t\t}\n\n\t\t// Save the last connected position in case the position needs to be re-calculated.\n\t\tthis._lastPosition = position;\n\n\t\t// Notify that the position has been changed along with its change properties.\n\t\t// We only emit if we've got any subscriptions, because the scroll visibility\n\t\t// calculcations can be somewhat expensive.\n\t\tif (this._positionChanges.observers.length) {\n\t\t\tconst scrollableViewProperties = this._getScrollVisibility();\n\t\t\tconst changeEvent = new ConnectedOverlayPositionChange(position, scrollableViewProperties);\n\t\t\tthis._positionChanges.next(changeEvent);\n\t\t}\n\n\t\tthis._isInitialRender = false;\n\t}\n\n\t/** Sets the transform origin based on the configured selector and the passed-in position.  */\n\tprivate _setTransformOrigin(position: ConnectedPosition) {\n\t\tif (!this._transformOriginSelector) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst elements: NodeListOf<HTMLElement> = this._boundingBox!.querySelectorAll(this._transformOriginSelector);\n\t\tlet xOrigin: 'left' | 'right' | 'center';\n\t\tconst yOrigin: 'top' | 'bottom' | 'center' = position.overlayY;\n\n\t\tif (position.overlayX === 'center') {\n\t\t\txOrigin = 'center';\n\t\t} else if (this._isRtl()) {\n\t\t\txOrigin = position.overlayX === 'start' ? 'right' : 'left';\n\t\t} else {\n\t\t\txOrigin = position.overlayX === 'start' ? 'left' : 'right';\n\t\t}\n\n\t\tfor (let i = 0; i < elements.length; i++) {\n\t\t\telements[i].style.transformOrigin = `${xOrigin} ${yOrigin}`;\n\t\t}\n\t}\n\n\t/**\n\t * Gets the position and size of the overlay's sizing container.\n\t *\n\t * This method does no measuring and applies no styles so that we can cheaply compute the\n\t * bounds for all positions and choose the best fit based on these results.\n\t */\n\tprivate _calculateBoundingBoxRect(origin: Point, position: ConnectedPosition): BoundingBoxRect {\n\t\tconst container = this._containerRect;\n\t\tconst isRtl = this._isRtl();\n\t\tlet height: number;\n\t\tlet top: number;\n\t\tlet bottom: number;\n\n\t\tif (position.overlayY === 'top') {\n\t\t\t// Overlay is opening \"downward\" and thus is bound by the bottom viewport edge.\n\t\t\ttop = origin.y;\n\t\t\theight = container.height - top + this._viewportMargin;\n\t\t} else if (position.overlayY === 'bottom') {\n\t\t\t// Overlay is opening \"upward\" and thus is bound by the top container edge. We need to add\n\t\t\t// the container margin back in, because the container rect is narrowed down to remove the\n\t\t\t// margin, whereas the `origin` position is calculated based on its `ClientRect`.\n\t\t\tbottom = container.height - origin.y + this._viewportMargin * 2;\n\t\t\theight = container.height - bottom + this._viewportMargin;\n\t\t} else {\n\t\t\t// If neither top nor bottom, it means that the overlay is vertically centered on the\n\t\t\t// origin point. Note that we want the position relative to the viewport, rather than\n\t\t\t// the page, which is why we don't use something like `viewport.bottom - origin.y` and\n\t\t\t// `origin.y - container.top`.\n\t\t\tconst smallestDistanceTocontainerEdge =\n\t\t\t\tMath.min(container.bottom - origin.y + container.top, origin.y);\n\n\t\t\tconst previousHeight = this._lastBoundingBoxSize.height;\n\n\t\t\theight = smallestDistanceTocontainerEdge * 2;\n\t\t\ttop = origin.y - smallestDistanceTocontainerEdge;\n\n\t\t\tif (height > previousHeight && !this._isInitialRender && !this._growAfterOpen) {\n\t\t\t\ttop = origin.y - (previousHeight / 2);\n\t\t\t}\n\t\t}\n\n\t\t// The overlay is opening 'right-ward' (the content flows to the right).\n\t\tconst isBoundedByRightContainerEdge =\n\t\t\t(position.overlayX === 'start' && !isRtl) ||\n\t\t\t(position.overlayX === 'end' && isRtl);\n\n\t\t// The overlay is opening 'left-ward' (the content flows to the left).\n\t\tconst isBoundedByLeftContainerEdge =\n\t\t\t(position.overlayX === 'end' && !isRtl) ||\n\t\t\t(position.overlayX === 'start' && isRtl);\n\n\t\tlet width: number;\n\t\tlet left: number;\n\t\tlet right: number;\n\n\t\tif (isBoundedByLeftContainerEdge) {\n\t\t\tright = container.width - origin.x + this._viewportMargin;\n\t\t\twidth = origin.x - this._viewportMargin;\n\t\t} else if (isBoundedByRightContainerEdge) {\n\t\t\tleft = origin.x;\n\t\t\twidth = container.right - origin.x;\n\t\t} else {\n\t\t\t// If neither start nor end, it means that the overlay is horizontally centered on the\n\t\t\t// origin point. Note that we want the position relative to the container, rather than\n\t\t\t// the page, which is why we don't use something like `container.right - origin.x` and\n\t\t\t// `origin.x - container.left`.\n\t\t\tconst smallestDistanceToContainerEdge =\n\t\t\t\tMath.min(container.right - origin.x + container.left, origin.x);\n\t\t\tconst previousWidth = this._lastBoundingBoxSize.width;\n\n\t\t\twidth = smallestDistanceToContainerEdge * 2;\n\t\t\tleft = origin.x - smallestDistanceToContainerEdge;\n\n\t\t\tif (width > previousWidth && !this._isInitialRender && !this._growAfterOpen) {\n\t\t\t\tleft = origin.x - (previousWidth / 2);\n\t\t\t}\n\t\t}\n\n\t\t// @ts-ignore\n\t\treturn { top, left, bottom, right, width, height };\n\t}\n\n\t/**\n\t * Sets the position and size of the overlay's sizing wrapper. The wrapper is positioned on the\n\t * origin's connection point and stetches to the bounds of the viewport.\n\t *\n\t * @param origin The point on the origin element where the overlay is connected.\n\t * @param position The position preference\n\t */\n\tprivate _setBoundingBoxStyles(origin: Point, position: ConnectedPosition): void {\n\t\tconst boundingBoxRect = this._calculateBoundingBoxRect(origin, position);\n\n\t\t// It's weird if the overlay *grows* while scrolling, so we take the last size into account\n\t\t// when applying a new size.\n\t\tif (!this._isInitialRender && !this._growAfterOpen) {\n\t\t\tboundingBoxRect.height = Math.min(boundingBoxRect.height, this._lastBoundingBoxSize.height);\n\t\t\tboundingBoxRect.width = Math.min(boundingBoxRect.width, this._lastBoundingBoxSize.width);\n\t\t}\n\n\t\tconst styles = {} as CSSStyleDeclaration;\n\n\t\tif (this._hasExactPosition()) {\n\t\t\tstyles.top = styles.left = '0';\n\t\t\tstyles.bottom = styles.right = '';\n\t\t\tstyles.width = styles.height = '100%';\n\t\t} else {\n\t\t\tconst maxHeight = this._overlayRef.getConfig().maxHeight;\n\t\t\tconst maxWidth = this._overlayRef.getConfig().maxWidth;\n\n\t\t\tstyles.height = coerceCssPixelValue(boundingBoxRect.height);\n\t\t\tstyles.top = coerceCssPixelValue(boundingBoxRect.top);\n\t\t\tstyles.bottom = coerceCssPixelValue(boundingBoxRect.bottom);\n\t\t\tstyles.width = coerceCssPixelValue(boundingBoxRect.width);\n\t\t\tstyles.left = coerceCssPixelValue(boundingBoxRect.left);\n\t\t\tstyles.right = coerceCssPixelValue(boundingBoxRect.right);\n\n\t\t\t// Push the pane content towards the proper direction.\n\t\t\tif (position.overlayX === 'center') {\n\t\t\t\tstyles.alignItems = 'center';\n\t\t\t} else {\n\t\t\t\tstyles.alignItems = position.overlayX === 'end' ? 'flex-end' : 'flex-start';\n\t\t\t}\n\n\t\t\tif (position.overlayY === 'center') {\n\t\t\t\tstyles.justifyContent = 'center';\n\t\t\t} else {\n\t\t\t\tstyles.justifyContent = position.overlayY === 'bottom' ? 'flex-end' : 'flex-start';\n\t\t\t}\n\n\t\t\tif (maxHeight) {\n\t\t\t\tstyles.maxHeight = coerceCssPixelValue(maxHeight);\n\t\t\t}\n\n\t\t\tif (maxWidth) {\n\t\t\t\tstyles.maxWidth = coerceCssPixelValue(maxWidth);\n\t\t\t}\n\t\t}\n\n\t\tthis._lastBoundingBoxSize = boundingBoxRect;\n\n\t\textendStyles(this._boundingBox!.style, styles);\n\t}\n\n\t/** Resets the styles for the bounding box so that a new positioning can be computed. */\n\tprivate _resetBoundingBoxStyles() {\n\t\textendStyles(this._boundingBox!.style, {\n\t\t\ttop: '0',\n\t\t\tleft: '0',\n\t\t\tright: '0',\n\t\t\tbottom: '0',\n\t\t\theight: '',\n\t\t\twidth: '',\n\t\t\talignItems: '',\n\t\t\tjustifyContent: '',\n\t\t} as CSSStyleDeclaration);\n\t}\n\n\t/** Resets the styles for the overlay pane so that a new positioning can be computed. */\n\tprivate _resetOverlayElementStyles() {\n\t\textendStyles(this._pane.style, {\n\t\t\ttop: '',\n\t\t\tleft: '',\n\t\t\tbottom: '',\n\t\t\tright: '',\n\t\t\tposition: '',\n\t\t\ttransform: '',\n\t\t} as CSSStyleDeclaration);\n\t}\n\n\t/** Sets positioning styles to the overlay element. */\n\tprivate _setOverlayElementStyles(originPoint: Point, position: ConnectedPosition): void {\n\t\tconst styles = {} as CSSStyleDeclaration;\n\n\t\tif (this._hasExactPosition()) {\n\t\t\tconst scrollPosition = this._viewportRuler.getViewportScrollPosition();\n\t\t\textendStyles(styles, this._getExactOverlayY(position, originPoint, scrollPosition));\n\t\t\textendStyles(styles, this._getExactOverlayX(position, originPoint, scrollPosition));\n\t\t} else {\n\t\t\tstyles.position = 'static';\n\t\t}\n\n\t\t// Use a transform to apply the offsets. We do this because the `center` positions rely on\n\t\t// being in the normal flex flow and setting a `top` / `left` at all will completely throw\n\t\t// off the position. We also can't use margins, because they won't have an effect in some\n\t\t// cases where the element doesn't have anything to \"push off of\". Finally, this works\n\t\t// better both with flexible and non-flexible positioning.\n\t\tlet transformString = '';\n\t\tconst offsetX = this._getOffset(position, 'x');\n\t\tconst offsetY = this._getOffset(position, 'y');\n\n\t\tif (offsetX) {\n\t\t\ttransformString += `translateX(${offsetX}px) `;\n\t\t}\n\n\t\tif (offsetY) {\n\t\t\ttransformString += `translateY(${offsetY}px)`;\n\t\t}\n\n\t\tstyles.transform = transformString.trim();\n\n\t\t// If a maxWidth or maxHeight is specified on the overlay, we remove them. We do this because\n\t\t// we need these values to both be set to \"100%\" for the automatic flexible sizing to work.\n\t\t// The maxHeight and maxWidth are set on the boundingBox in order to enforce the constraint.\n\t\tif (this._hasFlexibleDimensions && this._overlayRef.getConfig().maxHeight) {\n\t\t\tstyles.maxHeight = '';\n\t\t}\n\n\t\tif (this._hasFlexibleDimensions && this._overlayRef.getConfig().maxWidth) {\n\t\t\tstyles.maxWidth = '';\n\t\t}\n\n\t\textendStyles(this._pane.style, styles);\n\t}\n\n\t/** Gets the exact top/bottom for the overlay when not using flexible sizing or when pushing. */\n\tprivate _getExactOverlayY(\n\t\tposition: ConnectedPosition,\n\t\toriginPoint: Point,\n\t\tscrollPosition: ViewportScrollPosition,\n\t) {\n\t\t// Reset any existing styles. This is necessary in case the\n\t\t// preferred position has changed since the last `apply`.\n\t\t// @ts-ignore\n\t\tconst styles = { top: null, bottom: null } as CSSStyleDeclaration;\n\t\tlet overlayPoint = this._getOverlayPoint(originPoint, this._overlayRect, position);\n\n\t\tif (this._isPushed) {\n\t\t\toverlayPoint = this._pushOverlayOnScreen(overlayPoint, this._overlayRect, scrollPosition, position);\n\t\t}\n\n\t\tconst virtualKeyboardOffset = this._overlayContainer.getContainerElement().getBoundingClientRect().top;\n\n\t\t// Normally this would be zero, however when the overlay is attached to an input (e.g. in an\n\t\t// autocomplete), mobile browsers will shift everything in order to put the input in the middle\n\t\t// of the screen and to make space for the virtual keyboard. We need to account for this offset,\n\t\t// otherwise our positioning will be thrown off.\n\t\toverlayPoint.y -= virtualKeyboardOffset;\n\n\t\t// We want to set either `top` or `bottom` based on whether the overlay wants to appear\n\t\t// above or below the origin and the direction in which the element will expand.\n\t\tif (position.overlayY === 'bottom') {\n\t\t\t// When using `bottom`, we adjust the y position such that it is the distance\n\t\t\t// from the bottom of the viewport rather than the top.\n\t\t\tconst documentHeight = this._document.documentElement.clientHeight;\n\t\t\tstyles.bottom = `${documentHeight - (overlayPoint.y + this._overlayRect.height)}px`;\n\t\t} else {\n\t\t\tstyles.top = coerceCssPixelValue(overlayPoint.y);\n\t\t}\n\n\t\treturn styles;\n\t}\n\n\t/** Gets the exact left/right for the overlay when not using flexible sizing or when pushing. */\n\tprivate _getExactOverlayX(\n\t\tposition: ConnectedPosition,\n\t\toriginPoint: Point,\n\t\tscrollPosition: ViewportScrollPosition,\n\t) {\n\t\t// Reset any existing styles. This is necessary in case the preferred position has\n\t\t// changed since the last `apply`.\n\t\t// @ts-ignore\n\t\tconst styles = { left: null, right: null } as CSSStyleDeclaration;\n\t\tlet overlayPoint = this._getOverlayPoint(originPoint, this._overlayRect, position);\n\n\t\tif (this._isPushed) {\n\t\t\toverlayPoint = this._pushOverlayOnScreen(overlayPoint, this._overlayRect, scrollPosition, position);\n\t\t}\n\n\t\t// We want to set either `left` or `right` based on whether the overlay wants to appear \"before\"\n\t\t// or \"after\" the origin, which determines the direction in which the element will expand.\n\t\t// For the horizontal axis, the meaning of \"before\" and \"after\" change based on whether the\n\t\t// page is in RTL or LTR.\n\t\tlet horizontalStyleProperty: 'left' | 'right';\n\n\t\tif (this._isRtl()) {\n\t\t\thorizontalStyleProperty = position.overlayX === 'end' ? 'left' : 'right';\n\t\t} else {\n\t\t\thorizontalStyleProperty = position.overlayX === 'end' ? 'right' : 'left';\n\t\t}\n\n\t\t// When we're setting `right`, we adjust the x position such that it is the distance\n\t\t// from the right edge of the viewport rather than the left edge.\n\t\tif (horizontalStyleProperty === 'right') {\n\t\t\tconst documentWidth = this._document.documentElement.clientWidth;\n\t\t\tstyles.right = `${documentWidth - (overlayPoint.x + this._overlayRect.width)}px`;\n\t\t} else {\n\t\t\tstyles.left = coerceCssPixelValue(overlayPoint.x);\n\t\t}\n\n\t\treturn styles;\n\t}\n\n\t/**\n\t * Gets the view properties of the trigger and overlay, including whether they are clipped\n\t * or completely outside the view of any of the strategy's scrollables.\n\t */\n\tprivate _getScrollVisibility(): ScrollingVisibility {\n\t\t// Note: needs fresh rects since the position could've changed.\n\t\tconst originBounds = this._getOriginRect();\n\t\tconst overlayBounds = this._pane.getBoundingClientRect();\n\n\t\tconst scrollContainerBounds = this._scrollables.map((scrollable) => {\n\t\t\treturn scrollable.getElementRef().nativeElement.getBoundingClientRect();\n\t\t});\n\n\t\treturn {\n\t\t\tisOriginClipped: isElementClippedByScrolling(originBounds, scrollContainerBounds),\n\t\t\tisOriginOutsideView: isElementScrolledOutsideView(originBounds, scrollContainerBounds),\n\t\t\tisOverlayClipped: isElementClippedByScrolling(overlayBounds, scrollContainerBounds),\n\t\t\tisOverlayOutsideView: isElementScrolledOutsideView(overlayBounds, scrollContainerBounds),\n\t\t};\n\t}\n\n\t/** Subtracts the amount that an element is overflowing on an axis from its length. */\n\tprivate _subtractOverflows(length: number, ...overflows: number[]): number {\n\t\treturn overflows.reduce((currentValue: number, currentOverflow: number) => {\n\t\t\treturn currentValue - Math.max(currentOverflow, 0);\n\t\t}, length);\n\t}\n\n\tprivate _getNarrowedRect(container: GhostRiderPopoverContainer): ClientRect {\n\t\tconst nativeRect: ClientRect = container.getBoundingClientRect();\n\n\t\t// @ts-ignore\n\t\treturn {\n\t\t\ttop: nativeRect.top + this._viewportMargin,\n\t\t\tleft: nativeRect.left + this._viewportMargin,\n\t\t\tright: nativeRect.right - this._viewportMargin,\n\t\t\tbottom: nativeRect.bottom - this._viewportMargin,\n\t\t\twidth: nativeRect.width - (2 * this._viewportMargin),\n\t\t\theight: nativeRect.height - (2 * this._viewportMargin),\n\t\t};\n\t}\n\n\t/** Whether the we're dealing with an RTL context */\n\tprivate _isRtl() {\n\t\treturn this._overlayRef.getDirection() === 'rtl';\n\t}\n\n\t/** Determines whether the overlay uses exact or flexible positioning. */\n\tprivate _hasExactPosition() {\n\t\treturn !this._hasFlexibleDimensions || this._isPushed;\n\t}\n\n\t/** Retrieves the offset of a position along the x or y axis. */\n\tprivate _getOffset(position: ConnectedPosition, axis: 'x' | 'y') {\n\t\tif (axis === 'x') {\n\t\t\t// We don't do something like `position['offset' + axis]` in\n\t\t\t// order to avoid breking minifiers that rename properties.\n\t\t\treturn position.offsetX == null ? this._offsetX : position.offsetX;\n\t\t}\n\n\t\treturn position.offsetY == null ? this._offsetY : position.offsetY;\n\t}\n\n\t/** Validates that the current position match the expected values. */\n\tprivate _validatePositions(): void {\n\t\tif (!this._preferredPositions.length) {\n\t\t\tthrow Error('FlexibleConnectedPositionStrategy: At least one position is required.');\n\t\t}\n\n\t\t// TODO(crisbeto): remove these once Angular's template type\n\t\t// checking is advanced enough to catch these cases.\n\t\tthis._preferredPositions.forEach((pair) => {\n\t\t\tvalidateHorizontalPosition('originX', pair.originX);\n\t\t\tvalidateVerticalPosition('originY', pair.originY);\n\t\t\tvalidateHorizontalPosition('overlayX', pair.overlayX);\n\t\t\tvalidateVerticalPosition('overlayY', pair.overlayY);\n\t\t});\n\t}\n\n\t/** Adds a single CSS class or an array of classes on the overlay panel. */\n\tprivate _addPanelClasses(cssClasses: string | string[]) {\n\t\tif (this._pane) {\n\t\t\tcoerceArray(cssClasses).forEach((cssClass) => {\n\t\t\t\tif (cssClass !== '' && this._appliedPanelClasses.indexOf(cssClass) === -1) {\n\t\t\t\t\tthis._appliedPanelClasses.push(cssClass);\n\t\t\t\t\tthis._pane.classList.add(cssClass);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/** Clears the classes that the position strategy has applied from the overlay panel. */\n\tprivate _clearPanelClasses() {\n\t\tif (this._pane) {\n\t\t\tthis._appliedPanelClasses.forEach((cssClass) => {\n\t\t\t\tthis._pane.classList.remove(cssClass);\n\t\t\t});\n\t\t\tthis._appliedPanelClasses = [];\n\t\t}\n\t}\n\n\t/** Returns the ClientRect of the current origin. */\n\tprivate _getOriginRect(): ClientRect {\n\t\tconst origin = this._origin;\n\n\t\tif (origin instanceof ElementRef) {\n\t\t\treturn origin.nativeElement.getBoundingClientRect();\n\t\t}\n\n\t\tif (origin instanceof HTMLElement) {\n\t\t\treturn origin.getBoundingClientRect();\n\t\t}\n\n\t\tconst width = origin.width || 0;\n\t\tconst height = origin.height || 0;\n\n\t\t// If the origin is a point, return a client rect as if it was a 0x0 element at the point.\n\t\t// @ts-ignore\n\t\treturn {\n\t\t\ttop: origin.y,\n\t\t\tbottom: origin.y + height,\n\t\t\tleft: origin.x,\n\t\t\tright: origin.x + width,\n\t\t\theight,\n\t\t\twidth,\n\t\t};\n\t}\n}\n\n/** A simple (x, y) coordinate. */\ninterface Point {\n\tx: number;\n\ty: number;\n}\n\n/** Record of measurements for how an overlay (at a given position) fits into the viewport. */\ninterface OverlayFit {\n\t/** Whether the overlay fits completely in the viewport. */\n\tisCompletelyWithinViewport: boolean;\n\n\t/** Whether the overlay fits in the viewport on the y-axis. */\n\tfitsInViewportVertically: boolean;\n\n\t/** Whether the overlay fits in the viewport on the x-axis. */\n\tfitsInViewportHorizontally: boolean;\n\n\t/** The total visible area (in px^2) of the overlay inside the viewport. */\n\tvisibleArea: number;\n}\n\n/** Record of the measurments determining whether an overlay will fit in a specific position. */\ninterface FallbackPosition {\n\tposition: ConnectedPosition;\n\toriginPoint: Point;\n\toverlayPoint: Point;\n\toverlayFit: OverlayFit;\n\toverlayRect: ClientRect;\n}\n\n/** Position and size of the overlay sizing wrapper for a specific position. */\ninterface BoundingBoxRect extends ClientRect { // height/width readonly on CientRect\n\theight: number;\n\twidth: number;\n}\n\n/** Record of measures determining how well a given position will fit with flexible dimensions. */\ninterface FlexibleFit {\n\tposition: ConnectedPosition;\n\torigin: Point;\n\toverlayRect: ClientRect;\n\tboundingBoxRect: BoundingBoxRect;\n}\n\n/** Shallow-extends a stylesheet object with another stylesheet object. */\nfunction extendStyles(dest: CSSStyleDeclaration, source: CSSStyleDeclaration): CSSStyleDeclaration {\n\tfor (const key in source) {\n\t\tif (source.hasOwnProperty(key)) {\n\t\t\tdest[key] = source[key];\n\t\t}\n\t}\n\n\treturn dest;\n}\n\n/**\n * Gets whether an element is scrolled outside of view by any of its parent scrolling containers.\n * @param element Dimensions of the element (from getBoundingClientRect)\n * @param scrollContainers Dimensions of element's scrolling containers (from getBoundingClientRect)\n * @returns Whether the element is scrolled out of view\n * @docs-private\n */\nfunction isElementScrolledOutsideView(element: ClientRect, scrollContainers: ClientRect[]) {\n\treturn scrollContainers.some((containerBounds) => {\n\t\treturn element.bottom < containerBounds.top // Outside Above\n\t\t\t|| element.top > containerBounds.bottom // Outside Below\n\t\t\t|| element.right < containerBounds.left // Outside Left\n\t\t\t|| element.left > containerBounds.right; // Outside Right\n\t});\n}\n\n/**\n * Gets whether an element is clipped by any of its scrolling containers.\n * @param element Dimensions of the element (from getBoundingClientRect)\n * @param scrollContainers Dimensions of element's scrolling containers (from getBoundingClientRect)\n * @returns Whether the element is clipped\n * @docs-private\n */\nfunction isElementClippedByScrolling(element: ClientRect, scrollContainers: ClientRect[]) {\n\treturn scrollContainers.some((scrollContainerRect) => {\n\t\treturn element.top < scrollContainerRect.top // Clipped Above\n\t\t\t|| element.bottom > scrollContainerRect.bottom // Clipped Below\n\t\t\t|| element.left < scrollContainerRect.left // Clipped Left\n\t\t\t|| element.right > scrollContainerRect.right; // Clipped Right\n\t});\n}\n\n/** @docs-private */\nexport function GHOST_RIDER_POPOVER_POSITION_STRATEGY_FACTORY(\n\tviewportRuler: ViewportRuler,\n\tdocument: Document,\n\tplatform: Platform,\n\toverlayContainer: OverlayContainer,\n\trootPopoverContainer: GhostRiderRootPopoverContainer,\n): PopoverPositionStrategyFactory {\n\treturn (origin: PopoverPositionStrategyOrigin): PopoverPositionStrategy => {\n\t\treturn new PopoverPositionStrategy(\n\t\t\torigin,\n\t\t\tviewportRuler,\n\t\t\tdocument,\n\t\t\tplatform,\n\t\t\toverlayContainer,\n\t\t\trootPopoverContainer,\n\t\t);\n\t};\n}\n\n/** @docs-private */\nexport const GHOST_RIDER_POPOVER_POSITION_STRATEGY_FACTORY_PROVIDER: FactoryProvider = {\n\tprovide: GHOST_RIDER_POPOVER_POSITION_STRATEGY,\n\tuseFactory: GHOST_RIDER_POPOVER_POSITION_STRATEGY_FACTORY,\n\tdeps: [\n\t\tViewportRuler,\n\t\tDOCUMENT,\n\t\tPlatform,\n\t\tOverlayContainer,\n\t\tGhostRiderRootPopoverContainer,\n\t],\n};\n","/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n// Adapter from @angular/material \"MatTooltip\"\nimport {\n\tConstructorProvider,\n\tDirective,\n\tElementRef,\n\tInject,\n\tInjectionToken,\n\tNgZone,\n\tOnDestroy,\n\tOnInit,\n\tOptional,\n\tType,\n\tViewContainerRef,\n} from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { HAMMER_LOADER, HammerLoader } from '@angular/platform-browser';\nimport { AriaDescriber, FocusMonitor } from '@angular/cdk/a11y';\nimport { Directionality } from '@angular/cdk/bidi';\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\nimport { ESCAPE, hasModifierKey } from '@angular/cdk/keycodes';\nimport {\n\tConnectedPosition,\n\tHorizontalConnectionPos,\n\tOriginConnectionPosition,\n\tOverlay,\n\tOverlayConnectionPosition,\n\tOverlayRef,\n\tScrollStrategy,\n\tVerticalConnectionPos,\n} from '@angular/cdk/overlay';\nimport { Platform } from '@angular/cdk/platform';\nimport { ComponentPortal, TemplatePortal } from '@angular/cdk/portal';\nimport { ScrollDispatcher } from '@angular/cdk/scrolling';\n\nimport { Subject } from 'rxjs';\nimport { take, takeUntil } from 'rxjs/operators';\n\nimport { PopoverComponent } from '../components/popover.component';\n\nimport { GHOST_RIDER_POPOVER_SCROLL_STRATEGY } from '../tokens/popover-scroll-strategy.token';\nimport { GhostRiderPopoverContainer, GHOST_RIDER_POPOVER_CONTAINER } from '../tokens/popover-container.token';\nimport {\n\tPopoverPositionStrategy,\n\tPopoverPositionStrategyFactory,\n\tGHOST_RIDER_POPOVER_POSITION_STRATEGY,\n} from '../providers/popover-position-strategy.service';\n\nexport type PopoverPosition = 'left' | 'right' | 'above' | 'below' | 'before' | 'after';\nexport type PopoverNubbinPosition = 'start' | 'center' | 'end' | 'auto' | 'none';\n\n/** CSS class that will be attached to the overlay panel. */\nexport const POPOVER_PANEL_CLASS = 'ghost-rider-popover-container';\n\nexport type PopoverContent<T> = T extends string ? string : ComponentPortal<T> | TemplatePortal<T>;\n\n/**\n * Creates an error to be thrown if the user supplied an invalid popover position.\n * @docs-private\n */\nexport function getPopoverInvalidPositionError(position: string) {\n\treturn Error(`Popover position \"${position}\" is invalid.`);\n}\n\n/** Default `Popover` options that can be overridden. */\nexport interface PopoverDefaultOptions {\n\tshowDelay: number;\n\thideDelay: number;\n\ttouchendHideDelay: number;\n\tposition?: PopoverPosition;\n}\n\n/** Injection token to be used to override the default options for `Popover`. */\nexport const GHOST_RIDER_POPOVER_DEFAULT_OPTIONS = new InjectionToken<PopoverDefaultOptions>(\n\t'PopoverDefaultOptions',\n\t{ providedIn: 'root', factory: GHOST_RIDER_POPOVER_DEFAULT_OPTIONS_FACTORY },\n);\n\n/** @docs-private */\nexport function GHOST_RIDER_POPOVER_DEFAULT_OPTIONS_FACTORY(): PopoverDefaultOptions {\n\treturn {\n\t\tshowDelay: 0,\n\t\thideDelay: 0,\n\t\ttouchendHideDelay: 1500,\n\t};\n}\n\ninterface PopoverNubbinOffsets {\n\tperpendicular: number;\n\tparallel: number;\n}\n\n@Directive()\nexport class Popover<T = any> implements OnInit, OnDestroy {\n\tpublic _overlayRef: OverlayRef | null;\n\tprivate _popoverInstance: PopoverComponent | null;\n\n\tprotected _portal: ComponentPortal<PopoverComponent>;\n\tprotected _position: PopoverPosition = 'below';\n\tprotected _nubbinPosition: PopoverNubbinPosition = 'none';\n\tprotected _disabled: boolean = false;\n\tprotected _scrollStrategy: () => ScrollStrategy;\n\tprotected _positionStrategy: PopoverPositionStrategyFactory;\n\tpublic isTooltip: boolean;\n\tpublic popoverType: Type<PopoverComponent> = PopoverComponent;\n\n\tpublic get popoverInstance(): PopoverComponent | null { return this._popoverInstance; }\n\n\t/** Allows the user to define the position of the popover relative to the parent element */\n\tget position(): PopoverPosition { return this._position; }\n\tset position(value: PopoverPosition) {\n\t\tif (value !== this._position) {\n\t\t\tthis._position = value;\n\n\t\t\tif (this._overlayRef) {\n\t\t\t\tthis._updatePosition();\n\n\t\t\t\tif (this._popoverInstance) {\n\t\t\t\t\tthis._popoverInstance.show(0);\n\t\t\t\t}\n\n\t\t\t\tthis._overlayRef.updatePosition();\n\t\t\t}\n\t\t}\n\t}\n\n\t/** Allows the user to define the nubbin position of the popover relative to the parent element */\n\tget nubbinPosition(): PopoverNubbinPosition { return this._nubbinPosition; }\n\tset nubbinPosition(value: PopoverNubbinPosition) {\n\t\tif (value !== this._nubbinPosition) {\n\t\t\tthis._nubbinPosition = value;\n\n\t\t\tif (this._overlayRef) {\n\t\t\t\tthis._updatePosition();\n\n\t\t\t\tif (this._popoverInstance) {\n\t\t\t\t\tthis._popoverInstance.show(0);\n\t\t\t\t}\n\n\t\t\t\tthis._overlayRef.updatePosition();\n\t\t\t}\n\t\t}\n\t}\n\n\t/** Disables the display of the popover. */\n\tget disabled(): boolean { return this._disabled; }\n\tset disabled(value) {\n\t\tthis._disabled = coerceBooleanProperty(value);\n\n\t\t// If popover is disabled, hide immediately.\n\t\tif (this._disabled) {\n\t\t\tthis.hide(0);\n\t\t}\n\t}\n\n\t/** The default delay in ms before showing the popover after show is called */\n\tshowDelay = this._defaultOptions.showDelay;\n\n\t/** The default delay in ms before hiding the popover after hide is called */\n\thideDelay = this._defaultOptions.hideDelay;\n\n\tprotected _content!: PopoverContent<T>;\n\n\t/** The message to be displayed in the popover */\n\tget content(): PopoverContent<T> { return this._content; }\n\tset content(value: PopoverContent<T>) {\n\t\tif (typeof this._content === 'string') {\n\t\t\tthis._ariaDescriber.removeDescription(this._elementRef.nativeElement, this._content);\n\t\t}\n\n\t\tthis._content = value;\n\n\t\tif (!this._content && this.isPopoverVisible()) {\n\t\t\tthis.hide(0);\n\t\t} else {\n\t\t\tthis._updateContent();\n\t\t\tif (typeof this._content === 'string') {\n\t\t\t\tthis._ngZone.runOutsideAngular(() => {\n\t\t\t\t\t// The `AriaDescriber` has some functionality that avoids adding a description if it's the\n\t\t\t\t\t// same as the `aria-label` of an element, however we can't know whether the popover trigger\n\t\t\t\t\t// has a data-bound `aria-label` or when it'll be set for the first time. We can avoid the\n\t\t\t\t\t// issue by deferring the description by a tick so Angular has time to set the `aria-label`.\n\t\t\t\t\tPromise.resolve().then(() => {\n\t\t\t\t\t\tthis._ariaDescriber.describe(this._elementRef.nativeElement, this._content as string);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _manualListeners = new Map<string, EventListenerOrEventListenerObject>();\n\n\t/** Emits when the component is destroyed. */\n\tprotected readonly _destroyed = new Subject<void>();\n\n\tprotected _document: Document;\n\n\tconstructor(\n\t\tprotected _overlay: Overlay,\n\t\tprotected _elementRef: ElementRef<HTMLElement>,\n\t\tprotected _scrollDispatcher: ScrollDispatcher,\n\t\tprotected _viewContainerRef: ViewContainerRef,\n\t\tprotected _ngZone: NgZone,\n\t\tplatform: Platform,\n\t\tprotected _ariaDescriber: AriaDescriber,\n\t\tprotected _focusMonitor: FocusMonitor,\n\t\t@Inject(DOCUMENT) document: any,\n\t\t@Inject(GHOST_RIDER_POPOVER_SCROLL_STRATEGY) scrollStrategy: any,\n\t\t@Inject(GHOST_RIDER_POPOVER_POSITION_STRATEGY) positionStrategy: any,\n\t\t@Inject(GHOST_RIDER_POPOVER_CONTAINER) private _container: GhostRiderPopoverContainer,\n\t\t@Optional() protected _dir: Directionality,\n\t\t@Optional() @Inject(GHOST_RIDER_POPOVER_DEFAULT_OPTIONS)\n\t\tprotected _defaultOptions: PopoverDefaultOptions,\n\t\t@Optional() @Inject(HAMMER_LOADER) hammerLoader?: HammerLoader,\n\t) {\n\t\tthis._document = document;\n\t\tthis._scrollStrategy = scrollStrategy;\n\t\tthis._positionStrategy = positionStrategy;\n\t\tthis._bindEvents(platform, hammerLoader as HammerLoader);\n\n\t\tif (_defaultOptions && _defaultOptions.position) {\n\t\t\tthis.position = _defaultOptions.position;\n\t\t}\n\t}\n\n\t/**\n\t * Setup styling-specific things\n\t */\n\tngOnInit() {\n\t\tconst element = this._elementRef.nativeElement;\n\t\tconst elementStyle = element.style as CSSStyleDeclaration & { webkitUserDrag: string };\n\n\t\tif (element.nodeName === 'INPUT' || element.nodeName === 'TEXTAREA') {\n\t\t\t// When we bind a gesture event on an element (in this case `longpress`), HammerJS\n\t\t\t// will add some inline styles by default, including `user-select: none`. This is\n\t\t\t// problematic on iOS and in Safari, because it will prevent users from typing in inputs.\n\t\t\t// Since `user-select: none` is not needed for the `longpress` event and can cause unexpected\n\t\t\t// behavior for text fields, we always clear the `user-select` to avoid such issues.\n\n\t\t\t// elementStyle.webkitUserSelect = elementStyle.userSelect = elementStyle.msUserSelect = '';\n\t\t\telementStyle.webkitUserSelect = elementStyle.userSelect;\n\t\t}\n\n\t\t// Hammer applies `-webkit-user-drag: none` on all elements by default,\n\t\t// which breaks the native drag&drop. If the consumer explicitly made\n\t\t// the element draggable, clear the `-webkit-user-drag`.\n\t\tif (element.draggable && elementStyle.webkitUserDrag === 'none') {\n\t\t\telementStyle.webkitUserDrag = '';\n\t\t}\n\t}\n\n\t/**\n\t * Dispose the popover when destroyed.\n\t */\n\tngOnDestroy() {\n\t\tif (this._overlayRef) {\n\t\t\tthis._overlayRef.dispose();\n\t\t\tthis._popoverInstance = null;\n\t\t}\n\n\t\t// Clean up the event listeners set in the constructor\n\t\tthis._manualListeners.forEach((listener, event) => {\n\t\t\tthis._elementRef.nativeElement.removeEventListener(event, listener);\n\t\t});\n\t\tthis._manualListeners.clear();\n\n\t\tthis._destroyed.next();\n\t\tthis._destroyed.complete();\n\n\t\tif (typeof this.content === 'string') {\n\t\t\tthis._ariaDescriber.removeDescription(this._elementRef.nativeElement, this.content);\n\t\t}\n\t\tthis._focusMonitor.stopMonitoring(this._elementRef);\n\t}\n\n\t/** Shows the popover after the delay in ms, defaults to popover-delay-show or 0ms if no input */\n\tpublic show(delay: number = this.showDelay): void {\n\t\tif (this.disabled || !this.content || (this.isPopoverVisible() && !this._popoverInstance?.hasTimeout)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst overlayRef = this._createOverlay();\n\n\t\tthis._detach();\n\t\tthis._portal = this._portal || new ComponentPortal(this.popoverType, this._viewContainerRef);\n\t\tthis._popoverInstance = overlayRef.attach(this._portal).instance;\n\t\tthis._popoverInstance.isTooltip = this.isTooltip;\n\t\tthis._popoverInstance.afterHidden()\n\t\t\t.pipe(takeUntil(this._destroyed))\n\t\t\t.subscribe(() => this._detach());\n\t\tthis._updateContent();\n\t\tthis._popoverInstance.show(delay);\n\t}\n\n\t/** Hides the popover after the delay in ms, defaults to popover-delay-hide or 0ms if no input */\n\tpublic hide(delay: number = this.hideDelay): void {\n\t\tif (this._popoverInstance) {\n\t\t\tthis._popoverInstance.hide(delay);\n\t\t}\n\t}\n\n\t/** Shows/hides the popover */\n\tpublic toggle(): void {\n\t\tthis.isPopoverVisible() ? this.hide() : this.show();\n\t}\n\n\t/** Returns true if the popover is currently visible to the user */\n\tpublic isPopoverVisible(): boolean {\n\t\treturn !!this._popoverInstance && this._popoverInstance.isVisible();\n\t}\n\n\t/** Handles the keydown events on the host element. */\n\tpublic handleKeydown(e: KeyboardEvent) {\n\t\tif (this.isPopoverVisible() && e.keyCode === ESCAPE && !hasModifierKey(e)) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tthis.hide(0);\n\t\t}\n\t}\n\n\t/** Handles the touchend events on the host element. */\n\tpublic handleTouchend() {\n\t\tthis.hide(this._defaultOptions.touchendHideDelay);\n\t}\n\n\t/** Create the overlay config and position strategy */\n\tprotected _createOverlay(): OverlayRef {\n\t\tif (this._overlayRef) {\n\t\t\treturn this._overlayRef;\n\t\t}\n\n\t\tconst scrollableAncestors =\n\t\t\tthis._scrollDispatcher.getAncestorScrollContainers(this._elementRef);\n\n\t\t// Create connected position strategy that listens for scroll events to reposition.\n\t\tconst strategy = this._positionStrategy(this._elementRef)\n\t\t\t.withContainer(this._container)\n\t\t\t.withScrollableContainers(scrollableAncestors);\n\n\t\tstrategy.positionChanges.pipe(takeUntil(this._destroyed)).subscribe((change) => {\n\t\t\tif (this._popoverInstance) {\n\t\t\t\tif (change.scrollableViewProperties.isOverlayClipped && this._popoverInstance.isVisible()) {\n\t\t\t\t\t// After position changes occur and the overlay is clipped by\n\t\t\t\t\t// a parent scrollable then close the popover.\n\t\t\t\t\tthis._ngZone.run(() => this.hide(0));\n\t\t\t\t} else if (this._nubbinPosition !== 'none') {\n\t\t\t\t\t// TODO: Check tooltip position to see if nubbin exceeds bounds of origin (hide if so)\n\t\t\t\t\tif (change.connectionPair !== this._popoverInstance.position) {\n\t\t\t\t\t\tthis._ngZone.run(() => this._popoverInstance!.position = change.connectionPair);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst hasBackdrop: boolean = this.popoverType !== PopoverComponent;\n\n\t\tthis._overlayRef = this._overlay.create({\n\t\t\tdirection: this._dir,\n\t\t\tpositionStrategy: strategy,\n\t\t\tpanelClass: POPOVER_PANEL_CLASS,\n\t\t\tscrollStrategy: this._scrollStrategy(),\n\t\t\thasBackdrop,\n\t\t\tbackdropClass: ['ghost-rider-backdrop', 'ghost-rider-backdrop_open'],\n\t\t});\n\n\t\tthis._updatePosition();\n\n\t\tthis._overlayRef.detachments()\n\t\t\t.pipe(takeUntil(this._destroyed))\n\t\t\t.subscribe(() => this._detach());\n\n\t\treturn this._overlayRef;\n\t}\n\n\t/** Detaches the currently-attached popover. */\n\tprotected _detach() {\n\t\tif (this._overlayRef && this._overlayRef.hasAttached()) {\n\t\t\tthis._overlayRef.detach();\n\t\t}\n\n\t\tthis._popoverInstance = null;\n\t}\n\n\t/** Updates the position of the current popover. */\n\tprotected _updatePosition() {\n\t\tlet nubbinOffsets: PopoverNubbinOffsets;\n\n\t\tif (this._nubbinPosition === 'none') {\n\t\t\tnubbinOffsets = { perpendicular: 0, parallel: 0 };\n\t\t} else {\n\t\t\tconst REM: number = parseFloat(getComputedStyle(this._document.documentElement).fontSize);\n\t\t\tnubbinOffsets = { perpendicular: REM * 0.875, parallel: REM * 1.5 };\n\t\t}\n\n\t\tconst positions: ConnectedPosition[] = buildConnectedPositions(\n\t\t\tthis._getOrigin(),\n\t\t\tthis._getOverlayPosition(),\n\t\t\tthis._nubbinPosition,\n\t\t\tnubbinOffsets,\n\t\t);\n\n\t\t(this._overlayRef!.getConfig().positionStrategy as PopoverPositionStrategy).withPositions(positions);\n\t}\n\n\t/** Forces tooltip position to be recalculated. Necessary for manually triggered tooltip instances */\n\tpublic updateOverlayPosition(): void {\n\t\tif (this._overlayRef) {\n\t\t\tthis._overlayRef.updatePosition();\n\t\t}\n\t}\n\n\t/**\n\t * Returns the origin position and a fallback position based on the user's position preference.\n\t * The fallback position is the inverse of the origin (e.g. `'below' -> 'above'`).\n\t */\n\tprotected _getOrigin(): ConnectionPositions<OriginConnectionPosition> {\n\t\tconst isLtr = !this._dir || this._dir.value === 'ltr';\n\t\tconst position = this.position;\n\t\tlet originPosition: OriginConnectionPosition;\n\n\t\tif (position === 'above' || position === 'below') {\n\t\t\toriginPosition = { originX: 'center', originY: position === 'above' ? 'top' : 'bottom' };\n\t\t} else if (\n\t\t\tposition === 'before' ||\n\t\t\t(position === 'left' && isLtr) ||\n\t\t\t(position === 'right' && !isLtr)) {\n\t\t\toriginPosition = { originX: 'start', originY: 'center' };\n\t\t} else if (\n\t\t\tposition === 'after' ||\n\t\t\t(position === 'right' && isLtr) ||\n\t\t\t(position === 'left' && !isLtr)) {\n\t\t\toriginPosition = { originX: 'end', originY: 'center' };\n\t\t} else {\n\t\t\tthrow getPopoverInvalidPositionError(position);\n\t\t}\n\n\t\tconst { x, y } = this._invertPosition(originPosition.originX, originPosition.originY);\n\n\t\treturn {\n\t\t\tmain: originPosition,\n\t\t\tfallback: { originX: x, originY: y },\n\t\t};\n\t}\n\n\t/** Returns the overlay position and a fallback position based on the user's preference */\n\tprotected _getOverlayPosition(): ConnectionPositions<OverlayConnectionPosition> {\n\t\tconst isLtr = !this._dir || this._dir.value === 'ltr';\n\t\tconst position = this.position;\n\t\tlet overlayPosition: OverlayConnectionPosition;\n\n\t\tif (position === 'above') {\n\t\t\toverlayPosition = { overlayX: 'center', overlayY: 'bottom' };\n\t\t} else if (position === 'below') {\n\t\t\toverlayPosition = { overlayX: 'center', overlayY: 'top' };\n\t\t} else if (\n\t\t\tposition === 'before' ||\n\t\t\t(position === 'left' && isLtr) ||\n\t\t\t(position === 'right' && !isLtr)) {\n\t\t\toverlayPosition = { overlayX: 'end', overlayY: 'center' };\n\t\t} else if (\n\t\t\tposition === 'after' ||\n\t\t\t(position === 'right' && isLtr) ||\n\t\t\t(position === 'left' && !isLtr)) {\n\t\t\toverlayPosition = { overlayX: 'start', overlayY: 'center' };\n\t\t} else {\n\t\t\tthrow getPopoverInvalidPositionError(position);\n\t\t}\n\n\t\tconst { x, y } = this._invertPosition(overlayPosition.overlayX, overlayPosition.overlayY);\n\n\t\treturn {\n\t\t\tmain: overlayPosition,\n\t\t\tfallback: { overlayX: x, overlayY: y },\n\t\t};\n\t}\n\n\t/** Updates the popover message and repositions the overlay according to the new message length */\n\tprotected _updateContent() {\n\t\t// Must wait for the message to be painted to the popover so that the overlay can properly\n\t\t// calculate the correct positioning based on the size of the text.\n\t\tif (this._popoverInstance) {\n\t\t\tthis._popoverInstance.content = this.content;\n\t\t\tthis._popoverInstance.markForCheck();\n\n\t\t\tthis._ngZone.onMicrotaskEmpty.asObservable().pipe(\n\t\t\t\ttake(1),\n\t\t\t\ttakeUntil(this._destroyed),\n\t\t\t).subscribe(() => {\n\t\t\t\tif (this._popoverInstance) {\n\t\t\t\t\tthis._overlayRef!.updatePosition();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/** Inverts an overlay position. */\n\tprivate _invertPosition(x: HorizontalConnectionPos, y: VerticalConnectionPos) {\n\t\tif (this.position === 'above' || this.position === 'below') {\n\t\t\tif (y === 'top') {\n\t\t\t\ty = 'bottom';\n\t\t\t} else if (y === 'bottom') {\n\t\t\t\ty = 'top';\n\t\t\t}\n\t\t} else {\n\t\t\tif (x === 'end') {\n\t\t\t\tx = 'start';\n\t\t\t} else if (x === 'start') {\n\t\t\t\tx = 'end';\n\t\t\t}\n\t\t}\n\n\t\treturn { x, y };\n\t}\n\n\t// tslint:disable-next-line:no-empty\n\tprotected _bindEvents(platform: Platform, hammerLoader: HammerLoader): void { }\n}\n\n// Can this be retrieved from compiled code???\nexport const GHOST_RIDER_POPOVER_STATIC_PROVIDER: ConstructorProvider = {\n\tprovide: Popover,\n\tdeps: [\n\t\tOverlay,\n\t\tElementRef,\n\t\tScrollDispatcher,\n\t\tViewContainerRef,\n\t\tNgZone,\n\t\tPlatform,\n\t\tAriaDescriber,\n\t\tFocusMonitor,\n\t\tDOCUMENT,\n\t\tGHOST_RIDER_POPOVER_SCROLL_STRATEGY,\n\t\tGHOST_RIDER_POPOVER_POSITION_STRATEGY,\n\t\tGHOST_RIDER_POPOVER_CONTAINER,\n\t\t[new Optional(), Directionality],\n\t\t[new Optional(), GHOST_RIDER_POPOVER_DEFAULT_OPTIONS],\n\t\t[new Optional(), HAMMER_LOADER],\n\t],\n};\n\nexport interface ConnectionPositions<T extends OverlayConnectionPosition | OriginConnectionPosition> {\n\tmain: T;\n\tfallback: T;\n}\n\nfunction buildConnectedPositions(\n\torigin: ConnectionPositions<OriginConnectionPosition>,\n\toverlay: ConnectionPositions<OverlayConnectionPosition>,\n\tnubbinPosition: PopoverNubbinPosition,\n\toffsets: PopoverNubbinOffsets,\n): ConnectedPosition[] {\n\tconst main: ConnectedPosition = { ...origin.main, ...overlay.main };\n\tconst fallback: ConnectedPosition = { ...origin.fallback, ...overlay.fallback };\n\n\tconst positions: ConnectedPosition[] = [\n\t\t...buildPositionsForNubbin(main, nubbinPosition),\n\t\t...buildPositionsForNubbin(fallback, nubbinPosition),\n\t];\n\n\t// Add offsets for each position so that tooltip nubbin is pointing towards origin point\n\tpositions.forEach((position) => {\n\t\tif (position.originY !== 'center') { // Top/Bottom\n\t\t\tposition.offsetY = offsets.perpendicular * POPOVER_NUBBIN_OFFSET_MULTIPLIERS[position.originY];\n\n\t\t\tif (position.overlayX !== 'center') {\n\t\t\t\tposition.offsetX = offsets.parallel * POPOVER_NUBBIN_OFFSET_MULTIPLIERS[position.overlayX];\n\t\t\t}\n\t\t} else if (position.originX !== 'center') { // Left/Right\n\t\t\tposition.offsetX = offsets.perpendicular * POPOVER_NUBBIN_OFFSET_MULTIPLIERS[position.originX];\n\n\t\t\tif (position.overlayY !== 'center') {\n\t\t\t\tposition.offsetY = offsets.parallel * POPOVER_NUBBIN_OFFSET_MULTIPLIERS[position.overlayY];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn positions;\n}\n\nconst POPOVER_NUBBIN_OFFSET_MULTIPLIERS = {\n\ttop: -1,\n\tbottom: 1,\n\tstart: -1,\n\tend: 1,\n};\n\n// Builds additional positions for \"start\"/\"end\" nubbins\n// I.E. bottom -> [ bottom-left, bottom-right ]\nfunction buildPositionsForNubbin(\n\tposition: ConnectedPosition,\n\tnubbinPosition: PopoverNubbinPosition,\n): ConnectedPosition[] {\n\tif (nubbinPosition === 'none') {\n\t\treturn [position];\n\t}\n\tif (position.originX === 'center') { // Top/Bottom\n\t\tif (nubbinPosition === 'auto') {\n\t\t\treturn [\n\t\t\t\tposition,\n\t\t\t\t{ ...position, overlayX: 'start' },\n\t\t\t\t{ ...position, overlayX: 'end' },\n\t\t\t];\n\t\t} else {\n\t\t\treturn [\n\t\t\t\t{ ...position, overlayX: nubbinPosition },\n\t\t\t];\n\t\t}\n\t} else { // Left/Right\n\t\tif (nubbinPosition === 'auto') {\n\t\t\treturn [\n\t\t\t\tposition,\n\t\t\t\t{ ...position, overlayY: 'bottom' },\n\t\t\t\t{ ...position, overlayY: 'top' },\n\t\t\t];\n\t\t} else {\n\t\t\treturn [\n\t\t\t\t{ ...position, overlayY: nubbinPosition === 'start' ? 'top' : 'bottom' },\n\t\t\t];\n\t\t}\n\t}\n}\n","import { ElementRef, Injectable, Injector, StaticProvider, ViewContainerRef } from '@angular/core';\nimport { Popover, GHOST_RIDER_POPOVER_STATIC_PROVIDER } from '../models/ghost-rider-popover.model';\n\nexport interface GhostRiderPopoverConfig {\n\tvcr: ViewContainerRef;\n}\n\n@Injectable()\nexport class GhostRiderPopoverFactory {\n\tconstructor(\n\t\tprivate readonly _injector: Injector,\n\t) { }\n\n\tpublic createPopover<T = any>(\n\t\telementRef: ElementRef,\n\t\tconfig?: GhostRiderPopoverConfig,\n\t): Popover<T> {\n\t\tconst providers: StaticProvider[] = [\n\t\t\tGHOST_RIDER_POPOVER_STATIC_PROVIDER,\n\t\t\t{ provide: ElementRef, useValue: elementRef },\n\t\t];\n\n\t\tif (config) {\n\t\t\tif (config.vcr) {\n\t\t\t\tproviders.push({ provide: ViewContainerRef, useValue: config.vcr });\n\t\t\t}\n\t\t}\n\n\t\tconst instance: Popover<T> = Injector.create({\n\t\t\tproviders,\n\t\t\tparent: this._injector,\n\t\t}).get(Popover) as Popover<T>;\n\n\t\t// Not attached to, must manually run\n\t\tinstance.ngOnInit();\n\n\t\treturn instance;\n\t}\n}","import { GhostRiderStep } from '../models/ghost-rider-step.model';\n\nexport class GhostRiderTourGuide {\n\tpublic activeStep: GhostRiderStep;\n\tpublic currentStep: number = 0;\n\n\tconstructor(\n\t\tpublic readonly tourNamespace: string,\n\t\tpublic readonly steps: GhostRiderStep[],\n\t) {\n\t\tthis.steps.forEach((step) => {\n\t\t\t// Add the tour namespace to every step\n\t\t\tstep.name = this.tourNamespace + step.name;\n\n\t\t\tif (step.hasSubSteps) {\n\t\t\t\tstep.subSteps.forEach((subStep) => {\n\t\t\t\t\t// Add the tour namespace to every sub step\n\t\t\t\t\tsubStep.name = this.tourNamespace + subStep.name;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.activeStep = this.steps[0];\n\t}\n\n\t/**\n\t * Sets the active step to the next 'Parent' step that is visible\n\t */\n\tpublic getNextStep(): GhostRiderStep {\n\t\tconst startingStep: GhostRiderStep = this.activeStep;\n\t\tdo {\n\t\t\tif (this.steps[this.currentStep + 1]) {\n\t\t\t\tthis.currentStep++;\n\t\t\t\tthis.activeStep = this.steps[this.currentStep];\n\t\t\t} else {\n\t\t\t\treturn startingStep;\n\t\t\t}\n\t\t} while (this.activeStep.hidden);\n\n\t\treturn this.activeStep;\n\n\t\t// do {\n\t\t// \tthis.currentStep++;\n\t\t// \tthis.activeStep = this.steps[this.currentStep];\n\t\t// } while (this.activeStep.hidden);\n\n\t\t// return this.activeStep;\n\t}\n\n\t/**\n\t * Sets the active step to the next sub step in the order\n\t */\n\tpublic getNextSubStep(): GhostRiderStep {\n\t\tif (this.activeStep.hasSubSteps) {\n\t\t\tthis.activeStep = this.activeStep.subSteps[0];\n\t\t} else if (this.activeStep.parent) {\n\t\t\tconst siblings = this.activeStep.parent.subSteps;\n\t\t\tthis.activeStep = siblings[siblings.indexOf(this.activeStep) + 1];\n\t\t}\n\t\treturn this.activeStep;\n\t}\n\n\t/**\n\t * Sets the active step to the previous 'Parent' step that is visible\n\t */\n\tpublic getPreviousStep(): GhostRiderStep {\n\t\tconst startingStep: GhostRiderStep = this.activeStep;\n\t\tdo {\n\t\t\tif (this.steps[this.currentStep - 1]) {\n\t\t\t\tthis.currentStep--;\n\t\t\t\tthis.activeStep = this.steps[this.currentStep];\n\t\t\t} else {\n\t\t\t\treturn startingStep;\n\t\t\t}\n\t\t} while (this.activeStep.hidden);\n\n\t\treturn this.activeStep;\n\n\t\t// do {\n\t\t// \tthis.currentStep--;\n\t\t// \tthis.activeStep = this.steps[this.currentStep];\n\t\t// } while (this.activeStep.hidden);\n\n\t\t// return this.activeStep;\n\t}\n\n\t/**\n\t * Sets the active step to the previous sub step that is visible\n\t */\n\tpublic getPreviousSubStep(): GhostRiderStep {\n\t\tconst siblings = this.activeStep.parent!.subSteps;\n\t\tconst previous = siblings.indexOf(this.activeStep) - 1;\n\t\tif (siblings[previous]) {\n\t\t\tthis.activeStep = siblings[previous];\n\t\t} else if (this.activeStep.parent) {\n\t\t\tthis.activeStep = this.activeStep.parent;\n\t\t}\n\t\treturn this.activeStep;\n\t}\n}\n","import { Injectable, Injector, OnDestroy, Renderer2, RendererFactory2 } from '@angular/core';\nimport { BehaviorSubject, defer, Observable, of, Subject, Subscription } from 'rxjs';\nimport { first, last, startWith } from 'rxjs/operators';\nimport { Popover } from '../models/ghost-rider-popover.model';\nimport { GhostRiderPopoverFactory } from './ghost-rider-popover-factory.service';\nimport { GhostRiderStepComponent } from '../components/ghost-rider-step.component';\nimport { GhostRiderTourGuide } from '../helpers/ghost-rider-tour-guide';\nimport { GhostRiderEvent, GhostRiderEventSource, GhostRiderEventType } from '../models/ghost-rider-step-event.model';\nimport { GhostRiderStepDetails } from '../models/ghost-rider-step-details.model';\nimport { GhostRiderStep } from '../models/ghost-rider-step.model';\nimport { OverlayRef } from '@angular/cdk/overlay';\n\n/**\n * Used for the '_subs' map prop keys\n */\nenum SubKeys {\n  StepAdded = 'stepAdded',\n  Events = 'events'\n}\n\nconst ACTIVE_TARGET_CLASS: string = `ghost-rider-walkthrough-step_active`;\n\n/**\n * Service to control guided tours and walkthrough steps\n */\n@Injectable({ providedIn: 'root' })\nexport class GhostRiderService implements OnDestroy {\n  private readonly _stepAdded$ = new Subject<string>();\n  // Add keys to the 'SubKeys' enum pleez\n  private readonly _subs = new Map<SubKeys, Subscription>();\n  private readonly _steps = new Map<string, GhostRiderStepDetails>(); // name => step\n  private readonly _popoverFactory: GhostRiderPopoverFactory;\n  private readonly _renderer: Renderer2;\n\n  private _tourGuide: GhostRiderTourGuide;\n  private _activePopover: Popover;\n  // TODO: Implement an optional UI masking element to override clicks from the user\n  // private _uiMask: HTMLDivElement | null;\n\n  private _isAsync: boolean = false; // Flag to use asynchronous or synchronous methods\n\n  private _hideStep: () => Observable<void>;\n  private _removeWindowHandler: () => void;\n\n  // Flag that the tour is in flight. Once the tour is closed or skipped, this will be false\n  public readonly activeTour$ = new BehaviorSubject(false);\n\n  public events$ = new Subject<GhostRiderEvent>();\n\n  public get activeTour(): boolean {\n    return this.activeTour$.value;\n  }\n\n  public get tourGuide(): GhostRiderTourGuide {\n    return this._tourGuide;\n  }\n\n  constructor(\n    private readonly _injector: Injector,\n    rendererFactory: RendererFactory2,\n  ) {\n    this._popoverFactory = new GhostRiderPopoverFactory(this._injector);\n    this._renderer = rendererFactory.createRenderer(null, null);\n\n    /**\n     * When there are step events, emit the event from the step's 'GhostRiderStepEvent'\n     * output so we can react to event from specific components\n     */\n    this._subs.set(\n      SubKeys.Events,\n      this.events$.subscribe((event) => {\n        if (this._steps.has(event.name)) {\n          this._steps.get(event.name)?.ghostRiderStepEvent.emit(event);\n        }\n      }),\n    );\n  }\n\n  ngOnDestroy(): void {\n    this._stepAdded$.complete();\n    this._stepAdded$.unsubscribe();\n\n    this.activeTour$.complete();\n    this.activeTour$.unsubscribe();\n\n    this.events$.complete();\n    this.events$.unsubscribe();\n\n    this._subs.forEach((sub) => sub.unsubscribe());\n  }\n\n  /**\n   * Adds a new step to the tour\n   * @param step The step to add to the tour\n   */\n  public registerStep(step: GhostRiderStepDetails): void {\n    if (!this._steps.has(step.config.name)) {\n      this._steps.set(step.config.name, step);\n    }\n    this._stepAdded$.next(step.config.name);\n  }\n\n  /**\n   * Removes the step from the '_steps' map\n   * @param step The step to remove from the map\n   */\n  public unregisterStep(step: GhostRiderStepDetails): void {\n    if (this._steps.has(step.config.name) && this._steps.get(step.config.name) === step) {\n      this._steps.delete(step.config.name);\n    }\n  }\n\n  /**\n   * Starts the tour at from the first step\n   * @param tourNamespace String to distinguish different tour contexts (becomes a prefix to all steps)\n   * @param steps List of tour steps in the order in which they should go\n   */\n  public start(tourNamespace: string, steps: GhostRiderStep[]): void {\n    tourNamespace = tourNamespace ? tourNamespace + '.' : '';\n    this.activeTour$.next(true);\n    this.events$.next({\n      type: GhostRiderEventType.Start,\n      name: tourNamespace,\n      source: GhostRiderEventSource.Manual,\n    });\n    this._tourGuide = new GhostRiderTourGuide(tourNamespace, steps);\n    this._goToStep();\n  }\n\n  /**\n   * Pauses the tour on the active step\n   */\n  public pause(): void {\n    if (this.activeTour) {\n      this.hideStep();\n    }\n  }\n\n  /**\n   * Resumes the tour from the active step\n   */\n  public resume(): void {\n    if (this.activeTour) {\n      this._goToStep();\n    }\n  }\n\n  /**\n   * Goes to a parent step from any sub step\n   * @param source The source value that caused this to be called\n   */\n  public goToParent(source: GhostRiderEventSource = GhostRiderEventSource.Manual): void {\n    if (this.activeTour) {\n      const { name } = this._tourGuide.activeStep;\n      this.tourGuide.activeStep = this.tourGuide.activeStep.parent as GhostRiderStep;\n      this._goToStep({ type: null, name, source }, true);\n    }\n  }\n\n  /**\n   * Goes to the next step\n   * @param source The source value that caused this to be called\n   */\n  public next(source: GhostRiderEventSource = GhostRiderEventSource.Manual): void {\n    if (this.activeTour) {\n      const { name } = this._tourGuide.activeStep;\n      this._tourGuide.getNextStep();\n      this._goToStep({ type: GhostRiderEventType.Next, name, source });\n    }\n  }\n\n  /**\n   * Goes to the previous step\n   * @param source The source value that caused this to be called\n   */\n  public back(source: GhostRiderEventSource = GhostRiderEventSource.Manual): void {\n    if (this.activeTour) {\n      const { name } = this._tourGuide.activeStep;\n      this._tourGuide.getPreviousStep();\n      this._goToStep({ type: GhostRiderEventType.Back, name, source });\n    }\n  }\n\n  /**\n   * Goes to the next sub step\n   * @param source The source value that caused this to be called\n   */\n  public nextSubStep(source: GhostRiderEventSource = GhostRiderEventSource.Manual): void {\n    if (this.activeTour) {\n      const { name } = this._tourGuide.activeStep;\n      this._tourGuide.getNextSubStep();\n      this._goToStep({ type: null, name, source });\n    }\n  }\n\n  /**\n   * Goes to the previous sub step\n   * @param source The source value that caused this to be called\n   */\n  public previousSubStep(source: GhostRiderEventSource = GhostRiderEventSource.Manual): void {\n    if (this.activeTour) {\n      const { name } = this._tourGuide.activeStep;\n      this._tourGuide.getPreviousSubStep();\n      this._goToStep({ type: null, name, source }, true);\n    }\n  }\n\n  /**\n   * Closes the tour, but with a more descriptive event\n   * @param source The source value that caused this to be called\n   */\n  public complete(source: GhostRiderEventSource = GhostRiderEventSource.Manual): void {\n    this.close(source, GhostRiderEventType.Complete);\n  }\n\n  /**\n   * Ends the tour\n   * @param source The source value that caused this to be called\n   * @param type The event type to use for the emitted event\n   */\n  public close(\n    source: GhostRiderEventSource = GhostRiderEventSource.Manual,\n    type: GhostRiderEventType = GhostRiderEventType.Close,\n  ): void {\n    this.activeTour$.next(false);\n\n    const { name } = this._tourGuide.activeStep;\n    // Immediately remove the backdrop and clip path elements\n    this._removeWindowHandler();\n    // Dispose of the step and cleanup\n    const hideStepSub = this.hideStep().subscribe(() => {\n      this.events$.next({ type, name, source });\n      hideStepSub.unsubscribe();\n    });\n    this._tourGuide = undefined as unknown as GhostRiderTourGuide;\n  }\n\n  /**\n   * Calls the dynamic '_hideStep' prop function to remove a popover step from the UI\n   */\n  public hideStep(): Observable<void> {\n    if (this._hideStep) {\n      return this._hideStep();\n    } else {\n      return of(void 0);\n    }\n  }\n\n  /**\n   * Repositions the window and the popover manually\n   */\n  public tidy(): void {\n    this.updatePosition();\n    this.updateWindow();\n  }\n\n  /**\n   * Updates the active popover's overlay position\n   */\n  public updatePosition(): void {\n    if (this._activePopover) {\n      this._activePopover.updateOverlayPosition();\n    }\n  }\n\n  /**\n   * Updates the positions of the clip paths for the target element\n   */\n  public updateWindow(): void {\n    if (this._activePopover && this._activePopover?._overlayRef?.backdropElement) {\n      this._buildWindow(\n        this._steps.get(this._tourGuide.activeStep.name)!.element.nativeElement.getBoundingClientRect(),\n        this._activePopover._overlayRef,\n      );\n    }\n  }\n\n  /**\n   * Removes backdrop and clip path divs for the active step\n   */\n  public removeWindow(): void {\n    if (this._removeWindowHandler) {\n      this._removeWindowHandler();\n    }\n  }\n\n  /**\n   * Finds the step to show if it exists or when it is dynamically registered from the subject\n   * @param event Optional event object to emit\n   */\n  private _goToStep(event?: GhostRiderEvent, asyncOverride?: boolean): void {\n    if (this._tourGuide.activeStep) {\n      this.hideStep().subscribe(() => {\n\n        if (event) {\n          this.events$.next(event);\n        }\n\n        if (this._subs.has(SubKeys.StepAdded)) {\n          const stepAdded = this._subs.get(SubKeys.StepAdded);\n          if (stepAdded) {\n            stepAdded.unsubscribe();\n            this._subs.delete(SubKeys.StepAdded);\n          }\n        }\n\n        const hasStep = this._steps.has(this._tourGuide.activeStep.name);\n\n        if (asyncOverride !== undefined) {\n          this._isAsync = asyncOverride;\n        } else {\n          this._isAsync = !hasStep;\n        }\n\n        if (hasStep) {\n          this._showStep();\n        } else {\n          this._subs.set(\n            SubKeys.StepAdded,\n            this._stepAdded$.pipe(\n              first((step) => step === this._tourGuide.activeStep.name),\n            ).subscribe(() => {\n              this._showStep();\n            }),\n          );\n        }\n      });\n    } else {\n      // There isn't a next step so just end the tour\n      this.close();\n    }\n  }\n\n  /**\n   * Destroys the active popover and creates the new popover for the desired step\n   */\n  private _showStep(): void {\n    const { element, vcr, config, active$ } = this._steps.get(this._tourGuide.activeStep.name) as GhostRiderStepDetails;\n    const popover = this._activePopover = this._popoverFactory.createPopover(element, { vcr });\n\n    // Assign a tear down function for the active step\n    this._hideStep = (): Observable<void> => {\n      popover.hide();\n      active$.next(false);\n      // this._removeMask();\n      this._renderer.removeClass(\n        element.nativeElement,\n        ACTIVE_TARGET_CLASS\n      );\n\n      if (this._activePopover === popover) {\n        this._activePopover = null as unknown as Popover<any>;\n      }\n      this._hideStep = null as unknown as () => Observable<void>;\n\n      return defer(() => {\n        return popover.popoverInstance!.afterHidden().pipe(\n          startWith(null as any),\n          last(),\n        );\n      });\n    };\n\n    // Custom class that we can use too style the target element\n    this._renderer.addClass(\n      element.nativeElement,\n      ACTIVE_TARGET_CLASS\n    );\n\n    popover.position = config.position;\n    popover.nubbinPosition = config.nubbinPosition;\n    popover.content = config.content;\n    popover.popoverType = GhostRiderStepComponent;\n\n    if (config.beforeActivate) {\n      config.beforeActivate();\n    }\n\n    // Remove old backdrop and clip paths\n    this.removeWindow();\n    // TODO: rethink some of this logic and design\n    if (this._tourGuide.activeStep.parent) {\n      this._isAsync = true;\n    }\n    // Show new popover step\n    popover.show(0);\n    // Set props on step component\n    (popover.popoverInstance as GhostRiderStepComponent).details = config;\n    // Assign new backdrop and clip path destroyer\n    this._removeWindowHandler = () => {\n      this._removeWindow(popover._overlayRef?.backdropElement as HTMLElement);\n    };\n\n    if (this._isAsync) {\n      // Wait for popover component to be visible before adding styles\n      const afterVisibleSub = popover.popoverInstance?.afterVisible().subscribe(() => {\n        this._buildWindow(element.nativeElement.getBoundingClientRect(), popover._overlayRef as OverlayRef);\n        active$.next(true);\n        afterVisibleSub?.unsubscribe();\n      });\n    } else {\n      // Since this isn't async, we can just build the new backdrop and set styles ASAP\n      this._buildWindow(element.nativeElement.getBoundingClientRect(), popover._overlayRef as OverlayRef);\n    }\n  }\n\n  /**\n   * Creates the clip path in the backdrop and an inner inset clip path to round the edges\n   *\n   * TODO: fix the slight edges that are showing between the inner and outter clip paths\n   * @param rect The rectangle dimensions to clip\n   * @param overlayRef The overlay element\n   */\n  private _buildWindow(rect: DOMRect, overlayRef: OverlayRef): void {\n    // if (this._tourGuide.activeStep.preventClicks && !this._uiMask) {\n    //   // Make div to prevent actions\n    //   this._uiMask = this._renderer.createElement('div');\n    //   this._renderer.setStyle(this._uiMask, 'position', 'fixed');\n    //   this._renderer.setStyle(this._uiMask, 'height', '100%');\n    //   this._renderer.setStyle(this._uiMask, 'width', '100%');\n    //   this._renderer.setStyle(this._uiMask, 'background-color', 'transparent');\n    //   this._renderer.setStyle(this._uiMask, 'zIndex', '8999');\n    //   this._renderer.setStyle(this._uiMask, 'pointerEvents', 'all');\n    //   this._renderer.insertBefore(overlayRef.backdropElement.parentElement, this._uiMask, overlayRef.backdropElement);\n    // }\n\n    this._renderer.setStyle(overlayRef.backdropElement?.nextSibling, 'zIndex', 9001);\n    this._renderer.setStyle( // Should we remove this style on tear down?\n      overlayRef.backdropElement,\n      'clipPath',\n      `polygon(\n          0% 0%,\n          0% 100%,\n          ${rect.left}px 100%,\n          ${rect.left}px ${rect.top}px,\n          ${rect.right}px ${rect.top}px,\n          ${rect.right}px ${rect.bottom}px,\n          ${rect.left}px ${rect.bottom}px,\n          ${rect.left}px 100%,\n          100% 100%,\n          100% 0%\n        )`,\n    );\n\n    if (!overlayRef.backdropElement?.firstChild) {\n      this._renderer.appendChild(overlayRef.backdropElement, this._renderer.createElement('div'));\n    }\n\n    const buffer = 5;\n    const borderRadius = buffer;\n    const distributionSize = buffer / 2;\n\n    if (overlayRef.backdropElement?.firstChild) {\n      this._renderer.setStyle(overlayRef.backdropElement.firstChild, 'position', 'absolute');\n      this._renderer.setStyle(overlayRef.backdropElement.firstChild, 'background', 'white');\n      this._renderer.setStyle(overlayRef.backdropElement.firstChild, 'width', `${rect.width + buffer}px`);\n      this._renderer.setStyle(overlayRef.backdropElement.firstChild, 'height', `${rect.height + buffer}px`);\n      this._renderer.setStyle(overlayRef.backdropElement.firstChild, 'clipPath', `inset(0 round ${borderRadius}px)`);\n      this._renderer.setStyle(overlayRef.backdropElement.firstChild, 'inset', `${rect.y - distributionSize}px 0 0 ${rect.x - distributionSize}px`);\n    }\n  }\n\n  /**\n   * Removes the custom backdrop styles and inset clip path div\n   * @param backdrop The backdrop overlay element\n   */\n  private _removeWindow(backdrop: HTMLElement): void {\n    if (backdrop) {\n      this._renderer.removeClass(backdrop, 'ghost-rider-backdrop');\n      if (backdrop.firstChild) {\n        this._renderer.removeChild(backdrop, backdrop.firstChild);\n      }\n    }\n\n    // this._removeMask();\n  }\n\n  // /**\n  //  * Removes the masking div to prevent clicks\n  //  */\n  // private _removeMask(): void {\n  //   if (this._uiMask) {\n  //     this._uiMask.remove();\n  //     this._uiMask = null;\n  //   }\n  // }\n}\n","import { Directive, EventEmitter, HostListener, Output } from '@angular/core';\nimport { GhostRiderService } from '../providers/ghost-rider.service';\nimport { GhostRiderEventSource } from '../models/ghost-rider-step-event.model';\n\n@Directive({ selector: '[ghostRiderStepAdvance]' })\nexport class GhostRiderStepAdvanceDirective {\n  @Output()\n  public ghostRiderStepAdvance: EventEmitter<MouseEvent> = new EventEmitter();\n\n  constructor(\n    private readonly _ghostRiderService: GhostRiderService,\n  ) { }\n\n  @HostListener('click', ['$event'])\n  public advance(event: MouseEvent): void {\n    this.ghostRiderStepAdvance.emit(event);\n    this._ghostRiderService.next(GhostRiderEventSource.Directive);\n  }\n}\n","import { PopoverContent, PopoverNubbinPosition, PopoverPosition } from './ghost-rider-popover.model';\n\nexport class GhostRiderStepConfig<T = any> {\n  public name: string;\n  public title: string;\n  public backButtonLabel: string = 'Back';\n  public nextButtonLabel: string = 'Next';\n\n  public shouldRegister: boolean = true;\n  public backIsDisabled: boolean = false;\n  public nextIsDisabled: boolean = false;\n  public nextIsHide: boolean = false;\n\n  public position: PopoverPosition = 'below';\n  public nubbinPosition: PopoverNubbinPosition = 'auto';\n  public content: PopoverContent<T>;\n\n  /**\n   * Function to run before the popover is shown. 'popover.show(0)'\n   */\n  beforeActivate?: () => unknown;\n}","import { Directive, ElementRef, EventEmitter, Input, OnDestroy, OnInit, Output, ViewContainerRef } from '@angular/core';\nimport { GhostRiderService } from '../providers/ghost-rider.service';\nimport { GhostRiderStepConfig } from '../models/ghost-rider-step-config.model';\nimport { GhostRiderStepDetails } from '../models/ghost-rider-step-details.model';\nimport { GhostRiderEvent } from '../models/ghost-rider-step-event.model';\nimport { BehaviorSubject, Subscription } from 'rxjs';\n\n@Directive({ selector: '[ghostRiderStep]' })\nexport class GhostRiderStepDirective<T = any> implements GhostRiderStepDetails, OnInit, OnDestroy {\n  @Input() // Might want to remove the 'Partial'\n  public set ghostRiderStep(config: Partial<GhostRiderStepConfig<T>>) {\n    this.config = {\n      ...new GhostRiderStepConfig(),\n      ...config,\n    };\n  }\n\n  public get ghostRiderStep(): GhostRiderStepConfig<T> {\n    return this.config;\n  }\n\n  @Output()\n  public ghostRiderStepEvent: EventEmitter<GhostRiderEvent> = new EventEmitter();\n\n  public config!: GhostRiderStepConfig<T>;\n  public active$: BehaviorSubject<boolean> = new BehaviorSubject(false as boolean);\n\n  private readonly _subs: Subscription[] = [];\n\n\tconstructor(\n    public readonly element: ElementRef<HTMLElement>,\n    public readonly vcr: ViewContainerRef,\n\t\tprivate readonly _ghostRiderService: GhostRiderService,\n\t) { }\n\n  ngOnInit(): void {\n    if (this.config.name && this.config.shouldRegister) {\n      this._ghostRiderService.registerStep(this);\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.config && this.config.name) {\n      this._ghostRiderService.unregisterStep(this);\n    }\n\n    this._subs.forEach((sub) => sub.unsubscribe());\n  }\n}","import { Directive, HostListener } from '@angular/core';\nimport { GhostRiderEventSource } from '../models/ghost-rider-step-event.model';\nimport { GhostRiderService } from '../providers/ghost-rider.service';\n\n@Directive({ selector: '[ghostRiderStepComplete]' })\nexport class GhostRiderStepCompleteDirective {\n\n  constructor(\n    private readonly _ghostRiderService: GhostRiderService,\n  ) { }\n\n  @HostListener('click')\n  public complete(): void {\n    this._ghostRiderService.complete(GhostRiderEventSource.Directive);\n  }\n}\n","import { Directive, HostListener } from '@angular/core';\nimport { GhostRiderService } from '../providers/ghost-rider.service';\n\n@Directive({ selector: '[ghostRiderStepHide]' })\nexport class GhostRiderStepHideDirective {\n  constructor(\n    private readonly _ghostRiderService: GhostRiderService,\n  ) { }\n\n  @HostListener('click')\n  public hide(): void {\n    if (this._ghostRiderService.activeTour) {\n      this._ghostRiderService.hideStep();\n    }\n  }\n}\n","import { Directive, HostListener } from '@angular/core';\nimport { GhostRiderService } from '../providers/ghost-rider.service';\nimport { GhostRiderEventSource } from '../models/ghost-rider-step-event.model';\n\n@Directive({ selector: '[ghostRiderStepPrevious]' })\nexport class GhostRiderStepPreviousDirective {\n\n  constructor(\n    private readonly _ghostRiderService: GhostRiderService,\n  ) { }\n\n  @HostListener('click')\n  public previous(): void {\n    this._ghostRiderService.back(GhostRiderEventSource.Directive);\n  }\n}\n","import { Inject, Injectable, ExistingProvider } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { OverlayContainer } from '@angular/cdk/overlay';\nimport { Platform } from '@angular/cdk/platform';\n\n@Injectable({ providedIn: 'root' })\nexport class GhostRiderOverlayContainer extends OverlayContainer {\n\tconstructor(\n\t\t@Inject(DOCUMENT) document: any,\n\t\tplatform: Platform,\n\t) {\n\t\tsuper(document, platform);\n\t}\n\n\tprotected _createContainer(): void {\n\t\tsuper._createContainer();\n\t\tthis._containerElement.classList.add('ghost-rider'); // TODO: Make configurable\n\t}\n}\n\nexport const GHOST_RIDER_OVERLAY_CONTAINER_PROVIDER: ExistingProvider = {\n\tprovide: OverlayContainer,\n\tuseExisting: GhostRiderOverlayContainer,\n};\n","import { PortalModule } from '@angular/cdk/portal';\nimport { OverlayModule } from '@angular/cdk/overlay';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n\n// Components\nimport { GhostRiderStepComponent } from './components/ghost-rider-step.component';\nimport { PopoverComponent } from './components/popover.component';\n\n// Direcctives\nimport { GhostRiderStepAdvanceDirective } from './directives/ghost-rider-step-advance.directive';\nimport { GhostRiderStepDirective } from './directives/ghost-rider-step.directive';\nimport { GhostRiderStepCompleteDirective } from './directives/ghost-rider-step-complete.directive';\nimport { GhostRiderStepHideDirective } from './directives/ghost-rider-step-hide.directive';\nimport { GhostRiderStepPreviousDirective } from './directives/ghost-rider-step-previous.directive';\n\n// Providers\nimport { GHOST_RIDER_POPOVER_POSITION_STRATEGY_FACTORY_PROVIDER } from './providers/popover-position-strategy.service';\nimport { GHOST_RIDER_OVERLAY_CONTAINER_PROVIDER } from './providers/overlay-container.service';\nimport { GhostRiderService } from './providers/ghost-rider.service';\nimport { GHOST_RIDER_POPOVER_SCROLL_STRATEGY_FACTORY_PROVIDER } from './tokens/popover-scroll-strategy.token';\nimport { GHOST_RIDER_POPOVER_CONTAINER_FACTORY_PROVIDER } from './tokens/popover-container.token';\nimport { GHOST_RIDER_NAVIGATION } from './tokens/ghost-rider-navigation.token';\n\nconst DIRECTIVES = [\n  GhostRiderStepDirective,\n  GhostRiderStepAdvanceDirective,\n  GhostRiderStepCompleteDirective,\n  GhostRiderStepHideDirective,\n  GhostRiderStepPreviousDirective,\n];\n\nconst COMPONENTS = [\n  GhostRiderStepComponent,\n  PopoverComponent\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    PortalModule,\n    OverlayModule,\n  ],\n  declarations: [\n    ...COMPONENTS,\n    ...DIRECTIVES\n  ],\n  exports: [\n    ...COMPONENTS,\n    ...DIRECTIVES,\n  ],\n  providers: [\n    {\n      provide: GHOST_RIDER_NAVIGATION,\n      useExisting: GhostRiderService,\n    },\n    GHOST_RIDER_POPOVER_SCROLL_STRATEGY_FACTORY_PROVIDER,\n    GHOST_RIDER_POPOVER_POSITION_STRATEGY_FACTORY_PROVIDER,\n    GHOST_RIDER_POPOVER_CONTAINER_FACTORY_PROVIDER,\n    GHOST_RIDER_OVERLAY_CONTAINER_PROVIDER,\n  ],\n})\nexport class GhostRiderModule { }\n","export class GhostRiderStep {\n  public readonly hasSubSteps: boolean = false;\n  public readonly subSteps: GhostRiderStep[] = [];\n\n  public parent?: GhostRiderStep;\n  public hidden: boolean = false;\n\n  constructor(\n    public name: string,\n    ...steps: GhostRiderStep[]\n  ) {\n    if (steps && steps.length) {\n      this.hasSubSteps = true;\n      this.subSteps = steps;\n\n      steps.forEach((subStep) => {\n        subStep.parent = this;\n      });\n    }\n  }\n}","/*\n * Public API Surface of ng-ghost-rider\n */\n\n// Modules\nexport { GhostRiderModule } from './lib/ghost-rider.module';\n\n// Directives\nexport { GhostRiderStepDirective } from './lib/directives/ghost-rider-step.directive';\nexport { GhostRiderStepAdvanceDirective } from './lib/directives/ghost-rider-step-advance.directive';\nexport { GhostRiderStepCompleteDirective } from './lib/directives/ghost-rider-step-complete.directive';\nexport { GhostRiderStepHideDirective } from './lib/directives/ghost-rider-step-hide.directive';\nexport { GhostRiderStepPreviousDirective } from './lib/directives/ghost-rider-step-previous.directive';\n\n// Components\nexport { GhostRiderStepComponent } from './lib/components/ghost-rider-step.component';\nexport { PopoverComponent } from './lib/components/popover.component';\n\n// Models\nexport { GhostRiderStep } from './lib/models/ghost-rider-step.model';\nexport {\n\tGhostRiderEventSource,\n\tGhostRiderEventType,\n\tGhostRiderEvent\n} from './lib/models/ghost-rider-step-event.model';\n\n// Providers\nexport { GhostRiderService } from './lib/providers/ghost-rider.service';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1","i2","i1.GhostRiderService"],"mappings":";;;;;;;;;;;;;;;;;;;;;;IAAY,oBAMX;AAND,CAAA,UAAY,mBAAmB,EAAA;AAC7B,IAAA,mBAAA,CAAA,mBAAA,CAAA,OAAA,CAAA,GAAA,CAAA,CAAA,GAAA,OAAK,CAAA;AACL,IAAA,mBAAA,CAAA,mBAAA,CAAA,MAAA,CAAA,GAAA,CAAA,CAAA,GAAA,MAAI,CAAA;AACJ,IAAA,mBAAA,CAAA,mBAAA,CAAA,MAAA,CAAA,GAAA,CAAA,CAAA,GAAA,MAAI,CAAA;AACJ,IAAA,mBAAA,CAAA,mBAAA,CAAA,OAAA,CAAA,GAAA,CAAA,CAAA,GAAA,OAAK,CAAA;AACL,IAAA,mBAAA,CAAA,mBAAA,CAAA,UAAA,CAAA,GAAA,CAAA,CAAA,GAAA,UAAQ,CAAA;AACV,CAAC,EANW,mBAAmB,KAAnB,mBAAmB,GAM9B,EAAA,CAAA,CAAA,CAAA;IAEW,sBAIX;AAJD,CAAA,UAAY,qBAAqB,EAAA;AAC/B,IAAA,qBAAA,CAAA,qBAAA,CAAA,WAAA,CAAA,GAAA,CAAA,CAAA,GAAA,WAAS,CAAA;AACT,IAAA,qBAAA,CAAA,qBAAA,CAAA,SAAA,CAAA,GAAA,CAAA,CAAA,GAAA,SAAO,CAAA;AACP,IAAA,qBAAA,CAAA,qBAAA,CAAA,QAAA,CAAA,GAAA,CAAA,CAAA,GAAA,QAAM,CAAA;AACR,CAAC,EAJW,qBAAqB,KAArB,qBAAqB,GAIhC,EAAA,CAAA,CAAA;;ACTM,MAAM,sBAAsB,GAAG,IAAI,cAAc,CACvD,sBAAsB,CACtB;;ACLD;;;;;;AAMG;MAgCU,gBAAgB,CAAA;AAgD5B,IAAA,WAAA,CACS,IAAuB,EAAA;QAAvB,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAmB;;QAXxB,IAAW,CAAA,WAAA,GAAsB,SAAS,CAAC;;AAGlC,QAAA,IAAA,CAAA,OAAO,GAAiB,IAAI,OAAO,EAAE,CAAC;;AAGtC,QAAA,IAAA,CAAA,OAAO,GAAiB,IAAI,OAAO,EAAE,CAAC;KAMlD;IAjDL,IAAW,OAAO,CAAC,OAA0B,EAAA;AAC5C,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;AAC5D,QAAA,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;AAChC,YAAA,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC;AAC3B,SAAA;aAAM,IAAI,OAAO,YAAY,cAAc,EAAE;AAC7C,YAAA,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC;AAC1B,SAAA;aAAM,IAAI,OAAO,YAAY,eAAe,EAAE;AAC9C,YAAA,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC;AAC1B,SAAA;KACD;IAYD,IAAW,QAAQ,KAAwB,OAAO,IAAI,CAAC,SAAS,CAAC,EAAE;IACnE,IAAW,QAAQ,CAAC,GAAsB,EAAA;AACzC,QAAA,IAAI,GAAG,KAAK,IAAI,CAAC,SAAS,EAAE;AAC3B,YAAA,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;AACrB,YAAA,IAAI,CAAC,SAAS,GAAG,GAAG,GAAG,CAAA,mBAAA,EAAsB,iBAAiB,CAAC,GAAG,CAAC,CAAA,CAAE,GAAG,IAAyB,CAAC;AAClG,YAAA,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;AACzB,SAAA;KACD;AAiBD,IAAA,IAAW,UAAU,GAAc,EAAA,OAAO,CAAC,CAAC,IAAI,CAAC,cAAc,IAAI,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE;IAM3F,WAAW,GAAA;AACV,QAAA,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;AACxB,QAAA,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;KACxB;AAED;;;AAGG;AACI,IAAA,IAAI,CAAC,KAAa,EAAA;;QAExB,IAAI,IAAI,CAAC,cAAc,EAAE;AACxB,YAAA,YAAY,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAClC,YAAA,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;AAC3B,SAAA;AAED,QAAA,IAAI,CAAC,cAAc,GAAG,UAAU,CAAC,MAAK;AACrC,YAAA,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;AAC7B,YAAA,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;AAC3B,YAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;;AAIxB,YAAA,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;SACzB,EAAE,KAAK,CAAkB,CAAC;KAC3B;AAED;;;AAGG;AACI,IAAA,IAAI,CAAC,KAAa,EAAA;;QAExB,IAAI,IAAI,CAAC,cAAc,EAAE;AACxB,YAAA,YAAY,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAClC,YAAA,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;AAC3B,SAAA;AAED,QAAA,IAAI,CAAC,cAAc,GAAG,UAAU,CAAC,MAAK;AACrC,YAAA,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC;AAC5B,YAAA,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;AAC3B,YAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;;AAIxB,YAAA,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;SACzB,EAAE,KAAK,CAAkB,CAAC;KAC3B;;IAGM,WAAW,GAAA;AACjB,QAAA,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC;KACnC;;IAGM,YAAY,GAAA;AAClB,QAAA,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC;KACnC;;IAGM,SAAS,GAAA;AACf,QAAA,OAAO,IAAI,CAAC,WAAW,KAAK,SAAS,CAAC;KACtC;IAEM,YAAY,GAAA;AAClB,QAAA,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;KACzB;;6GAtHW,gBAAgB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,iBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;AAAhB,gBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,oBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,IAAA,EAAA,gBAAgB,EApBlB,QAAA,EAAA,qBAAA,EAAA,QAAA,EAAA,EAAA,EAAA,QAAA,EAAA,CAAA;;;;;;;;;;;;;;;;;;AAkBT,CAAA,CAAA,EAAA,QAAA,EAAA,IAAA,EAAA,YAAA,EAAA,CAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,OAAA,EAAA,QAAA,EAAA,WAAA,EAAA,MAAA,EAAA,CAAA,OAAA,EAAA,SAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,SAAA,EAAA,QAAA,EAAA,aAAA,EAAA,QAAA,EAAA,CAAA,WAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,eAAA,EAAA,QAAA,EAAA,mBAAA,EAAA,MAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,OAAA,EAAA,CAAA,UAAA,CAAA,EAAA,QAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,EAAA,CAAA,CAAA;2FAEW,gBAAgB,EAAA,UAAA,EAAA,CAAA;kBAtB5B,SAAS;AAAC,YAAA,IAAA,EAAA,CAAA;AACV,oBAAA,QAAQ,EAAE,qBAAqB;AAC/B,oBAAA,QAAQ,EAAE,CAAA;;;;;;;;;;;;;;;;;;AAkBT,CAAA,CAAA;AACD,iBAAA,CAAA;;AA4HD,SAAS,iBAAiB,CAAC,QAA2B,EAAA;IACrD,MAAM,SAAS,GAAa,EAAE,CAAC;AAE/B,IAAA,IAAI,QAAQ,CAAC,OAAO,KAAK,QAAQ,EAAE;AAClC,QAAA,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,KAAK,QAAQ,GAAG,KAAK,GAAG,QAAQ,CAAC,CAAC;AAEjE,QAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;AACnC,YAAA,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,KAAK,OAAO,GAAG,MAAM,GAAG,OAAO,CAAC,CAAC;AACjE,SAAA;AACD,KAAA;AAAM,SAAA;AACN,QAAA,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,KAAK,KAAK,GAAG,MAAM,GAAG,OAAO,CAAC,CAAC;AAE9D,QAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;AACnC,YAAA,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAClC,SAAA;AACD,KAAA;AAED,IAAA,QAAQ,SAAS,CAAC,MAAM,GAAG,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,IAAW,EAAE;AAC/D;;AClGM,MAAO,uBAAwB,SAAQ,gBAAgB,CAAA;IAU5D,WACkD,CAAA,WAAiC,EAClF,GAAsB,EAAA;QAEtB,KAAK,CAAC,GAAG,CAAC,CAAC;QAHsC,IAAW,CAAA,WAAA,GAAX,WAAW,CAAsB;AAKlF,QAAA,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC;AAChE,QAAA,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC;AAC3D,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAU,CAAC,WAAW,CAAC;QAErE,IAAI,IAAI,CAAC,SAAS,EAAE;AACnB,YAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,QAAQ,CAAC;AACxE,YAAA,IAAI,QAAQ,EAAE;AACb,gBAAA,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;AACzE,gBAAA,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,MAAM,CAAC;AACjC,aAAA;AACD,SAAA;AAAM,aAAA;YACN,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,WAAW,CAAC;AACxD,YAAA,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC;AACzD,SAAA;AAED,QAAA,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;KACxD;IAED,WAAW,GAAA;QACV,KAAK,CAAC,WAAW,EAAE,CAAC;KACpB;IAEM,IAAI,GAAA;AACV,QAAA,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;AAC5B,YAAA,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;AAC5B,SAAA;AAAM,aAAA;YACN,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;AACrD,SAAA;KACD;IAEM,WAAW,GAAA;QACjB,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;KAC5D;IAEM,eAAe,GAAA;QACrB,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;KAChE;IAEM,UAAU,GAAA;QAChB,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;KAC3D;IAEM,IAAI,GAAA;QACV,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;KACrD;IAEM,KAAK,GAAA;QACX,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;KACtD;IAEM,QAAQ,GAAA;QACd,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC;KACzD;;AApEW,uBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,kBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,uBAAuB,kBAW1B,sBAAsB,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,iBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;AAXnB,uBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,oBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,IAAA,EAAA,uBAAuB,EAxEzB,QAAA,EAAA,kBAAA,EAAA,eAAA,EAAA,IAAA,EAAA,QAAA,EAAA,EAAA,EAAA,QAAA,EAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqET,CAAA,CAAA,EAAA,QAAA,EAAA,IAAA,EAAA,YAAA,EAAA,CAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,OAAA,EAAA,QAAA,EAAA,WAAA,EAAA,MAAA,EAAA,CAAA,OAAA,EAAA,SAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,IAAA,EAAA,QAAA,EAAA,QAAA,EAAA,MAAA,EAAA,CAAA,MAAA,EAAA,UAAA,EAAA,UAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,SAAA,EAAA,QAAA,EAAA,aAAA,EAAA,QAAA,EAAA,CAAA,WAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,eAAA,EAAA,QAAA,EAAA,mBAAA,EAAA,MAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,OAAA,EAAA,CAAA,UAAA,CAAA,EAAA,QAAA,EAAA,CAAA,iBAAA,CAAA,EAAA,CAAA,EAAA,CAAA,CAAA;2FAGW,uBAAuB,EAAA,UAAA,EAAA,CAAA;kBA1EnC,SAAS;AACC,YAAA,IAAA,EAAA,CAAA,EAAA,QAAA,EAAA,kBAAkB,EAClB,QAAA,EAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqET,CAAA,CAAA,EAAA,CAAA;;0BAcC,MAAM;2BAAC,sBAAsB,CAAA;;;ACzFhC;AACO,MAAM,kBAAkB,GAAG,EAAE,CAAC;AAErC;AACO,MAAM,mCAAmC,GAAG,IAAI,cAAc,CACpE,iCAAiC,CACjC,CAAC;AAEF;AACM,SAAU,2CAA2C,CAAC,OAAgB,EAAA;IAC3E,OAAO,MAAM,OAAO,CAAC,gBAAgB,CAAC,UAAU,CAC/C;AACC,QAAA,cAAc,EAAE,kBAAkB;AAClC,KAAA,CACD,CAAC;AACH,CAAC;AAED;AACO,MAAM,oDAAoD,GAAG;AACnE,IAAA,OAAO,EAAE,mCAAmC;IAC5C,IAAI,EAAE,CAAC,OAAO,CAAC;AACf,IAAA,UAAU,EAAE,2CAA2C;CACvD;;MCnBY,8BAA8B,CAAA;IAG1C,WACmB,CAAA,QAAa,EACvB,cAA6B,EAAA;QAA7B,IAAc,CAAA,cAAA,GAAd,cAAc,CAAe;AAErC,QAAA,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;KAC1B;IAEM,qBAAqB,GAAA;QAC3B,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC;QACzD,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,YAAY,CAAC;QAC3D,MAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,yBAAyB,EAAE,CAAC;QAEvE,OAAO;YACN,GAAG,EAAE,cAAc,CAAC,GAAG;YACvB,IAAI,EAAE,cAAc,CAAC,IAAI;AACzB,YAAA,KAAK,EAAE,cAAc,CAAC,IAAI,GAAG,KAAK;AAClC,YAAA,MAAM,EAAE,cAAc,CAAC,GAAG,GAAG,MAAM;YACnC,KAAK;YACL,MAAM;SACK,CAAC;KACb;;AAvBW,8BAAA,CAAA,IAAA,GAAA,EAAA,CAAA,kBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,8BAA8B,kBAIjC,QAAQ,EAAA,EAAA,EAAA,KAAA,EAAAA,IAAA,CAAA,aAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;AAJL,8BAAA,CAAA,KAAA,GAAA,EAAA,CAAA,qBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,8BAA8B,cADjB,MAAM,EAAA,CAAA,CAAA;2FACnB,8BAA8B,EAAA,UAAA,EAAA,CAAA;kBAD1C,UAAU;mBAAC,EAAE,UAAU,EAAE,MAAM,EAAE,CAAA;;0BAK/B,MAAM;2BAAC,QAAQ,CAAA;;;ACHX,MAAM,6BAA6B,GAAG,IAAI,cAAc,CAA6B,4BAA4B,CAAC,CAAC;AAEnH,MAAM,8CAA8C,GAAG;AAC7D,IAAA,OAAO,EAAE,6BAA6B;AACtC,IAAA,WAAW,EAAE,8BAA8B;CAC3C;;ACZD;;;;;;AAMG;AAyBH;AACA,MAAM,gBAAgB,GAAG,6CAA6C,CAAC;AAEvE;AACO,MAAM,qCAAqC,GAAG,IAAI,cAAc,CAAiC,yBAAyB,CAAC,CAAC;AAkBnI;;;;;;AAMG;MACU,uBAAuB,CAAA;IA8FnC,WACC,CAAA,WAA0C,EAChC,cAA6B,EAC7B,SAAmB,EACnB,SAAmB,EACnB,iBAAmC,EACnC,cAA8C,EAAA;QAJ9C,IAAc,CAAA,cAAA,GAAd,cAAc,CAAe;QAC7B,IAAS,CAAA,SAAA,GAAT,SAAS,CAAU;QACnB,IAAS,CAAA,SAAA,GAAT,SAAS,CAAU;QACnB,IAAiB,CAAA,iBAAA,GAAjB,iBAAiB,CAAkB;QACnC,IAAc,CAAA,cAAA,GAAd,cAAc,CAAgC;;QA5F/C,IAAoB,CAAA,oBAAA,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC;;QAG/C,IAAS,CAAA,SAAA,GAAG,KAAK,CAAC;;QAGlB,IAAQ,CAAA,QAAA,GAAG,IAAI,CAAC;;QAGhB,IAAc,CAAA,cAAA,GAAG,KAAK,CAAC;;QAGvB,IAAsB,CAAA,sBAAA,GAAG,KAAK,CAAC;;QAG/B,IAAe,CAAA,eAAA,GAAG,KAAK,CAAC;;QAcxB,IAAe,CAAA,eAAA,GAAG,CAAC,CAAC;;QAGpB,IAAY,CAAA,YAAA,GAAoB,EAAE,CAAC;AAEnC,QAAA,IAAA,CAAA,UAAU,GAA+B,IAAI,CAAC,cAAc,CAAC;;QAGvE,IAAmB,CAAA,mBAAA,GAA6B,EAAE,CAAC;;AAqBzC,QAAA,IAAA,CAAA,gBAAgB,GAAG,IAAI,OAAO,EAAkC,CAAC;;AAGjE,QAAA,IAAA,CAAA,mBAAmB,GAAG,YAAY,CAAC,KAAK,CAAC;;QAGzC,IAAQ,CAAA,QAAA,GAAG,CAAC,CAAC;;QAGb,IAAQ,CAAA,QAAA,GAAG,CAAC,CAAC;;QAGb,IAAwB,CAAA,wBAAA,GAAW,sBAAsB,CAAC;;QAG1D,IAAoB,CAAA,oBAAA,GAAa,EAAE,CAAC;;AAM9C,QAAA,IAAA,CAAA,eAAe,GAA+C,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC;AAelG,QAAA,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;KAC5B;;AAbD,IAAA,IAAI,SAAS,GAAA;QACZ,OAAO,IAAI,CAAC,mBAAmB,CAAC;KAChC;;AAcD,IAAA,MAAM,CAAC,UAAsB,EAAA;QAC5B,IAAI,IAAI,CAAC,WAAW,IAAI,UAAU,KAAK,IAAI,CAAC,WAAW,EAAE;AACxD,YAAA,MAAM,KAAK,CAAC,0DAA0D,CAAC,CAAC;AACxE,SAAA;QAED,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAE1B,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;AAEvD,QAAA,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;AAC9B,QAAA,IAAI,CAAC,YAAY,GAAG,UAAU,CAAC,WAAW,CAAC;AAC3C,QAAA,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC,cAAc,CAAC;AACvC,QAAA,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;AACzB,QAAA,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;AAC7B,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;AAC1B,QAAA,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC;AACvC,QAAA,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC,MAAK;;;;AAItE,YAAA,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;YAC7B,IAAI,CAAC,KAAK,EAAE,CAAC;AACd,SAAC,CAAC,CAAC;KACH;AAED;;;;;;;;;;;;;AAaG;IACH,KAAK,GAAA;;QAEJ,IAAI,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE;YAClD,OAAO;AACP,SAAA;;;;AAKD,QAAA,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,aAAa,EAAE;YACzE,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC3B,OAAO;AACP,SAAA;QAED,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC1B,IAAI,CAAC,0BAA0B,EAAE,CAAC;QAClC,IAAI,CAAC,uBAAuB,EAAE,CAAC;;;;QAK/B,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAChE,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QACzC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;QACvD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AAE7D,QAAA,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC;AACpC,QAAA,MAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC;AACtC,QAAA,MAAM,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC;AACxC,QAAA,MAAM,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC;;QAG1C,MAAM,YAAY,GAAkB,EAAE,CAAC;;AAGvC,QAAA,IAAI,QAAsC,CAAC;;;AAI3C,QAAA,KAAK,MAAM,GAAG,IAAI,IAAI,CAAC,mBAAmB,EAAE;;YAE3C,MAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;;;;AAK1D,YAAA,MAAM,YAAY,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,WAAW,EAAE,GAAG,CAAC,CAAC;;AAG1E,YAAA,MAAM,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,WAAW,EAAE,aAAa,EAAE,GAAG,CAAC,CAAC;;YAGtF,IAAI,UAAU,CAAC,0BAA0B,EAAE;AAC1C,gBAAA,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;AACvB,gBAAA,IAAI,CAAC,cAAc,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC;gBACtC,OAAO;AACP,aAAA;;;YAID,IAAI,IAAI,CAAC,6BAA6B,CAAC,UAAU,EAAE,YAAY,EAAE,YAAY,CAAC,EAAE;;;gBAG/E,YAAY,CAAC,IAAI,CAAC;AACjB,oBAAA,QAAQ,EAAE,GAAG;AACb,oBAAA,MAAM,EAAE,WAAW;oBACnB,WAAW;oBACX,eAAe,EAAE,IAAI,CAAC,yBAAyB,CAAC,WAAW,EAAE,GAAG,CAAC;AACjE,iBAAA,CAAC,CAAC;gBAEH,SAAS;AACT,aAAA;;;;AAKD,YAAA,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,UAAU,CAAC,WAAW,GAAG,UAAU,CAAC,WAAW,EAAE;AAC1E,gBAAA,QAAQ,GAAG,EAAE,UAAU,EAAE,YAAY,EAAE,WAAW,EAAE,QAAQ,EAAE,GAAG,EAAE,WAAW,EAAE,CAAC;AACjF,aAAA;AACD,SAAA;;;QAID,IAAI,YAAY,CAAC,MAAM,EAAE;YACxB,IAAI,OAAO,GAAgB,IAA8B,CAAC;AAC1D,YAAA,IAAI,SAAS,GAAG,CAAC,CAAC,CAAC;AACnB,YAAA,KAAK,MAAM,GAAG,IAAI,YAAY,EAAE;gBAC/B,MAAM,KAAK,GACV,GAAG,CAAC,eAAe,CAAC,KAAK,GAAG,GAAG,CAAC,eAAe,CAAC,MAAM,IAAI,GAAG,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC;gBACrF,IAAI,KAAK,GAAG,SAAS,EAAE;oBACtB,SAAS,GAAG,KAAK,CAAC;oBAClB,OAAO,GAAG,GAAG,CAAC;AACd,iBAAA;AACD,aAAA;AAED,YAAA,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACvB,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;YACtD,OAAO;AACP,SAAA;;;QAID,IAAI,IAAI,CAAC,QAAQ,EAAE;AAClB,YAAA,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,IAAI,CAAC,cAAc,CAAC,QAAS,CAAC,QAAQ,EAAE,QAAS,CAAC,WAAW,CAAC,CAAC;YAC/D,OAAO;AACP,SAAA;;;QAID,IAAI,CAAC,cAAc,CAAC,QAAS,CAAC,QAAQ,EAAE,QAAS,CAAC,WAAW,CAAC,CAAC;KAC/D;IAED,MAAM,GAAA;QACL,IAAI,CAAC,kBAAkB,EAAE,CAAC;AAC1B,QAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;AAC1B,QAAA,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;AAChC,QAAA,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC;KACvC;;IAGD,OAAO,GAAA;QACN,IAAI,IAAI,CAAC,WAAW,EAAE;YACrB,OAAO;AACP,SAAA;;;QAID,IAAI,IAAI,CAAC,YAAY,EAAE;AACtB,YAAA,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE;AACrC,gBAAA,GAAG,EAAE,EAAE;AACP,gBAAA,IAAI,EAAE,EAAE;AACR,gBAAA,KAAK,EAAE,EAAE;AACT,gBAAA,MAAM,EAAE,EAAE;AACV,gBAAA,MAAM,EAAE,EAAE;AACV,gBAAA,KAAK,EAAE,EAAE;AACT,gBAAA,UAAU,EAAE,EAAE;AACd,gBAAA,cAAc,EAAE,EAAE;AACK,aAAA,CAAC,CAAC;AAC1B,SAAA;QAED,IAAI,IAAI,CAAC,KAAK,EAAE;YACf,IAAI,CAAC,0BAA0B,EAAE,CAAC;AAClC,SAAA;QAED,IAAI,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAC;AAChE,SAAA;QAED,IAAI,CAAC,MAAM,EAAE,CAAC;AACd,QAAA,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,CAAC;QACjC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,GAAG,IAAW,CAAC;AACnD,QAAA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;KACxB;AAED;;;;AAIG;IACH,mBAAmB,GAAA;AAClB,QAAA,IAAI,CAAC,IAAI,CAAC,WAAW,KAAK,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,EAAE;AACvE,YAAA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;YACzC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;YACvD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAEhE,YAAA,MAAM,YAAY,GAAG,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC;AACvE,YAAA,MAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;AAEzE,YAAA,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;AAC/C,SAAA;KACD;AAED;;;;AAIG;AACH,IAAA,wBAAwB,CAAC,WAA4B,EAAA;AACpD,QAAA,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;AAChC,QAAA,OAAO,IAAI,CAAC;KACZ;AAED,IAAA,aAAa,CAAC,SAAqC,EAAA;QAClD,IAAI,CAAC,UAAU,GAAG,SAAS,IAAI,IAAI,CAAC,cAAc,CAAC;AACnD,QAAA,OAAO,IAAI,CAAC;KACZ;AAED;;;AAGG;AACH,IAAA,aAAa,CAAC,SAA8B,EAAA;AAC3C,QAAA,IAAI,CAAC,mBAAmB,GAAG,SAAS,CAAC;;;QAIrC,IAAI,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,aAAkC,CAAC,KAAK,CAAC,CAAC,EAAE;AACtE,YAAA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;AAC1B,SAAA;QAED,IAAI,CAAC,kBAAkB,EAAE,CAAC;AAE1B,QAAA,OAAO,IAAI,CAAC;KACZ;AAED;;;;;;AAMG;AACH,IAAA,SAAS,CAAC,MAAqC,EAAA;AAC9C,QAAA,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;AACtB,QAAA,OAAO,IAAI,CAAC;KACZ;AAED;;AAEG;IACK,eAAe,CAAC,UAAsB,EAAE,GAAsB,EAAA;AACrE,QAAA,IAAI,CAAS,CAAC;AACd,QAAA,IAAI,GAAG,CAAC,OAAO,KAAK,QAAQ,EAAE;;;AAG7B,YAAA,CAAC,GAAG,UAAU,CAAC,IAAI,IAAI,UAAU,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;AAC7C,SAAA;AAAM,aAAA;AACN,YAAA,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,UAAU,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC;AAClE,YAAA,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,UAAU,CAAC,IAAI,GAAG,UAAU,CAAC,KAAK,CAAC;AAChE,YAAA,CAAC,GAAG,GAAG,CAAC,OAAO,KAAK,OAAO,GAAG,MAAM,GAAG,IAAI,CAAC;AAC5C,SAAA;AAED,QAAA,IAAI,CAAS,CAAC;AACd,QAAA,IAAI,GAAG,CAAC,OAAO,KAAK,QAAQ,EAAE;AAC7B,YAAA,CAAC,GAAG,UAAU,CAAC,GAAG,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;AAC7C,SAAA;AAAM,aAAA;AACN,YAAA,CAAC,GAAG,GAAG,CAAC,OAAO,KAAK,KAAK,GAAG,UAAU,CAAC,GAAG,GAAG,UAAU,CAAC,MAAM,CAAC;AAC/D,SAAA;AAED,QAAA,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;KAChB;AAED;;;AAGG;AACK,IAAA,gBAAgB,CACvB,WAAkB,EAClB,WAAuB,EACvB,GAAsB,EAAA;;;AAItB,QAAA,IAAI,aAAqB,CAAC;AAC1B,QAAA,IAAI,GAAG,CAAC,QAAQ,KAAK,QAAQ,EAAE;AAC9B,YAAA,aAAa,GAAG,CAAC,WAAW,CAAC,KAAK,GAAG,CAAC,CAAC;AACvC,SAAA;AAAM,aAAA,IAAI,GAAG,CAAC,QAAQ,KAAK,OAAO,EAAE;AACpC,YAAA,aAAa,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,WAAW,CAAC,KAAK,GAAG,CAAC,CAAC;AACvD,SAAA;AAAM,aAAA;AACN,YAAA,aAAa,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC;AACvD,SAAA;AAED,QAAA,IAAI,aAAqB,CAAC;AAC1B,QAAA,IAAI,GAAG,CAAC,QAAQ,KAAK,QAAQ,EAAE;AAC9B,YAAA,aAAa,GAAG,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;AACxC,SAAA;AAAM,aAAA;AACN,YAAA,aAAa,GAAG,GAAG,CAAC,QAAQ,KAAK,KAAK,GAAG,CAAC,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC;AACjE,SAAA;;QAGD,OAAO;AACN,YAAA,CAAC,EAAE,WAAW,CAAC,CAAC,GAAG,aAAa;AAChC,YAAA,CAAC,EAAE,WAAW,CAAC,CAAC,GAAG,aAAa;SAChC,CAAC;KACF;;AAGO,IAAA,cAAc,CACrB,KAAY,EACZ,OAAmB,EACnB,QAAoB,EACpB,QAA2B,EAAA;AAE3B,QAAA,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC;QACrB,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;QAC/C,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;;AAG/C,QAAA,IAAI,OAAO,EAAE;YACZ,CAAC,IAAI,OAAO,CAAC;AACb,SAAA;AAED,QAAA,IAAI,OAAO,EAAE;YACZ,CAAC,IAAI,OAAO,CAAC;AACb,SAAA;;AAGD,QAAA,MAAM,YAAY,GAAG,QAAQ,CAAC,IAAI,GAAG,CAAC,CAAC;AACvC,QAAA,MAAM,aAAa,GAAG,CAAC,CAAC,GAAG,OAAO,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,CAAC;AAC3D,QAAA,MAAM,WAAW,GAAG,QAAQ,CAAC,GAAG,GAAG,CAAC,CAAC;AACrC,QAAA,MAAM,cAAc,GAAG,CAAC,CAAC,GAAG,OAAO,CAAC,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC;;AAG9D,QAAA,MAAM,YAAY,GAAG,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,KAAK,EAAE,YAAY,EAAE,aAAa,CAAC,CAAC;AACzF,QAAA,MAAM,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,MAAM,EAAE,WAAW,EAAE,cAAc,CAAC,CAAC;AAC3F,QAAA,MAAM,WAAW,GAAG,YAAY,GAAG,aAAa,CAAC;QAEjD,OAAO;AACN,YAAA,WAAW,EAAE,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC;;YAElC,0BAA0B,EAAE,CAAC,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC,MAAM,MAAM,WAAW;AAC5E,YAAA,wBAAwB,EAAE,aAAa,KAAK,OAAO,CAAC,MAAM;AAC1D,YAAA,0BAA0B,EAAE,YAAY,KAAK,OAAO,CAAC,KAAK;SAC1D,CAAC;KACF;AAED;;;;;AAKG;AACK,IAAA,6BAA6B,CAAC,GAAe,EAAE,KAAY,EAAE,QAAoB,EAAA;QACxF,IAAI,IAAI,CAAC,sBAAsB,EAAE;YAChC,MAAM,eAAe,GAAG,QAAQ,CAAC,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC;YAClD,MAAM,cAAc,GAAG,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC;YAChD,MAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,SAAS,CAAC;YACzD,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,QAAQ,CAAC;AAEvD,YAAA,MAAM,WAAW,GAAG,GAAG,CAAC,wBAAwB;iBAC9C,SAAS,IAAI,IAAI,IAAI,SAAS,IAAI,eAAe,CAAC,CAAC;AACrD,YAAA,MAAM,aAAa,GAAG,GAAG,CAAC,0BAA0B;iBAClD,QAAQ,IAAI,IAAI,IAAI,QAAQ,IAAI,cAAc,CAAC,CAAC;YAElD,OAAO,WAAW,IAAI,aAAa,CAAC;AACpC,SAAA;AACD,QAAA,OAAO,KAAK,CAAC;KACb;AAED;;;;;;;;;;AAUG;AACK,IAAA,oBAAoB,CAC3B,KAAY,EACZ,OAAmB,EACnB,cAAsC,EACtC,QAAgC,EAAA;;;;AAKhC,QAAA,IAAI,IAAI,CAAC,mBAAmB,IAAI,IAAI,CAAC,eAAe,EAAE;YACrD,OAAO;gBACN,CAAC,EAAE,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC,CAAC;gBACvC,CAAC,EAAE,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,mBAAmB,CAAC,CAAC;aACvC,CAAC;AACF,SAAA;AAED,QAAA,MAAM,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC;;;AAItC,QAAA,MAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,OAAO,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,IAAI,QAAQ,CAAC,OAAO,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACvG,QAAA,MAAM,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,OAAO,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,IAAI,QAAQ,CAAC,OAAO,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC1G,QAAA,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,GAAG,cAAc,CAAC,GAAG,GAAG,KAAK,CAAC,CAAC,IAAI,QAAQ,CAAC,OAAO,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACxG,QAAA,MAAM,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,GAAG,cAAc,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC,IAAI,QAAQ,CAAC,OAAO,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;;QAG3G,IAAI,KAAK,GAAG,CAAC,CAAC;QACd,IAAI,KAAK,GAAG,CAAC,CAAC;;;;AAKd,QAAA,IAAI,OAAO,CAAC,KAAK,IAAI,SAAS,CAAC,KAAK,EAAE;AACrC,YAAA,KAAK,GAAG,YAAY,IAAI,CAAC,aAAa,CAAC;AACvC,SAAA;AAAM,aAAA;AACN,YAAA,KAAK,GAAG,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,eAAe,GAAG,CAAC,SAAS,CAAC,IAAI,GAAG,cAAc,CAAC,IAAI,IAAI,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC;AAC9F,SAAA;AAED,QAAA,IAAI,OAAO,CAAC,MAAM,IAAI,SAAS,CAAC,MAAM,EAAE;AACvC,YAAA,KAAK,GAAG,WAAW,IAAI,CAAC,cAAc,CAAC;AACvC,SAAA;AAAM,aAAA;AACN,YAAA,KAAK,GAAG,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,eAAe,GAAG,CAAC,SAAS,CAAC,GAAG,GAAG,cAAc,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC;AAC5F,SAAA;AAED,QAAA,IAAI,CAAC,mBAAmB,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC;QAElD,OAAO;AACN,YAAA,CAAC,EAAE,KAAK,CAAC,CAAC,GAAG,KAAK;AAClB,YAAA,CAAC,EAAE,KAAK,CAAC,CAAC,GAAG,KAAK;SAClB,CAAC;KACF;AAED;;;;AAIG;IACK,cAAc,CAAC,QAA2B,EAAE,WAAkB,EAAA;AACrE,QAAA,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;AACnC,QAAA,IAAI,CAAC,wBAAwB,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;AACrD,QAAA,IAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;QAElD,IAAI,QAAQ,CAAC,UAAU,EAAE;AACxB,YAAA,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;AAC3C,SAAA;;AAGD,QAAA,IAAI,CAAC,aAAa,GAAG,QAAQ,CAAC;;;;AAK9B,QAAA,IAAI,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,MAAM,EAAE;AAC3C,YAAA,MAAM,wBAAwB,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC7D,MAAM,WAAW,GAAG,IAAI,8BAA8B,CAAC,QAAQ,EAAE,wBAAwB,CAAC,CAAC;AAC3F,YAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AACxC,SAAA;AAED,QAAA,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;KAC9B;;AAGO,IAAA,mBAAmB,CAAC,QAA2B,EAAA;AACtD,QAAA,IAAI,CAAC,IAAI,CAAC,wBAAwB,EAAE;YACnC,OAAO;AACP,SAAA;AAED,QAAA,MAAM,QAAQ,GAA4B,IAAI,CAAC,YAAa,CAAC,gBAAgB,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;AAC7G,QAAA,IAAI,OAAoC,CAAC;AACzC,QAAA,MAAM,OAAO,GAAgC,QAAQ,CAAC,QAAQ,CAAC;AAE/D,QAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;YACnC,OAAO,GAAG,QAAQ,CAAC;AACnB,SAAA;AAAM,aAAA,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE;AACzB,YAAA,OAAO,GAAG,QAAQ,CAAC,QAAQ,KAAK,OAAO,GAAG,OAAO,GAAG,MAAM,CAAC;AAC3D,SAAA;AAAM,aAAA;AACN,YAAA,OAAO,GAAG,QAAQ,CAAC,QAAQ,KAAK,OAAO,GAAG,MAAM,GAAG,OAAO,CAAC;AAC3D,SAAA;AAED,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACzC,YAAA,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,eAAe,GAAG,CAAG,EAAA,OAAO,CAAI,CAAA,EAAA,OAAO,EAAE,CAAC;AAC5D,SAAA;KACD;AAED;;;;;AAKG;IACK,yBAAyB,CAAC,MAAa,EAAE,QAA2B,EAAA;AAC3E,QAAA,MAAM,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC;AACtC,QAAA,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;AAC5B,QAAA,IAAI,MAAc,CAAC;AACnB,QAAA,IAAI,GAAW,CAAC;AAChB,QAAA,IAAI,MAAc,CAAC;AAEnB,QAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,KAAK,EAAE;;AAEhC,YAAA,GAAG,GAAG,MAAM,CAAC,CAAC,CAAC;YACf,MAAM,GAAG,SAAS,CAAC,MAAM,GAAG,GAAG,GAAG,IAAI,CAAC,eAAe,CAAC;AACvD,SAAA;AAAM,aAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;;;;AAI1C,YAAA,MAAM,GAAG,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;YAChE,MAAM,GAAG,SAAS,CAAC,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC;AAC1D,SAAA;AAAM,aAAA;;;;;YAKN,MAAM,+BAA+B,GACpC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,GAAG,SAAS,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;AAEjE,YAAA,MAAM,cAAc,GAAG,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC;AAExD,YAAA,MAAM,GAAG,+BAA+B,GAAG,CAAC,CAAC;AAC7C,YAAA,GAAG,GAAG,MAAM,CAAC,CAAC,GAAG,+BAA+B,CAAC;AAEjD,YAAA,IAAI,MAAM,GAAG,cAAc,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;gBAC9E,GAAG,GAAG,MAAM,CAAC,CAAC,IAAI,cAAc,GAAG,CAAC,CAAC,CAAC;AACtC,aAAA;AACD,SAAA;;QAGD,MAAM,6BAA6B,GAClC,CAAC,QAAQ,CAAC,QAAQ,KAAK,OAAO,IAAI,CAAC,KAAK;aACvC,QAAQ,CAAC,QAAQ,KAAK,KAAK,IAAI,KAAK,CAAC,CAAC;;QAGxC,MAAM,4BAA4B,GACjC,CAAC,QAAQ,CAAC,QAAQ,KAAK,KAAK,IAAI,CAAC,KAAK;aACrC,QAAQ,CAAC,QAAQ,KAAK,OAAO,IAAI,KAAK,CAAC,CAAC;AAE1C,QAAA,IAAI,KAAa,CAAC;AAClB,QAAA,IAAI,IAAY,CAAC;AACjB,QAAA,IAAI,KAAa,CAAC;AAElB,QAAA,IAAI,4BAA4B,EAAE;AACjC,YAAA,KAAK,GAAG,SAAS,CAAC,KAAK,GAAG,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC;YAC1D,KAAK,GAAG,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC;AACxC,SAAA;AAAM,aAAA,IAAI,6BAA6B,EAAE;AACzC,YAAA,IAAI,GAAG,MAAM,CAAC,CAAC,CAAC;YAChB,KAAK,GAAG,SAAS,CAAC,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC;AACnC,SAAA;AAAM,aAAA;;;;;YAKN,MAAM,+BAA+B,GACpC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,KAAK,GAAG,MAAM,CAAC,CAAC,GAAG,SAAS,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;AACjE,YAAA,MAAM,aAAa,GAAG,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC;AAEtD,YAAA,KAAK,GAAG,+BAA+B,GAAG,CAAC,CAAC;AAC5C,YAAA,IAAI,GAAG,MAAM,CAAC,CAAC,GAAG,+BAA+B,CAAC;AAElD,YAAA,IAAI,KAAK,GAAG,aAAa,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;gBAC5E,IAAI,GAAG,MAAM,CAAC,CAAC,IAAI,aAAa,GAAG,CAAC,CAAC,CAAC;AACtC,aAAA;AACD,SAAA;;AAGD,QAAA,OAAO,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC;KACnD;AAED;;;;;;AAMG;IACK,qBAAqB,CAAC,MAAa,EAAE,QAA2B,EAAA;QACvE,MAAM,eAAe,GAAG,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;;;QAIzE,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;AACnD,YAAA,eAAe,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,MAAM,EAAE,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;AAC5F,YAAA,eAAe,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,KAAK,EAAE,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;AACzF,SAAA;QAED,MAAM,MAAM,GAAG,EAAyB,CAAC;AAEzC,QAAA,IAAI,IAAI,CAAC,iBAAiB,EAAE,EAAE;YAC7B,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,IAAI,GAAG,GAAG,CAAC;YAC/B,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,KAAK,GAAG,EAAE,CAAC;YAClC,MAAM,CAAC,KAAK,GAAG,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC;AACtC,SAAA;AAAM,aAAA;YACN,MAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,SAAS,CAAC;YACzD,MAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,QAAQ,CAAC;YAEvD,MAAM,CAAC,MAAM,GAAG,mBAAmB,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;YAC5D,MAAM,CAAC,GAAG,GAAG,mBAAmB,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;YACtD,MAAM,CAAC,MAAM,GAAG,mBAAmB,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;YAC5D,MAAM,CAAC,KAAK,GAAG,mBAAmB,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;YAC1D,MAAM,CAAC,IAAI,GAAG,mBAAmB,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;YACxD,MAAM,CAAC,KAAK,GAAG,mBAAmB,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;;AAG1D,YAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;AACnC,gBAAA,MAAM,CAAC,UAAU,GAAG,QAAQ,CAAC;AAC7B,aAAA;AAAM,iBAAA;AACN,gBAAA,MAAM,CAAC,UAAU,GAAG,QAAQ,CAAC,QAAQ,KAAK,KAAK,GAAG,UAAU,GAAG,YAAY,CAAC;AAC5E,aAAA;AAED,YAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;AACnC,gBAAA,MAAM,CAAC,cAAc,GAAG,QAAQ,CAAC;AACjC,aAAA;AAAM,iBAAA;AACN,gBAAA,MAAM,CAAC,cAAc,GAAG,QAAQ,CAAC,QAAQ,KAAK,QAAQ,GAAG,UAAU,GAAG,YAAY,CAAC;AACnF,aAAA;AAED,YAAA,IAAI,SAAS,EAAE;AACd,gBAAA,MAAM,CAAC,SAAS,GAAG,mBAAmB,CAAC,SAAS,CAAC,CAAC;AAClD,aAAA;AAED,YAAA,IAAI,QAAQ,EAAE;AACb,gBAAA,MAAM,CAAC,QAAQ,GAAG,mBAAmB,CAAC,QAAQ,CAAC,CAAC;AAChD,aAAA;AACD,SAAA;AAED,QAAA,IAAI,CAAC,oBAAoB,GAAG,eAAe,CAAC;QAE5C,YAAY,CAAC,IAAI,CAAC,YAAa,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;KAC/C;;IAGO,uBAAuB,GAAA;AAC9B,QAAA,YAAY,CAAC,IAAI,CAAC,YAAa,CAAC,KAAK,EAAE;AACtC,YAAA,GAAG,EAAE,GAAG;AACR,YAAA,IAAI,EAAE,GAAG;AACT,YAAA,KAAK,EAAE,GAAG;AACV,YAAA,MAAM,EAAE,GAAG;AACX,YAAA,MAAM,EAAE,EAAE;AACV,YAAA,KAAK,EAAE,EAAE;AACT,YAAA,UAAU,EAAE,EAAE;AACd,YAAA,cAAc,EAAE,EAAE;AACK,SAAA,CAAC,CAAC;KAC1B;;IAGO,0BAA0B,GAAA;AACjC,QAAA,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE;AAC9B,YAAA,GAAG,EAAE,EAAE;AACP,YAAA,IAAI,EAAE,EAAE;AACR,YAAA,MAAM,EAAE,EAAE;AACV,YAAA,KAAK,EAAE,EAAE;AACT,YAAA,QAAQ,EAAE,EAAE;AACZ,YAAA,SAAS,EAAE,EAAE;AACU,SAAA,CAAC,CAAC;KAC1B;;IAGO,wBAAwB,CAAC,WAAkB,EAAE,QAA2B,EAAA;QAC/E,MAAM,MAAM,GAAG,EAAyB,CAAC;AAEzC,QAAA,IAAI,IAAI,CAAC,iBAAiB,EAAE,EAAE;YAC7B,MAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,yBAAyB,EAAE,CAAC;AACvE,YAAA,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,WAAW,EAAE,cAAc,CAAC,CAAC,CAAC;AACpF,YAAA,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,WAAW,EAAE,cAAc,CAAC,CAAC,CAAC;AACpF,SAAA;AAAM,aAAA;AACN,YAAA,MAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC;AAC3B,SAAA;;;;;;QAOD,IAAI,eAAe,GAAG,EAAE,CAAC;QACzB,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;QAC/C,MAAM,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;AAE/C,QAAA,IAAI,OAAO,EAAE;AACZ,YAAA,eAAe,IAAI,CAAA,WAAA,EAAc,OAAO,CAAA,IAAA,CAAM,CAAC;AAC/C,SAAA;AAED,QAAA,IAAI,OAAO,EAAE;AACZ,YAAA,eAAe,IAAI,CAAA,WAAA,EAAc,OAAO,CAAA,GAAA,CAAK,CAAC;AAC9C,SAAA;AAED,QAAA,MAAM,CAAC,SAAS,GAAG,eAAe,CAAC,IAAI,EAAE,CAAC;;;;AAK1C,QAAA,IAAI,IAAI,CAAC,sBAAsB,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,SAAS,EAAE;AAC1E,YAAA,MAAM,CAAC,SAAS,GAAG,EAAE,CAAC;AACtB,SAAA;AAED,QAAA,IAAI,IAAI,CAAC,sBAAsB,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC,QAAQ,EAAE;AACzE,YAAA,MAAM,CAAC,QAAQ,GAAG,EAAE,CAAC;AACrB,SAAA;QAED,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;KACvC;;AAGO,IAAA,iBAAiB,CACxB,QAA2B,EAC3B,WAAkB,EAClB,cAAsC,EAAA;;;;QAKtC,MAAM,MAAM,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAyB,CAAC;AAClE,QAAA,IAAI,YAAY,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;QAEnF,IAAI,IAAI,CAAC,SAAS,EAAE;AACnB,YAAA,YAAY,GAAG,IAAI,CAAC,oBAAoB,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,EAAE,cAAc,EAAE,QAAQ,CAAC,CAAC;AACpG,SAAA;AAED,QAAA,MAAM,qBAAqB,GAAG,IAAI,CAAC,iBAAiB,CAAC,mBAAmB,EAAE,CAAC,qBAAqB,EAAE,CAAC,GAAG,CAAC;;;;;AAMvG,QAAA,YAAY,CAAC,CAAC,IAAI,qBAAqB,CAAC;;;AAIxC,QAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;;;YAGnC,MAAM,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,YAAY,CAAC;AACnE,YAAA,MAAM,CAAC,MAAM,GAAG,GAAG,cAAc,IAAI,YAAY,CAAC,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC;AACpF,SAAA;AAAM,aAAA;YACN,MAAM,CAAC,GAAG,GAAG,mBAAmB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;AACjD,SAAA;AAED,QAAA,OAAO,MAAM,CAAC;KACd;;AAGO,IAAA,iBAAiB,CACxB,QAA2B,EAC3B,WAAkB,EAClB,cAAsC,EAAA;;;;QAKtC,MAAM,MAAM,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAyB,CAAC;AAClE,QAAA,IAAI,YAAY,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;QAEnF,IAAI,IAAI,CAAC,SAAS,EAAE;AACnB,YAAA,YAAY,GAAG,IAAI,CAAC,oBAAoB,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,EAAE,cAAc,EAAE,QAAQ,CAAC,CAAC;AACpG,SAAA;;;;;AAMD,QAAA,IAAI,uBAAyC,CAAC;AAE9C,QAAA,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE;AAClB,YAAA,uBAAuB,GAAG,QAAQ,CAAC,QAAQ,KAAK,KAAK,GAAG,MAAM,GAAG,OAAO,CAAC;AACzE,SAAA;AAAM,aAAA;AACN,YAAA,uBAAuB,GAAG,QAAQ,CAAC,QAAQ,KAAK,KAAK,GAAG,OAAO,GAAG,MAAM,CAAC;AACzE,SAAA;;;QAID,IAAI,uBAAuB,KAAK,OAAO,EAAE;YACxC,MAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,WAAW,CAAC;AACjE,YAAA,MAAM,CAAC,KAAK,GAAG,GAAG,aAAa,IAAI,YAAY,CAAC,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,CAAC;AACjF,SAAA;AAAM,aAAA;YACN,MAAM,CAAC,IAAI,GAAG,mBAAmB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;AAClD,SAAA;AAED,QAAA,OAAO,MAAM,CAAC;KACd;AAED;;;AAGG;IACK,oBAAoB,GAAA;;AAE3B,QAAA,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QAC3C,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;QAEzD,MAAM,qBAAqB,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,UAAU,KAAI;YAClE,OAAO,UAAU,CAAC,aAAa,EAAE,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC;AACzE,SAAC,CAAC,CAAC;QAEH,OAAO;AACN,YAAA,eAAe,EAAE,2BAA2B,CAAC,YAAY,EAAE,qBAAqB,CAAC;AACjF,YAAA,mBAAmB,EAAE,4BAA4B,CAAC,YAAY,EAAE,qBAAqB,CAAC;AACtF,YAAA,gBAAgB,EAAE,2BAA2B,CAAC,aAAa,EAAE,qBAAqB,CAAC;AACnF,YAAA,oBAAoB,EAAE,4BAA4B,CAAC,aAAa,EAAE,qBAAqB,CAAC;SACxF,CAAC;KACF;;AAGO,IAAA,kBAAkB,CAAC,MAAc,EAAE,GAAG,SAAmB,EAAA;QAChE,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,YAAoB,EAAE,eAAuB,KAAI;YACzE,OAAO,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC;SACnD,EAAE,MAAM,CAAC,CAAC;KACX;AAEO,IAAA,gBAAgB,CAAC,SAAqC,EAAA;AAC7D,QAAA,MAAM,UAAU,GAAe,SAAS,CAAC,qBAAqB,EAAE,CAAC;;QAGjE,OAAO;AACN,YAAA,GAAG,EAAE,UAAU,CAAC,GAAG,GAAG,IAAI,CAAC,eAAe;AAC1C,YAAA,IAAI,EAAE,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC,eAAe;AAC5C,YAAA,KAAK,EAAE,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,eAAe;AAC9C,YAAA,MAAM,EAAE,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,eAAe;YAChD,KAAK,EAAE,UAAU,CAAC,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC;YACpD,MAAM,EAAE,UAAU,CAAC,MAAM,IAAI,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC;SACtD,CAAC;KACF;;IAGO,MAAM,GAAA;QACb,OAAO,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,KAAK,KAAK,CAAC;KACjD;;IAGO,iBAAiB,GAAA;QACxB,OAAO,CAAC,IAAI,CAAC,sBAAsB,IAAI,IAAI,CAAC,SAAS,CAAC;KACtD;;IAGO,UAAU,CAAC,QAA2B,EAAE,IAAe,EAAA;QAC9D,IAAI,IAAI,KAAK,GAAG,EAAE;;;AAGjB,YAAA,OAAO,QAAQ,CAAC,OAAO,IAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC;AACnE,SAAA;AAED,QAAA,OAAO,QAAQ,CAAC,OAAO,IAAI,IAAI,GAAG,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC;KACnE;;IAGO,kBAAkB,GAAA;AACzB,QAAA,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE;AACrC,YAAA,MAAM,KAAK,CAAC,uEAAuE,CAAC,CAAC;AACrF,SAAA;;;QAID,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC,IAAI,KAAI;AACzC,YAAA,0BAA0B,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;AACpD,YAAA,wBAAwB,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;AAClD,YAAA,0BAA0B,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;AACtD,YAAA,wBAAwB,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;AACrD,SAAC,CAAC,CAAC;KACH;;AAGO,IAAA,gBAAgB,CAAC,UAA6B,EAAA;QACrD,IAAI,IAAI,CAAC,KAAK,EAAE;YACf,WAAW,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC,QAAQ,KAAI;AAC5C,gBAAA,IAAI,QAAQ,KAAK,EAAE,IAAI,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE;AAC1E,oBAAA,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;oBACzC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AACnC,iBAAA;AACF,aAAC,CAAC,CAAC;AACH,SAAA;KACD;;IAGO,kBAAkB,GAAA;QACzB,IAAI,IAAI,CAAC,KAAK,EAAE;YACf,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC,QAAQ,KAAI;gBAC9C,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AACvC,aAAC,CAAC,CAAC;AACH,YAAA,IAAI,CAAC,oBAAoB,GAAG,EAAE,CAAC;AAC/B,SAAA;KACD;;IAGO,cAAc,GAAA;AACrB,QAAA,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;QAE5B,IAAI,MAAM,YAAY,UAAU,EAAE;AACjC,YAAA,OAAO,MAAM,CAAC,aAAa,CAAC,qBAAqB,EAAE,CAAC;AACpD,SAAA;QAED,IAAI,MAAM,YAAY,WAAW,EAAE;AAClC,YAAA,OAAO,MAAM,CAAC,qBAAqB,EAAE,CAAC;AACtC,SAAA;AAED,QAAA,MAAM,KAAK,GAAG,MAAM,CAAC,KAAK,IAAI,CAAC,CAAC;AAChC,QAAA,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,CAAC,CAAC;;;QAIlC,OAAO;YACN,GAAG,EAAE,MAAM,CAAC,CAAC;AACb,YAAA,MAAM,EAAE,MAAM,CAAC,CAAC,GAAG,MAAM;YACzB,IAAI,EAAE,MAAM,CAAC,CAAC;AACd,YAAA,KAAK,EAAE,MAAM,CAAC,CAAC,GAAG,KAAK;YACvB,MAAM;YACN,KAAK;SACL,CAAC;KACF;AACD,CAAA;AA8CD;AACA,SAAS,YAAY,CAAC,IAAyB,EAAE,MAA2B,EAAA;AAC3E,IAAA,KAAK,MAAM,GAAG,IAAI,MAAM,EAAE;AACzB,QAAA,IAAI,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;YAC/B,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;AACxB,SAAA;AACD,KAAA;AAED,IAAA,OAAO,IAAI,CAAC;AACb,CAAC;AAED;;;;;;AAMG;AACH,SAAS,4BAA4B,CAAC,OAAmB,EAAE,gBAA8B,EAAA;AACxF,IAAA,OAAO,gBAAgB,CAAC,IAAI,CAAC,CAAC,eAAe,KAAI;QAChD,OAAO,OAAO,CAAC,MAAM,GAAG,eAAe,CAAC,GAAG;AACvC,eAAA,OAAO,CAAC,GAAG,GAAG,eAAe,CAAC,MAAM;AACpC,eAAA,OAAO,CAAC,KAAK,GAAG,eAAe,CAAC,IAAI;eACpC,OAAO,CAAC,IAAI,GAAG,eAAe,CAAC,KAAK,CAAC;AAC1C,KAAC,CAAC,CAAC;AACJ,CAAC;AAED;;;;;;AAMG;AACH,SAAS,2BAA2B,CAAC,OAAmB,EAAE,gBAA8B,EAAA;AACvF,IAAA,OAAO,gBAAgB,CAAC,IAAI,CAAC,CAAC,mBAAmB,KAAI;QACpD,OAAO,OAAO,CAAC,GAAG,GAAG,mBAAmB,CAAC,GAAG;AACxC,eAAA,OAAO,CAAC,MAAM,GAAG,mBAAmB,CAAC,MAAM;AAC3C,eAAA,OAAO,CAAC,IAAI,GAAG,mBAAmB,CAAC,IAAI;eACvC,OAAO,CAAC,KAAK,GAAG,mBAAmB,CAAC,KAAK,CAAC;AAC/C,KAAC,CAAC,CAAC;AACJ,CAAC;AAED;AACM,SAAU,6CAA6C,CAC5D,aAA4B,EAC5B,QAAkB,EAClB,QAAkB,EAClB,gBAAkC,EAClC,oBAAoD,EAAA;IAEpD,OAAO,CAAC,MAAqC,KAA6B;AACzE,QAAA,OAAO,IAAI,uBAAuB,CACjC,MAAM,EACN,aAAa,EACb,QAAQ,EACR,QAAQ,EACR,gBAAgB,EAChB,oBAAoB,CACpB,CAAC;AACH,KAAC,CAAC;AACH,CAAC;AAED;AACO,MAAM,sDAAsD,GAAoB;AACtF,IAAA,OAAO,EAAE,qCAAqC;AAC9C,IAAA,UAAU,EAAE,6CAA6C;AACzD,IAAA,IAAI,EAAE;QACL,aAAa;QACb,QAAQ;QACR,QAAQ;QACR,gBAAgB;QAChB,8BAA8B;AAC9B,KAAA;CACD;;AC/qCD;;;;;;AAMG;AAmDH;AACO,MAAM,mBAAmB,GAAG,+BAA+B,CAAC;AAInE;;;AAGG;AACG,SAAU,8BAA8B,CAAC,QAAgB,EAAA;AAC9D,IAAA,OAAO,KAAK,CAAC,CAAA,kBAAA,EAAqB,QAAQ,CAAA,aAAA,CAAe,CAAC,CAAC;AAC5D,CAAC;AAUD;AACO,MAAM,mCAAmC,GAAG,IAAI,cAAc,CACpE,uBAAuB,EACvB,EAAE,UAAU,EAAE,MAAM,EAAE,OAAO,EAAE,2CAA2C,EAAE,CAC5E,CAAC;AAEF;SACgB,2CAA2C,GAAA;IAC1D,OAAO;AACN,QAAA,SAAS,EAAE,CAAC;AACZ,QAAA,SAAS,EAAE,CAAC;AACZ,QAAA,iBAAiB,EAAE,IAAI;KACvB,CAAC;AACH,CAAC;MAQY,OAAO,CAAA;AAwGnB,IAAA,WAAA,CACW,QAAiB,EACjB,WAAoC,EACpC,iBAAmC,EACnC,iBAAmC,EACnC,OAAe,EACzB,QAAkB,EACR,cAA6B,EAC7B,aAA2B,EACnB,QAAa,EACc,cAAmB,EACjB,gBAAqB,EACrB,UAAsC,EAC/D,IAAoB,EAEhC,eAAsC,EACb,YAA2B,EAAA;QAfpD,IAAQ,CAAA,QAAA,GAAR,QAAQ,CAAS;QACjB,IAAW,CAAA,WAAA,GAAX,WAAW,CAAyB;QACpC,IAAiB,CAAA,iBAAA,GAAjB,iBAAiB,CAAkB;QACnC,IAAiB,CAAA,iBAAA,GAAjB,iBAAiB,CAAkB;QACnC,IAAO,CAAA,OAAA,GAAP,OAAO,CAAQ;QAEf,IAAc,CAAA,cAAA,GAAd,cAAc,CAAe;QAC7B,IAAa,CAAA,aAAA,GAAb,aAAa,CAAc;QAIU,IAAU,CAAA,UAAA,GAAV,UAAU,CAA4B;QAC/D,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAgB;QAEhC,IAAe,CAAA,eAAA,GAAf,eAAe,CAAuB;QAlHvC,IAAS,CAAA,SAAA,GAAoB,OAAO,CAAC;QACrC,IAAe,CAAA,eAAA,GAA0B,MAAM,CAAC;QAChD,IAAS,CAAA,SAAA,GAAY,KAAK,CAAC;QAI9B,IAAW,CAAA,WAAA,GAA2B,gBAAgB,CAAC;;AAoD9D,QAAA,IAAA,CAAA,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC;;AAG3C,QAAA,IAAA,CAAA,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC;AA+BjC,QAAA,IAAA,CAAA,gBAAgB,GAAG,IAAI,GAAG,EAA8C,CAAC;;AAGhE,QAAA,IAAA,CAAA,UAAU,GAAG,IAAI,OAAO,EAAQ,CAAC;AAsBnD,QAAA,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;AAC1B,QAAA,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC;AACtC,QAAA,IAAI,CAAC,iBAAiB,GAAG,gBAAgB,CAAC;AAC1C,QAAA,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,YAA4B,CAAC,CAAC;AAEzD,QAAA,IAAI,eAAe,IAAI,eAAe,CAAC,QAAQ,EAAE;AAChD,YAAA,IAAI,CAAC,QAAQ,GAAG,eAAe,CAAC,QAAQ,CAAC;AACzC,SAAA;KACD;IArHD,IAAW,eAAe,KAA8B,OAAO,IAAI,CAAC,gBAAgB,CAAC,EAAE;;IAGvF,IAAI,QAAQ,KAAsB,OAAO,IAAI,CAAC,SAAS,CAAC,EAAE;IAC1D,IAAI,QAAQ,CAAC,KAAsB,EAAA;AAClC,QAAA,IAAI,KAAK,KAAK,IAAI,CAAC,SAAS,EAAE;AAC7B,YAAA,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YAEvB,IAAI,IAAI,CAAC,WAAW,EAAE;gBACrB,IAAI,CAAC,eAAe,EAAE,CAAC;gBAEvB,IAAI,IAAI,CAAC,gBAAgB,EAAE;AAC1B,oBAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAC9B,iBAAA;AAED,gBAAA,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC;AAClC,aAAA;AACD,SAAA;KACD;;IAGD,IAAI,cAAc,KAA4B,OAAO,IAAI,CAAC,eAAe,CAAC,EAAE;IAC5E,IAAI,cAAc,CAAC,KAA4B,EAAA;AAC9C,QAAA,IAAI,KAAK,KAAK,IAAI,CAAC,eAAe,EAAE;AACnC,YAAA,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;YAE7B,IAAI,IAAI,CAAC,WAAW,EAAE;gBACrB,IAAI,CAAC,eAAe,EAAE,CAAC;gBAEvB,IAAI,IAAI,CAAC,gBAAgB,EAAE;AAC1B,oBAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAC9B,iBAAA;AAED,gBAAA,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC;AAClC,aAAA;AACD,SAAA;KACD;;IAGD,IAAI,QAAQ,KAAc,OAAO,IAAI,CAAC,SAAS,CAAC,EAAE;IAClD,IAAI,QAAQ,CAAC,KAAK,EAAA;AACjB,QAAA,IAAI,CAAC,SAAS,GAAG,qBAAqB,CAAC,KAAK,CAAC,CAAC;;QAG9C,IAAI,IAAI,CAAC,SAAS,EAAE;AACnB,YAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACb,SAAA;KACD;;IAWD,IAAI,OAAO,KAAwB,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAE;IAC1D,IAAI,OAAO,CAAC,KAAwB,EAAA;AACnC,QAAA,IAAI,OAAO,IAAI,CAAC,QAAQ,KAAK,QAAQ,EAAE;AACtC,YAAA,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;AACrF,SAAA;AAED,QAAA,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QAEtB,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,gBAAgB,EAAE,EAAE;AAC9C,YAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACb,SAAA;AAAM,aAAA;YACN,IAAI,CAAC,cAAc,EAAE,CAAC;AACtB,YAAA,IAAI,OAAO,IAAI,CAAC,QAAQ,KAAK,QAAQ,EAAE;AACtC,gBAAA,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,MAAK;;;;;AAKnC,oBAAA,OAAO,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,MAAK;AAC3B,wBAAA,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,CAAC,QAAkB,CAAC,CAAC;AACvF,qBAAC,CAAC,CAAC;AACJ,iBAAC,CAAC,CAAC;AACH,aAAA;AACD,SAAA;KACD;AAqCD;;AAEG;IACH,QAAQ,GAAA;AACP,QAAA,MAAM,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC;AAC/C,QAAA,MAAM,YAAY,GAAG,OAAO,CAAC,KAAyD,CAAC;QAEvF,IAAI,OAAO,CAAC,QAAQ,KAAK,OAAO,IAAI,OAAO,CAAC,QAAQ,KAAK,UAAU,EAAE;;;;;;;AAQpE,YAAA,YAAY,CAAC,gBAAgB,GAAG,YAAY,CAAC,UAAU,CAAC;AACxD,SAAA;;;;QAKD,IAAI,OAAO,CAAC,SAAS,IAAI,YAAY,CAAC,cAAc,KAAK,MAAM,EAAE;AAChE,YAAA,YAAY,CAAC,cAAc,GAAG,EAAE,CAAC;AACjC,SAAA;KACD;AAED;;AAEG;IACH,WAAW,GAAA;QACV,IAAI,IAAI,CAAC,WAAW,EAAE;AACrB,YAAA,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;AAC3B,YAAA,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;AAC7B,SAAA;;QAGD,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,KAAK,KAAI;YACjD,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,mBAAmB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;AACrE,SAAC,CAAC,CAAC;AACH,QAAA,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;AAE9B,QAAA,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;AACvB,QAAA,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;AAE3B,QAAA,IAAI,OAAO,IAAI,CAAC,OAAO,KAAK,QAAQ,EAAE;AACrC,YAAA,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;AACpF,SAAA;QACD,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;KACpD;;AAGM,IAAA,IAAI,CAAC,KAAA,GAAgB,IAAI,CAAC,SAAS,EAAA;QACzC,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,UAAU,CAAC,EAAE;YACtG,OAAO;AACP,SAAA;AAED,QAAA,MAAM,UAAU,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;QAEzC,IAAI,CAAC,OAAO,EAAE,CAAC;AACf,QAAA,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,eAAe,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;AAC7F,QAAA,IAAI,CAAC,gBAAgB,GAAG,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC;QACjE,IAAI,CAAC,gBAAgB,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;AACjD,QAAA,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE;AACjC,aAAA,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;QAClC,IAAI,CAAC,cAAc,EAAE,CAAC;AACtB,QAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAClC;;AAGM,IAAA,IAAI,CAAC,KAAA,GAAgB,IAAI,CAAC,SAAS,EAAA;QACzC,IAAI,IAAI,CAAC,gBAAgB,EAAE;AAC1B,YAAA,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAClC,SAAA;KACD;;IAGM,MAAM,GAAA;AACZ,QAAA,IAAI,CAAC,gBAAgB,EAAE,GAAG,IAAI,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;KACpD;;IAGM,gBAAgB,GAAA;AACtB,QAAA,OAAO,CAAC,CAAC,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC;KACpE;;AAGM,IAAA,aAAa,CAAC,CAAgB,EAAA;AACpC,QAAA,IAAI,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC,OAAO,KAAK,MAAM,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE;YAC1E,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,CAAC,CAAC,eAAe,EAAE,CAAC;AACpB,YAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACb,SAAA;KACD;;IAGM,cAAc,GAAA;QACpB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,CAAC;KAClD;;IAGS,cAAc,GAAA;QACvB,IAAI,IAAI,CAAC,WAAW,EAAE;YACrB,OAAO,IAAI,CAAC,WAAW,CAAC;AACxB,SAAA;AAED,QAAA,MAAM,mBAAmB,GACxB,IAAI,CAAC,iBAAiB,CAAC,2BAA2B,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;;QAGtE,MAAM,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC;AACvD,aAAA,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC;aAC9B,wBAAwB,CAAC,mBAAmB,CAAC,CAAC;AAEhD,QAAA,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,MAAM,KAAI;YAC9E,IAAI,IAAI,CAAC,gBAAgB,EAAE;AAC1B,gBAAA,IAAI,MAAM,CAAC,wBAAwB,CAAC,gBAAgB,IAAI,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,EAAE;;;AAG1F,oBAAA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;AACrC,iBAAA;AAAM,qBAAA,IAAI,IAAI,CAAC,eAAe,KAAK,MAAM,EAAE;;oBAE3C,IAAI,MAAM,CAAC,cAAc,KAAK,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE;AAC7D,wBAAA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,IAAI,CAAC,gBAAiB,CAAC,QAAQ,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC;AAChF,qBAAA;AACD,iBAAA;AACD,aAAA;AACF,SAAC,CAAC,CAAC;AAEH,QAAA,MAAM,WAAW,GAAY,IAAI,CAAC,WAAW,KAAK,gBAAgB,CAAC;QAEnE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;YACvC,SAAS,EAAE,IAAI,CAAC,IAAI;AACpB,YAAA,gBAAgB,EAAE,QAAQ;AAC1B,YAAA,UAAU,EAAE,mBAAmB;AAC/B,YAAA,cAAc,EAAE,IAAI,CAAC,eAAe,EAAE;YACtC,WAAW;AACX,YAAA,aAAa,EAAE,CAAC,sBAAsB,EAAE,2BAA2B,CAAC;AACpE,SAAA,CAAC,CAAC;QAEH,IAAI,CAAC,eAAe,EAAE,CAAC;AAEvB,QAAA,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE;AAC5B,aAAA,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;QAElC,OAAO,IAAI,CAAC,WAAW,CAAC;KACxB;;IAGS,OAAO,GAAA;QAChB,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,EAAE;AACvD,YAAA,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;AAC1B,SAAA;AAED,QAAA,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;KAC7B;;IAGS,eAAe,GAAA;AACxB,QAAA,IAAI,aAAmC,CAAC;AAExC,QAAA,IAAI,IAAI,CAAC,eAAe,KAAK,MAAM,EAAE;YACpC,aAAa,GAAG,EAAE,aAAa,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC;AAClD,SAAA;AAAM,aAAA;AACN,YAAA,MAAM,GAAG,GAAW,UAAU,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC,QAAQ,CAAC,CAAC;AAC1F,YAAA,aAAa,GAAG,EAAE,aAAa,EAAE,GAAG,GAAG,KAAK,EAAE,QAAQ,EAAE,GAAG,GAAG,GAAG,EAAE,CAAC;AACpE,SAAA;QAED,MAAM,SAAS,GAAwB,uBAAuB,CAC7D,IAAI,CAAC,UAAU,EAAE,EACjB,IAAI,CAAC,mBAAmB,EAAE,EAC1B,IAAI,CAAC,eAAe,EACpB,aAAa,CACb,CAAC;AAED,QAAA,IAAI,CAAC,WAAY,CAAC,SAAS,EAAE,CAAC,gBAA4C,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;KACrG;;IAGM,qBAAqB,GAAA;QAC3B,IAAI,IAAI,CAAC,WAAW,EAAE;AACrB,YAAA,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,CAAC;AAClC,SAAA;KACD;AAED;;;AAGG;IACO,UAAU,GAAA;AACnB,QAAA,MAAM,KAAK,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,KAAK,KAAK,CAAC;AACtD,QAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC/B,QAAA,IAAI,cAAwC,CAAC;AAE7C,QAAA,IAAI,QAAQ,KAAK,OAAO,IAAI,QAAQ,KAAK,OAAO,EAAE;YACjD,cAAc,GAAG,EAAE,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,KAAK,OAAO,GAAG,KAAK,GAAG,QAAQ,EAAE,CAAC;AACzF,SAAA;aAAM,IACN,QAAQ,KAAK,QAAQ;AACrB,aAAC,QAAQ,KAAK,MAAM,IAAI,KAAK,CAAC;AAC9B,aAAC,QAAQ,KAAK,OAAO,IAAI,CAAC,KAAK,CAAC,EAAE;YAClC,cAAc,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC;AACzD,SAAA;aAAM,IACN,QAAQ,KAAK,OAAO;AACpB,aAAC,QAAQ,KAAK,OAAO,IAAI,KAAK,CAAC;AAC/B,aAAC,QAAQ,KAAK,MAAM,IAAI,CAAC,KAAK,CAAC,EAAE;YACjC,cAAc,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC;AACvD,SAAA;AAAM,aAAA;AACN,YAAA,MAAM,8BAA8B,CAAC,QAAQ,CAAC,CAAC;AAC/C,SAAA;AAED,QAAA,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,OAAO,EAAE,cAAc,CAAC,OAAO,CAAC,CAAC;QAEtF,OAAO;AACN,YAAA,IAAI,EAAE,cAAc;YACpB,QAAQ,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE;SACpC,CAAC;KACF;;IAGS,mBAAmB,GAAA;AAC5B,QAAA,MAAM,KAAK,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,KAAK,KAAK,CAAC;AACtD,QAAA,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AAC/B,QAAA,IAAI,eAA0C,CAAC;QAE/C,IAAI,QAAQ,KAAK,OAAO,EAAE;YACzB,eAAe,GAAG,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC;AAC7D,SAAA;aAAM,IAAI,QAAQ,KAAK,OAAO,EAAE;YAChC,eAAe,GAAG,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;AAC1D,SAAA;aAAM,IACN,QAAQ,KAAK,QAAQ;AACrB,aAAC,QAAQ,KAAK,MAAM,IAAI,KAAK,CAAC;AAC9B,aAAC,QAAQ,KAAK,OAAO,IAAI,CAAC,KAAK,CAAC,EAAE;YAClC,eAAe,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC;AAC1D,SAAA;aAAM,IACN,QAAQ,KAAK,OAAO;AACpB,aAAC,QAAQ,KAAK,OAAO,IAAI,KAAK,CAAC;AAC/B,aAAC,QAAQ,KAAK,MAAM,IAAI,CAAC,KAAK,CAAC,EAAE;YACjC,eAAe,GAAG,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC;AAC5D,SAAA;AAAM,aAAA;AACN,YAAA,MAAM,8BAA8B,CAAC,QAAQ,CAAC,CAAC;AAC/C,SAAA;AAED,QAAA,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,QAAQ,EAAE,eAAe,CAAC,QAAQ,CAAC,CAAC;QAE1F,OAAO;AACN,YAAA,IAAI,EAAE,eAAe;YACrB,QAAQ,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE;SACtC,CAAC;KACF;;IAGS,cAAc,GAAA;;;QAGvB,IAAI,IAAI,CAAC,gBAAgB,EAAE;YAC1B,IAAI,CAAC,gBAAgB,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;AAC7C,YAAA,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC;YAErC,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC,IAAI,CAChD,IAAI,CAAC,CAAC,CAAC,EACP,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAC1B,CAAC,SAAS,CAAC,MAAK;gBAChB,IAAI,IAAI,CAAC,gBAAgB,EAAE;AAC1B,oBAAA,IAAI,CAAC,WAAY,CAAC,cAAc,EAAE,CAAC;AACnC,iBAAA;AACF,aAAC,CAAC,CAAC;AACH,SAAA;KACD;;IAGO,eAAe,CAAC,CAA0B,EAAE,CAAwB,EAAA;QAC3E,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,IAAI,IAAI,CAAC,QAAQ,KAAK,OAAO,EAAE;YAC3D,IAAI,CAAC,KAAK,KAAK,EAAE;gBAChB,CAAC,GAAG,QAAQ,CAAC;AACb,aAAA;iBAAM,IAAI,CAAC,KAAK,QAAQ,EAAE;gBAC1B,CAAC,GAAG,KAAK,CAAC;AACV,aAAA;AACD,SAAA;AAAM,aAAA;YACN,IAAI,CAAC,KAAK,KAAK,EAAE;gBAChB,CAAC,GAAG,OAAO,CAAC;AACZ,aAAA;iBAAM,IAAI,CAAC,KAAK,OAAO,EAAE;gBACzB,CAAC,GAAG,KAAK,CAAC;AACV,aAAA;AACD,SAAA;AAED,QAAA,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;KAChB;;AAGS,IAAA,WAAW,CAAC,QAAkB,EAAE,YAA0B,KAAW;;oGAtanE,OAAO,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAAA,IAAA,CAAA,OAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,UAAA,EAAA,EAAA,EAAA,KAAA,EAAAC,IAAA,CAAA,gBAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,gBAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,MAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,QAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,aAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,YAAA,EAAA,EAAA,EAAA,KAAA,EAiHV,QAAQ,EAAA,EAAA,EAAA,KAAA,EACR,mCAAmC,EAAA,EAAA,EAAA,KAAA,EACnC,qCAAqC,EAAA,EAAA,EAAA,KAAA,EACrC,6BAA6B,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,cAAA,EAAA,QAAA,EAAA,IAAA,EAAA,EAAA,EAAA,KAAA,EAEjB,mCAAmC,EAAA,QAAA,EAAA,IAAA,EAAA,EAAA,EAAA,KAAA,EAEnC,aAAa,EAAA,QAAA,EAAA,IAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;wFAxHtB,OAAO,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA;2FAAP,OAAO,EAAA,UAAA,EAAA,CAAA;kBADnB,SAAS;;0BAkHP,MAAM;2BAAC,QAAQ,CAAA;;0BACf,MAAM;2BAAC,mCAAmC,CAAA;;0BAC1C,MAAM;2BAAC,qCAAqC,CAAA;;0BAC5C,MAAM;2BAAC,6BAA6B,CAAA;;0BACpC,QAAQ;;0BACR,QAAQ;;0BAAI,MAAM;2BAAC,mCAAmC,CAAA;;0BAEtD,QAAQ;;0BAAI,MAAM;2BAAC,aAAa,CAAA;;AAiTnC;AACO,MAAM,mCAAmC,GAAwB;AACvE,IAAA,OAAO,EAAE,OAAO;AAChB,IAAA,IAAI,EAAE;QACL,OAAO;QACP,UAAU;QACV,gBAAgB;QAChB,gBAAgB;QAChB,MAAM;QACN,QAAQ;QACR,aAAa;QACb,YAAY;QACZ,QAAQ;QACR,mCAAmC;QACnC,qCAAqC;QACrC,6BAA6B;AAC7B,QAAA,CAAC,IAAI,QAAQ,EAAE,EAAE,cAAc,CAAC;AAChC,QAAA,CAAC,IAAI,QAAQ,EAAE,EAAE,mCAAmC,CAAC;AACrD,QAAA,CAAC,IAAI,QAAQ,EAAE,EAAE,aAAa,CAAC;AAC/B,KAAA;CACD,CAAC;AAOF,SAAS,uBAAuB,CAC/B,MAAqD,EACrD,OAAuD,EACvD,cAAqC,EACrC,OAA6B,EAAA;AAE7B,IAAA,MAAM,IAAI,GAAsB,EAAE,GAAG,MAAM,CAAC,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,EAAE,CAAC;AACpE,IAAA,MAAM,QAAQ,GAAsB,EAAE,GAAG,MAAM,CAAC,QAAQ,EAAE,GAAG,OAAO,CAAC,QAAQ,EAAE,CAAC;AAEhF,IAAA,MAAM,SAAS,GAAwB;AACtC,QAAA,GAAG,uBAAuB,CAAC,IAAI,EAAE,cAAc,CAAC;AAChD,QAAA,GAAG,uBAAuB,CAAC,QAAQ,EAAE,cAAc,CAAC;KACpD,CAAC;;AAGF,IAAA,SAAS,CAAC,OAAO,CAAC,CAAC,QAAQ,KAAI;AAC9B,QAAA,IAAI,QAAQ,CAAC,OAAO,KAAK,QAAQ,EAAE;AAClC,YAAA,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC,aAAa,GAAG,iCAAiC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AAE/F,YAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;AACnC,gBAAA,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC,QAAQ,GAAG,iCAAiC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAC3F,aAAA;AACD,SAAA;AAAM,aAAA,IAAI,QAAQ,CAAC,OAAO,KAAK,QAAQ,EAAE;AACzC,YAAA,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC,aAAa,GAAG,iCAAiC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AAE/F,YAAA,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,EAAE;AACnC,gBAAA,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC,QAAQ,GAAG,iCAAiC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;AAC3F,aAAA;AACD,SAAA;AACF,KAAC,CAAC,CAAC;AAEH,IAAA,OAAO,SAAS,CAAC;AAClB,CAAC;AAED,MAAM,iCAAiC,GAAG;IACzC,GAAG,EAAE,CAAC,CAAC;AACP,IAAA,MAAM,EAAE,CAAC;IACT,KAAK,EAAE,CAAC,CAAC;AACT,IAAA,GAAG,EAAE,CAAC;CACN,CAAC;AAEF;AACA;AACA,SAAS,uBAAuB,CAC/B,QAA2B,EAC3B,cAAqC,EAAA;IAErC,IAAI,cAAc,KAAK,MAAM,EAAE;QAC9B,OAAO,CAAC,QAAQ,CAAC,CAAC;AAClB,KAAA;AACD,IAAA,IAAI,QAAQ,CAAC,OAAO,KAAK,QAAQ,EAAE;QAClC,IAAI,cAAc,KAAK,MAAM,EAAE;YAC9B,OAAO;gBACN,QAAQ;AACR,gBAAA,EAAE,GAAG,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE;AAClC,gBAAA,EAAE,GAAG,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE;aAChC,CAAC;AACF,SAAA;AAAM,aAAA;YACN,OAAO;AACN,gBAAA,EAAE,GAAG,QAAQ,EAAE,QAAQ,EAAE,cAAc,EAAE;aACzC,CAAC;AACF,SAAA;AACD,KAAA;AAAM,SAAA;QACN,IAAI,cAAc,KAAK,MAAM,EAAE;YAC9B,OAAO;gBACN,QAAQ;AACR,gBAAA,EAAE,GAAG,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE;AACnC,gBAAA,EAAE,GAAG,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE;aAChC,CAAC;AACF,SAAA;AAAM,aAAA;YACN,OAAO;AACN,gBAAA,EAAE,GAAG,QAAQ,EAAE,QAAQ,EAAE,cAAc,KAAK,OAAO,GAAG,KAAK,GAAG,QAAQ,EAAE;aACxE,CAAC;AACF,SAAA;AACD,KAAA;AACF;;MC1mBa,wBAAwB,CAAA;AACpC,IAAA,WAAA,CACkB,SAAmB,EAAA;QAAnB,IAAS,CAAA,SAAA,GAAT,SAAS,CAAU;KAChC;IAEE,aAAa,CACnB,UAAsB,EACtB,MAAgC,EAAA;AAEhC,QAAA,MAAM,SAAS,GAAqB;YACnC,mCAAmC;AACnC,YAAA,EAAE,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,UAAU,EAAE;SAC7C,CAAC;AAEF,QAAA,IAAI,MAAM,EAAE;YACX,IAAI,MAAM,CAAC,GAAG,EAAE;AACf,gBAAA,SAAS,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,QAAQ,EAAE,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC;AACpE,aAAA;AACD,SAAA;AAED,QAAA,MAAM,QAAQ,GAAe,QAAQ,CAAC,MAAM,CAAC;YAC5C,SAAS;YACT,MAAM,EAAE,IAAI,CAAC,SAAS;AACtB,SAAA,CAAC,CAAC,GAAG,CAAC,OAAO,CAAe,CAAC;;QAG9B,QAAQ,CAAC,QAAQ,EAAE,CAAC;AAEpB,QAAA,OAAO,QAAQ,CAAC;KAChB;;qHA7BW,wBAAwB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,QAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;yHAAxB,wBAAwB,EAAA,CAAA,CAAA;2FAAxB,wBAAwB,EAAA,UAAA,EAAA,CAAA;kBADpC,UAAU;;;MCLE,mBAAmB,CAAA;IAI/B,WACiB,CAAA,aAAqB,EACrB,KAAuB,EAAA;QADvB,IAAa,CAAA,aAAA,GAAb,aAAa,CAAQ;QACrB,IAAK,CAAA,KAAA,GAAL,KAAK,CAAkB;QAJjC,IAAW,CAAA,WAAA,GAAW,CAAC,CAAC;QAM9B,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,KAAI;;YAE3B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC;YAE3C,IAAI,IAAI,CAAC,WAAW,EAAE;gBACrB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,OAAO,KAAI;;oBAEjC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,IAAI,CAAC;AAClD,iBAAC,CAAC,CAAC;AACH,aAAA;AACF,SAAC,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;KAChC;AAED;;AAEG;IACI,WAAW,GAAA;AACjB,QAAA,MAAM,YAAY,GAAmB,IAAI,CAAC,UAAU,CAAC;QACrD,GAAG;YACF,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,EAAE;gBACrC,IAAI,CAAC,WAAW,EAAE,CAAC;gBACnB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AAC/C,aAAA;AAAM,iBAAA;AACN,gBAAA,OAAO,YAAY,CAAC;AACpB,aAAA;AACD,SAAA,QAAQ,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE;QAEjC,OAAO,IAAI,CAAC,UAAU,CAAC;;;;;;KAQvB;AAED;;AAEG;IACI,cAAc,GAAA;AACpB,QAAA,IAAI,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE;YAChC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;AAC9C,SAAA;AAAM,aAAA,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE;YAClC,MAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC;AACjD,YAAA,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;AAClE,SAAA;QACD,OAAO,IAAI,CAAC,UAAU,CAAC;KACvB;AAED;;AAEG;IACI,eAAe,GAAA;AACrB,QAAA,MAAM,YAAY,GAAmB,IAAI,CAAC,UAAU,CAAC;QACrD,GAAG;YACF,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,EAAE;gBACrC,IAAI,CAAC,WAAW,EAAE,CAAC;gBACnB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AAC/C,aAAA;AAAM,iBAAA;AACN,gBAAA,OAAO,YAAY,CAAC;AACpB,aAAA;AACD,SAAA,QAAQ,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE;QAEjC,OAAO,IAAI,CAAC,UAAU,CAAC;;;;;;KAQvB;AAED;;AAEG;IACI,kBAAkB,GAAA;QACxB,MAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,MAAO,CAAC,QAAQ,CAAC;AAClD,QAAA,MAAM,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;AACvD,QAAA,IAAI,QAAQ,CAAC,QAAQ,CAAC,EAAE;AACvB,YAAA,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,QAAQ,CAAC,CAAC;AACrC,SAAA;AAAM,aAAA,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE;YAClC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC;AACzC,SAAA;QACD,OAAO,IAAI,CAAC,UAAU,CAAC;KACvB;AACD;;ACvFD;;AAEG;AACH,IAAK,OAGJ,CAAA;AAHD,CAAA,UAAK,OAAO,EAAA;AACV,IAAA,OAAA,CAAA,WAAA,CAAA,GAAA,WAAuB,CAAA;AACvB,IAAA,OAAA,CAAA,QAAA,CAAA,GAAA,QAAiB,CAAA;AACnB,CAAC,EAHI,OAAO,KAAP,OAAO,GAGX,EAAA,CAAA,CAAA,CAAA;AAED,MAAM,mBAAmB,GAAW,CAAA,mCAAA,CAAqC,CAAC;AAE1E;;AAEG;MAEU,iBAAiB,CAAA;IA+B5B,WACmB,CAAA,SAAmB,EACpC,eAAiC,EAAA;QADhB,IAAS,CAAA,SAAA,GAAT,SAAS,CAAU;AA/BrB,QAAA,IAAA,CAAA,WAAW,GAAG,IAAI,OAAO,EAAU,CAAC;;AAEpC,QAAA,IAAA,CAAA,KAAK,GAAG,IAAI,GAAG,EAAyB,CAAC;AACzC,QAAA,IAAA,CAAA,MAAM,GAAG,IAAI,GAAG,EAAiC,CAAC;;;AAS3D,QAAA,IAAA,CAAA,QAAQ,GAAY,KAAK,CAAC;;AAMlB,QAAA,IAAA,CAAA,WAAW,GAAG,IAAI,eAAe,CAAC,KAAK,CAAC,CAAC;AAElD,QAAA,IAAA,CAAA,OAAO,GAAG,IAAI,OAAO,EAAmB,CAAC;QAc9C,IAAI,CAAC,eAAe,GAAG,IAAI,wBAAwB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACpE,IAAI,CAAC,SAAS,GAAG,eAAe,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;AAE5D;;;AAGG;AACH,QAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CACZ,OAAO,CAAC,MAAM,EACd,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,KAAK,KAAI;YAC/B,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;AAC/B,gBAAA,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,mBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAC9D,aAAA;SACF,CAAC,CACH,CAAC;KACH;AA3BD,IAAA,IAAW,UAAU,GAAA;AACnB,QAAA,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;KAC/B;AAED,IAAA,IAAW,SAAS,GAAA;QAClB,OAAO,IAAI,CAAC,UAAU,CAAC;KACxB;IAuBD,WAAW,GAAA;AACT,QAAA,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;AAC5B,QAAA,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;AAE/B,QAAA,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;AAC5B,QAAA,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;AAE/B,QAAA,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;AACxB,QAAA,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;AAE3B,QAAA,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK,GAAG,CAAC,WAAW,EAAE,CAAC,CAAC;KAChD;AAED;;;AAGG;AACI,IAAA,YAAY,CAAC,IAA2B,EAAA;AAC7C,QAAA,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;AACtC,YAAA,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;AACzC,SAAA;QACD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;KACzC;AAED;;;AAGG;AACI,IAAA,cAAc,CAAC,IAA2B,EAAA;QAC/C,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE;YACnF,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AACtC,SAAA;KACF;AAED;;;;AAIG;IACI,KAAK,CAAC,aAAqB,EAAE,KAAuB,EAAA;AACzD,QAAA,aAAa,GAAG,aAAa,GAAG,aAAa,GAAG,GAAG,GAAG,EAAE,CAAC;AACzD,QAAA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC5B,QAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;YAChB,IAAI,EAAE,mBAAmB,CAAC,KAAK;AAC/B,YAAA,IAAI,EAAE,aAAa;YACnB,MAAM,EAAE,qBAAqB,CAAC,MAAM;AACrC,SAAA,CAAC,CAAC;QACH,IAAI,CAAC,UAAU,GAAG,IAAI,mBAAmB,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;QAChE,IAAI,CAAC,SAAS,EAAE,CAAC;KAClB;AAED;;AAEG;IACI,KAAK,GAAA;QACV,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,QAAQ,EAAE,CAAC;AACjB,SAAA;KACF;AAED;;AAEG;IACI,MAAM,GAAA;QACX,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,SAAS,EAAE,CAAC;AAClB,SAAA;KACF;AAED;;;AAGG;AACI,IAAA,UAAU,CAAC,MAAA,GAAgC,qBAAqB,CAAC,MAAM,EAAA;QAC5E,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;AAC5C,YAAA,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,MAAwB,CAAC;AAC/E,YAAA,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,CAAC,CAAC;AACpD,SAAA;KACF;AAED;;;AAGG;AACI,IAAA,IAAI,CAAC,MAAA,GAAgC,qBAAqB,CAAC,MAAM,EAAA;QACtE,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;AAC5C,YAAA,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;AAC9B,YAAA,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,mBAAmB,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;AAClE,SAAA;KACF;AAED;;;AAGG;AACI,IAAA,IAAI,CAAC,MAAA,GAAgC,qBAAqB,CAAC,MAAM,EAAA;QACtE,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;AAC5C,YAAA,IAAI,CAAC,UAAU,CAAC,eAAe,EAAE,CAAC;AAClC,YAAA,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,mBAAmB,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;AAClE,SAAA;KACF;AAED;;;AAGG;AACI,IAAA,WAAW,CAAC,MAAA,GAAgC,qBAAqB,CAAC,MAAM,EAAA;QAC7E,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;AAC5C,YAAA,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE,CAAC;AACjC,YAAA,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;AAC9C,SAAA;KACF;AAED;;;AAGG;AACI,IAAA,eAAe,CAAC,MAAA,GAAgC,qBAAqB,CAAC,MAAM,EAAA;QACjF,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;AAC5C,YAAA,IAAI,CAAC,UAAU,CAAC,kBAAkB,EAAE,CAAC;AACrC,YAAA,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,CAAC,CAAC;AACpD,SAAA;KACF;AAED;;;AAGG;AACI,IAAA,QAAQ,CAAC,MAAA,GAAgC,qBAAqB,CAAC,MAAM,EAAA;QAC1E,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,mBAAmB,CAAC,QAAQ,CAAC,CAAC;KAClD;AAED;;;;AAIG;IACI,KAAK,CACV,SAAgC,qBAAqB,CAAC,MAAM,EAC5D,IAAA,GAA4B,mBAAmB,CAAC,KAAK,EAAA;AAErD,QAAA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAE7B,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC;;QAE5C,IAAI,CAAC,oBAAoB,EAAE,CAAC;;QAE5B,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,MAAK;AACjD,YAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;YAC1C,WAAW,CAAC,WAAW,EAAE,CAAC;AAC5B,SAAC,CAAC,CAAC;AACH,QAAA,IAAI,CAAC,UAAU,GAAG,SAA2C,CAAC;KAC/D;AAED;;AAEG;IACI,QAAQ,GAAA;QACb,IAAI,IAAI,CAAC,SAAS,EAAE;AAClB,YAAA,OAAO,IAAI,CAAC,SAAS,EAAE,CAAC;AACzB,SAAA;AAAM,aAAA;AACL,YAAA,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;AACnB,SAAA;KACF;AAED;;AAEG;IACI,IAAI,GAAA;QACT,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,YAAY,EAAE,CAAC;KACrB;AAED;;AAEG;IACI,cAAc,GAAA;QACnB,IAAI,IAAI,CAAC,cAAc,EAAE;AACvB,YAAA,IAAI,CAAC,cAAc,CAAC,qBAAqB,EAAE,CAAC;AAC7C,SAAA;KACF;AAED;;AAEG;IACI,YAAY,GAAA;QACjB,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,EAAE,WAAW,EAAE,eAAe,EAAE;AAC5E,YAAA,IAAI,CAAC,YAAY,CACf,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,CAAE,CAAC,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE,EAC/F,IAAI,CAAC,cAAc,CAAC,WAAW,CAChC,CAAC;AACH,SAAA;KACF;AAED;;AAEG;IACI,YAAY,GAAA;QACjB,IAAI,IAAI,CAAC,oBAAoB,EAAE;YAC7B,IAAI,CAAC,oBAAoB,EAAE,CAAC;AAC7B,SAAA;KACF;AAED;;;AAGG;IACK,SAAS,CAAC,KAAuB,EAAE,aAAuB,EAAA;AAChE,QAAA,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;AAC9B,YAAA,IAAI,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,MAAK;AAE7B,gBAAA,IAAI,KAAK,EAAE;AACT,oBAAA,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAC1B,iBAAA;gBAED,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;AACrC,oBAAA,MAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AACpD,oBAAA,IAAI,SAAS,EAAE;wBACb,SAAS,CAAC,WAAW,EAAE,CAAC;wBACxB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AACtC,qBAAA;AACF,iBAAA;AAED,gBAAA,MAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;gBAEjE,IAAI,aAAa,KAAK,SAAS,EAAE;AAC/B,oBAAA,IAAI,CAAC,QAAQ,GAAG,aAAa,CAAC;AAC/B,iBAAA;AAAM,qBAAA;AACL,oBAAA,IAAI,CAAC,QAAQ,GAAG,CAAC,OAAO,CAAC;AAC1B,iBAAA;AAED,gBAAA,IAAI,OAAO,EAAE;oBACX,IAAI,CAAC,SAAS,EAAE,CAAC;AAClB,iBAAA;AAAM,qBAAA;AACL,oBAAA,IAAI,CAAC,KAAK,CAAC,GAAG,CACZ,OAAO,CAAC,SAAS,EACjB,IAAI,CAAC,WAAW,CAAC,IAAI,CACnB,KAAK,CAAC,CAAC,IAAI,KAAK,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,CAC1D,CAAC,SAAS,CAAC,MAAK;wBACf,IAAI,CAAC,SAAS,EAAE,CAAC;qBAClB,CAAC,CACH,CAAC;AACH,iBAAA;AACH,aAAC,CAAC,CAAC;AACJ,SAAA;AAAM,aAAA;;YAEL,IAAI,CAAC,KAAK,EAAE,CAAC;AACd,SAAA;KACF;AAED;;AAEG;IACK,SAAS,GAAA;QACf,MAAM,EAAE,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,CAA0B,CAAC;AACpH,QAAA,MAAM,OAAO,GAAG,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,OAAO,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC;;AAG3F,QAAA,IAAI,CAAC,SAAS,GAAG,MAAuB;YACtC,OAAO,CAAC,IAAI,EAAE,CAAC;AACf,YAAA,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;;YAEpB,IAAI,CAAC,SAAS,CAAC,WAAW,CACxB,OAAO,CAAC,aAAa,EACrB,mBAAmB,CACpB,CAAC;AAEF,YAAA,IAAI,IAAI,CAAC,cAAc,KAAK,OAAO,EAAE;AACnC,gBAAA,IAAI,CAAC,cAAc,GAAG,IAA+B,CAAC;AACvD,aAAA;AACD,YAAA,IAAI,CAAC,SAAS,GAAG,IAAyC,CAAC;YAE3D,OAAO,KAAK,CAAC,MAAK;AAChB,gBAAA,OAAO,OAAO,CAAC,eAAgB,CAAC,WAAW,EAAE,CAAC,IAAI,CAChD,SAAS,CAAC,IAAW,CAAC,EACtB,IAAI,EAAE,CACP,CAAC;AACJ,aAAC,CAAC,CAAC;AACL,SAAC,CAAC;;QAGF,IAAI,CAAC,SAAS,CAAC,QAAQ,CACrB,OAAO,CAAC,aAAa,EACrB,mBAAmB,CACpB,CAAC;AAEF,QAAA,OAAO,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;AACnC,QAAA,OAAO,CAAC,cAAc,GAAG,MAAM,CAAC,cAAc,CAAC;AAC/C,QAAA,OAAO,CAAC,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC;AACjC,QAAA,OAAO,CAAC,WAAW,GAAG,uBAAuB,CAAC;QAE9C,IAAI,MAAM,CAAC,cAAc,EAAE;YACzB,MAAM,CAAC,cAAc,EAAE,CAAC;AACzB,SAAA;;QAGD,IAAI,CAAC,YAAY,EAAE,CAAC;;AAEpB,QAAA,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,MAAM,EAAE;AACrC,YAAA,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;AACtB,SAAA;;AAED,QAAA,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;;AAEf,QAAA,OAAO,CAAC,eAA2C,CAAC,OAAO,GAAG,MAAM,CAAC;;AAEtE,QAAA,IAAI,CAAC,oBAAoB,GAAG,MAAK;YAC/B,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,WAAW,EAAE,eAA8B,CAAC,CAAC;AAC1E,SAAC,CAAC;QAEF,IAAI,IAAI,CAAC,QAAQ,EAAE;;AAEjB,YAAA,MAAM,eAAe,GAAG,OAAO,CAAC,eAAe,EAAE,YAAY,EAAE,CAAC,SAAS,CAAC,MAAK;AAC7E,gBAAA,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE,EAAE,OAAO,CAAC,WAAyB,CAAC,CAAC;AACpG,gBAAA,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACnB,eAAe,EAAE,WAAW,EAAE,CAAC;AACjC,aAAC,CAAC,CAAC;AACJ,SAAA;AAAM,aAAA;;AAEL,YAAA,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC,qBAAqB,EAAE,EAAE,OAAO,CAAC,WAAyB,CAAC,CAAC;AACrG,SAAA;KACF;AAED;;;;;;AAMG;IACK,YAAY,CAAC,IAAa,EAAE,UAAsB,EAAA;;;;;;;;;;;;AAaxD,QAAA,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe,EAAE,WAAW,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;AACjF,QAAA,IAAI,CAAC,SAAS,CAAC,QAAQ;AACrB,QAAA,UAAU,CAAC,eAAe,EAC1B,UAAU,EACV,CAAA;;;AAGM,UAAA,EAAA,IAAI,CAAC,IAAI,CAAA;AACT,UAAA,EAAA,IAAI,CAAC,IAAI,CAAM,GAAA,EAAA,IAAI,CAAC,GAAG,CAAA;AACvB,UAAA,EAAA,IAAI,CAAC,KAAK,CAAM,GAAA,EAAA,IAAI,CAAC,GAAG,CAAA;AACxB,UAAA,EAAA,IAAI,CAAC,KAAK,CAAM,GAAA,EAAA,IAAI,CAAC,MAAM,CAAA;AAC3B,UAAA,EAAA,IAAI,CAAC,IAAI,CAAM,GAAA,EAAA,IAAI,CAAC,MAAM,CAAA;AAC1B,UAAA,EAAA,IAAI,CAAC,IAAI,CAAA;;;AAGX,SAAA,CAAA,CACL,CAAC;AAEF,QAAA,IAAI,CAAC,UAAU,CAAC,eAAe,EAAE,UAAU,EAAE;AAC3C,YAAA,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;AAC7F,SAAA;QAED,MAAM,MAAM,GAAG,CAAC,CAAC;QACjB,MAAM,YAAY,GAAG,MAAM,CAAC;AAC5B,QAAA,MAAM,gBAAgB,GAAG,MAAM,GAAG,CAAC,CAAC;AAEpC,QAAA,IAAI,UAAU,CAAC,eAAe,EAAE,UAAU,EAAE;AAC1C,YAAA,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe,CAAC,UAAU,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;AACvF,YAAA,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe,CAAC,UAAU,EAAE,YAAY,EAAE,OAAO,CAAC,CAAC;YACtF,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe,CAAC,UAAU,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,KAAK,GAAG,MAAM,CAAI,EAAA,CAAA,CAAC,CAAC;YACpG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe,CAAC,UAAU,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,MAAM,GAAG,MAAM,CAAI,EAAA,CAAA,CAAC,CAAC;AACtG,YAAA,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe,CAAC,UAAU,EAAE,UAAU,EAAE,iBAAiB,YAAY,CAAA,GAAA,CAAK,CAAC,CAAC;YAC/G,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,eAAe,CAAC,UAAU,EAAE,OAAO,EAAE,CAAG,EAAA,IAAI,CAAC,CAAC,GAAG,gBAAgB,CAAU,OAAA,EAAA,IAAI,CAAC,CAAC,GAAG,gBAAgB,CAAI,EAAA,CAAA,CAAC,CAAC;AAC9I,SAAA;KACF;AAED;;;AAGG;AACK,IAAA,aAAa,CAAC,QAAqB,EAAA;AACzC,QAAA,IAAI,QAAQ,EAAE;YACZ,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,EAAE,sBAAsB,CAAC,CAAC;YAC7D,IAAI,QAAQ,CAAC,UAAU,EAAE;gBACvB,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,EAAE,QAAQ,CAAC,UAAU,CAAC,CAAC;AAC3D,aAAA;AACF,SAAA;;KAGF;;8GAjcU,iBAAiB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,QAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,gBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;AAAjB,iBAAA,CAAA,KAAA,GAAA,EAAA,CAAA,qBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,iBAAiB,cADJ,MAAM,EAAA,CAAA,CAAA;2FACnB,iBAAiB,EAAA,UAAA,EAAA,CAAA;kBAD7B,UAAU;mBAAC,EAAE,UAAU,EAAE,MAAM,EAAE,CAAA;;;MCpBrB,8BAA8B,CAAA;AAIzC,IAAA,WAAA,CACmB,kBAAqC,EAAA;QAArC,IAAkB,CAAA,kBAAA,GAAlB,kBAAkB,CAAmB;AAHjD,QAAA,IAAA,CAAA,qBAAqB,GAA6B,IAAI,YAAY,EAAE,CAAC;KAIvE;AAGE,IAAA,OAAO,CAAC,KAAiB,EAAA;AAC9B,QAAA,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACvC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;KAC/D;;2HAZU,8BAA8B,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAAC,iBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;+GAA9B,8BAA8B,EAAA,QAAA,EAAA,yBAAA,EAAA,OAAA,EAAA,EAAA,qBAAA,EAAA,uBAAA,EAAA,EAAA,IAAA,EAAA,EAAA,SAAA,EAAA,EAAA,OAAA,EAAA,iBAAA,EAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA;2FAA9B,8BAA8B,EAAA,UAAA,EAAA,CAAA;kBAD1C,SAAS;mBAAC,EAAE,QAAQ,EAAE,yBAAyB,EAAE,CAAA;qGAGzC,qBAAqB,EAAA,CAAA;sBAD3B,MAAM;gBAQA,OAAO,EAAA,CAAA;sBADb,YAAY;uBAAC,OAAO,EAAE,CAAC,QAAQ,CAAC,CAAA;;;MCXtB,oBAAoB,CAAA;AAAjC,IAAA,WAAA,GAAA;QAGS,IAAe,CAAA,eAAA,GAAW,MAAM,CAAC;QACjC,IAAe,CAAA,eAAA,GAAW,MAAM,CAAC;QAEjC,IAAc,CAAA,cAAA,GAAY,IAAI,CAAC;QAC/B,IAAc,CAAA,cAAA,GAAY,KAAK,CAAC;QAChC,IAAc,CAAA,cAAA,GAAY,KAAK,CAAC;QAChC,IAAU,CAAA,UAAA,GAAY,KAAK,CAAC;QAE5B,IAAQ,CAAA,QAAA,GAAoB,OAAO,CAAC;QACpC,IAAc,CAAA,cAAA,GAA0B,MAAM,CAAC;KAOvD;AAAA;;MCbY,uBAAuB,CAAA;AAqBnC,IAAA,WAAA,CACmB,OAAgC,EAChC,GAAqB,EACtB,kBAAqC,EAAA;QAFpC,IAAO,CAAA,OAAA,GAAP,OAAO,CAAyB;QAChC,IAAG,CAAA,GAAA,GAAH,GAAG,CAAkB;QACtB,IAAkB,CAAA,kBAAA,GAAlB,kBAAkB,CAAmB;AAV/C,QAAA,IAAA,CAAA,mBAAmB,GAAkC,IAAI,YAAY,EAAE,CAAC;AAGxE,QAAA,IAAA,CAAA,OAAO,GAA6B,IAAI,eAAe,CAAC,KAAgB,CAAC,CAAC;QAEhE,IAAK,CAAA,KAAA,GAAmB,EAAE,CAAC;KAMxC;IAxBJ,IACW,cAAc,CAAC,MAAwC,EAAA;QAChE,IAAI,CAAC,MAAM,GAAG;YACZ,GAAG,IAAI,oBAAoB,EAAE;AAC7B,YAAA,GAAG,MAAM;SACV,CAAC;KACH;AAED,IAAA,IAAW,cAAc,GAAA;QACvB,OAAO,IAAI,CAAC,MAAM,CAAC;KACpB;IAgBD,QAAQ,GAAA;QACN,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE;AAClD,YAAA,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;AAC5C,SAAA;KACF;IAED,WAAW,GAAA;QACT,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;AACnC,YAAA,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;AAC9C,SAAA;AAED,QAAA,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,GAAG,KAAK,GAAG,CAAC,WAAW,EAAE,CAAC,CAAC;KAChD;;oHAvCU,uBAAuB,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAA,EAAA,CAAA,UAAA,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,gBAAA,EAAA,EAAA,EAAA,KAAA,EAAAA,iBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;wGAAvB,uBAAuB,EAAA,QAAA,EAAA,kBAAA,EAAA,MAAA,EAAA,EAAA,cAAA,EAAA,gBAAA,EAAA,EAAA,OAAA,EAAA,EAAA,mBAAA,EAAA,qBAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA;2FAAvB,uBAAuB,EAAA,UAAA,EAAA,CAAA;kBADnC,SAAS;mBAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CAAA;6JAG9B,cAAc,EAAA,CAAA;sBADxB,KAAK;gBAaC,mBAAmB,EAAA,CAAA;sBADzB,MAAM;;;MChBI,+BAA+B,CAAA;AAE1C,IAAA,WAAA,CACmB,kBAAqC,EAAA;QAArC,IAAkB,CAAA,kBAAA,GAAlB,kBAAkB,CAAmB;KACnD;IAGE,QAAQ,GAAA;QACb,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;KACnE;;4HATU,+BAA+B,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAAA,iBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;gHAA/B,+BAA+B,EAAA,QAAA,EAAA,0BAAA,EAAA,IAAA,EAAA,EAAA,SAAA,EAAA,EAAA,OAAA,EAAA,YAAA,EAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA;2FAA/B,+BAA+B,EAAA,UAAA,EAAA,CAAA;kBAD3C,SAAS;mBAAC,EAAE,QAAQ,EAAE,0BAA0B,EAAE,CAAA;qGAQ1C,QAAQ,EAAA,CAAA;sBADd,YAAY;uBAAC,OAAO,CAAA;;;MCPV,2BAA2B,CAAA;AACtC,IAAA,WAAA,CACmB,kBAAqC,EAAA;QAArC,IAAkB,CAAA,kBAAA,GAAlB,kBAAkB,CAAmB;KACnD;IAGE,IAAI,GAAA;AACT,QAAA,IAAI,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE;AACtC,YAAA,IAAI,CAAC,kBAAkB,CAAC,QAAQ,EAAE,CAAC;AACpC,SAAA;KACF;;wHAVU,2BAA2B,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAAA,iBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;4GAA3B,2BAA2B,EAAA,QAAA,EAAA,sBAAA,EAAA,IAAA,EAAA,EAAA,SAAA,EAAA,EAAA,OAAA,EAAA,QAAA,EAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA;2FAA3B,2BAA2B,EAAA,UAAA,EAAA,CAAA;kBADvC,SAAS;mBAAC,EAAE,QAAQ,EAAE,sBAAsB,EAAE,CAAA;qGAOtC,IAAI,EAAA,CAAA;sBADV,YAAY;uBAAC,OAAO,CAAA;;;MCJV,+BAA+B,CAAA;AAE1C,IAAA,WAAA,CACmB,kBAAqC,EAAA;QAArC,IAAkB,CAAA,kBAAA,GAAlB,kBAAkB,CAAmB;KACnD;IAGE,QAAQ,GAAA;QACb,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;KAC/D;;4HATU,+BAA+B,EAAA,IAAA,EAAA,CAAA,EAAA,KAAA,EAAAA,iBAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;gHAA/B,+BAA+B,EAAA,QAAA,EAAA,0BAAA,EAAA,IAAA,EAAA,EAAA,SAAA,EAAA,EAAA,OAAA,EAAA,YAAA,EAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,CAAA,CAAA;2FAA/B,+BAA+B,EAAA,UAAA,EAAA,CAAA;kBAD3C,SAAS;mBAAC,EAAE,QAAQ,EAAE,0BAA0B,EAAE,CAAA;qGAQ1C,QAAQ,EAAA,CAAA;sBADd,YAAY;uBAAC,OAAO,CAAA;;;ACLjB,MAAO,0BAA2B,SAAQ,gBAAgB,CAAA;IAC/D,WACmB,CAAA,QAAa,EAC/B,QAAkB,EAAA;AAElB,QAAA,KAAK,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;KAC1B;IAES,gBAAgB,GAAA;QACzB,KAAK,CAAC,gBAAgB,EAAE,CAAC;QACzB,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;KACpD;;AAXW,0BAAA,CAAA,IAAA,GAAA,EAAA,CAAA,kBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,0BAA0B,kBAE7B,QAAQ,EAAA,EAAA,EAAA,KAAA,EAAAF,EAAA,CAAA,QAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA;AAFL,0BAAA,CAAA,KAAA,GAAA,EAAA,CAAA,qBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,0BAA0B,cADb,MAAM,EAAA,CAAA,CAAA;2FACnB,0BAA0B,EAAA,UAAA,EAAA,CAAA;kBADtC,UAAU;mBAAC,EAAE,UAAU,EAAE,MAAM,EAAE,CAAA;;0BAG/B,MAAM;2BAAC,QAAQ,CAAA;;AAYX,MAAM,sCAAsC,GAAqB;AACvE,IAAA,OAAO,EAAE,gBAAgB;AACzB,IAAA,WAAW,EAAE,0BAA0B;CACvC;;ACCD,MAAM,UAAU,GAAG;IACjB,uBAAuB;IACvB,8BAA8B;IAC9B,+BAA+B;IAC/B,2BAA2B;IAC3B,+BAA+B;CAChC,CAAC;AAEF,MAAM,UAAU,GAAG;IACjB,uBAAuB;IACvB,gBAAgB;CACjB,CAAC;MA2BW,gBAAgB,CAAA;;6GAAhB,gBAAgB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,QAAA,EAAA,CAAA,CAAA;AAAhB,gBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,gBAAgB,iBA7B3B,uBAAuB;AACvB,QAAA,gBAAgB,EAThB,uBAAuB;QACvB,8BAA8B;QAC9B,+BAA+B;QAC/B,2BAA2B;AAC3B,QAAA,+BAA+B,aAU7B,YAAY;QACZ,YAAY;AACZ,QAAA,aAAa,aARf,uBAAuB;AACvB,QAAA,gBAAgB,EAThB,uBAAuB;QACvB,8BAA8B;QAC9B,+BAA+B;QAC/B,2BAA2B;QAC3B,+BAA+B,CAAA,EAAA,CAAA,CAAA;AAiCpB,gBAAA,CAAA,IAAA,GAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,gBAAgB,EAXhB,SAAA,EAAA;AACT,QAAA;AACE,YAAA,OAAO,EAAE,sBAAsB;AAC/B,YAAA,WAAW,EAAE,iBAAiB;AAC/B,SAAA;QACD,oDAAoD;QACpD,sDAAsD;QACtD,8CAA8C;QAC9C,sCAAsC;AACvC,KAAA,EAAA,OAAA,EAAA,CArBC,YAAY;QACZ,YAAY;QACZ,aAAa,CAAA,EAAA,CAAA,CAAA;2FAqBJ,gBAAgB,EAAA,UAAA,EAAA,CAAA;kBAzB5B,QAAQ;AAAC,YAAA,IAAA,EAAA,CAAA;AACR,oBAAA,OAAO,EAAE;wBACP,YAAY;wBACZ,YAAY;wBACZ,aAAa;AACd,qBAAA;AACD,oBAAA,YAAY,EAAE;AACZ,wBAAA,GAAG,UAAU;AACb,wBAAA,GAAG,UAAU;AACd,qBAAA;AACD,oBAAA,OAAO,EAAE;AACP,wBAAA,GAAG,UAAU;AACb,wBAAA,GAAG,UAAU;AACd,qBAAA;AACD,oBAAA,SAAS,EAAE;AACT,wBAAA;AACE,4BAAA,OAAO,EAAE,sBAAsB;AAC/B,4BAAA,WAAW,EAAE,iBAAiB;AAC/B,yBAAA;wBACD,oDAAoD;wBACpD,sDAAsD;wBACtD,8CAA8C;wBAC9C,sCAAsC;AACvC,qBAAA;AACF,iBAAA,CAAA;;;MC7DY,cAAc,CAAA;IAOzB,WACS,CAAA,IAAY,EACnB,GAAG,KAAuB,EAAA;QADnB,IAAI,CAAA,IAAA,GAAJ,IAAI,CAAQ;QAPL,IAAW,CAAA,WAAA,GAAY,KAAK,CAAC;QAC7B,IAAQ,CAAA,QAAA,GAAqB,EAAE,CAAC;QAGzC,IAAM,CAAA,MAAA,GAAY,KAAK,CAAC;AAM7B,QAAA,IAAI,KAAK,IAAI,KAAK,CAAC,MAAM,EAAE;AACzB,YAAA,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;AACxB,YAAA,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;AAEtB,YAAA,KAAK,CAAC,OAAO,CAAC,CAAC,OAAO,KAAI;AACxB,gBAAA,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;AACxB,aAAC,CAAC,CAAC;AACJ,SAAA;KACF;AACF;;ACpBD;;AAEG;;ACFH;;AAEG;;;;"}